<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Outil de cartographie des profils d'apprenants - Version Am√©lior√©e</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            padding: 30px;
            color: white;
            text-align: center;
        }

        .header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }

        .header .version-badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .instructions {
            background: #f8f9fa;
            padding: 20px 25px;
            border-left: 5px solid #4facfe;
        }

        .instructions p {
            line-height: 1.5;
            margin-bottom: 8px;
            color: #555;
            font-size: 14px;
        }

        .auto-save-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #2ecc71;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 12px;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .auto-save-indicator.visible {
            opacity: 1;
        }

        .form-section {
            padding: 25px 30px;
            border-bottom: 1px solid #eee;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        .input-group input, .input-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .input-group input:focus, .input-group textarea:focus {
            outline: none;
            border-color: #4facfe;
        }

        .diagram-section {
            padding: 40px;
            background: #f8f9fa;
            text-align: center;
        }

        .diagram-title {
            color: #2c3e50;
            font-size: 1.5rem;
            margin-bottom: 30px;
            font-weight: 600;
        }

        .diagram-wrapper {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 80px;
            flex-wrap: wrap;
        }

        .star-container {
            position: relative;
            width: 500px;
            height: 500px;
        }

        .center-circle {
            position: absolute;
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 16px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            z-index: 10;
        }

        .petal {
            position: absolute;
            width: 140px;
            height: 80px;
            border: 3px solid;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .petal.active {
            border-width: 6px;
            box-shadow: 0 0 30px rgba(0,0,0,0.3);
            transform: scale(1.05);
        }

        /* Badge compteur sur chaque p√©tale */
        .petal-badge {
            position: absolute;
            top: -10px;
            right: -10px;
            background: white;
            color: #2c3e50;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 5;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .petal.active .petal-badge {
            opacity: 1;
        }

        /* Positionnement des 6 p√©tales en √©toile */
        .petal-social {
            top: 50px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(52, 152, 219, 0.15);
            border-color: #3498db;
        }

        .petal-social.active {
            background: rgba(52, 152, 219, 0.4);
        }

        .petal-apprentissage {
            top: 150px;
            right: 30px;
            background: rgba(155, 89, 182, 0.15);
            border-color: #9b59b6;
        }

        .petal-apprentissage.active {
            background: rgba(155, 89, 182, 0.4);
        }

        .petal-ecrit {
            bottom: 150px;
            right: 30px;
            background: rgba(46, 204, 113, 0.15);
            border-color: #2ecc71;
        }

        .petal-ecrit.active {
            background: rgba(46, 204, 113, 0.4);
        }

        .petal-oral {
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 193, 7, 0.15);
            border-color: #f39c12;
        }

        .petal-oral.active {
            background: rgba(255, 193, 7, 0.4);
        }

        .petal-numerique {
            bottom: 150px;
            left: 30px;
            background: rgba(230, 126, 34, 0.15);
            border-color: #e67e22;
        }

        .petal-numerique.active {
            background: rgba(230, 126, 34, 0.4);
        }

        .petal-transversal {
            top: 150px;
            left: 30px;
            background: rgba(231, 76, 60, 0.15);
            border-color: #e74c3c;
        }

        .petal-transversal.active {
            background: rgba(231, 76, 60, 0.4);
        }

        .petal-points {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            pointer-events: none;
        }

        .point {
            position: absolute;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }

        .labels-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 15px;
        }

        .label {
            font-size: 14px;
            font-weight: 600;
            color: white;
            padding: 12px 18px;
            border-radius: 25px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            min-width: 180px;
            position: relative;
        }

        .label-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: white;
            color: #2c3e50;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .label-count.visible {
            opacity: 1;
        }

        .label-social { background: #3498db; }
        .label-apprentissage { background: #9b59b6; }
        .label-ecrit { background: #2ecc71; }
        .label-oral { background: #f39c12; }
        .label-numerique { background: #e67e22; }
        .label-transversal { background: #e74c3c; }

        .factors-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            padding: 40px;
        }

        .factor-category {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-top: 4px solid;
        }

        .factor-category.social { border-color: #3498db; }
        .factor-category.apprentissage { border-color: #9b59b6; }
        .factor-category.ecrit { border-color: #2ecc71; }
        .factor-category.oral { border-color: #f39c12; }
        .factor-category.numerique { border-color: #e67e22; }
        .factor-category.transversal { border-color: #e74c3c; }

        .factor-category h3 {
            margin-bottom: 15px;
            color: #2c3e50;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .category-counter {
            background: #e9ecef;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 13px;
            font-weight: normal;
        }

        .factor-item {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .factor-circle {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            margin-right: 12px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid #ddd;
        }

        .factor-circle.social { background: #3498db; }
        .factor-circle.apprentissage { background: #9b59b6; }
        .factor-circle.ecrit { background: #2ecc71; }
        .factor-circle.oral { background: #f39c12; }
        .factor-circle.numerique { background: #e67e22; }
        .factor-circle.transversal { background: #e74c3c; }

        .factor-circle.selected {
            transform: scale(1.3);
            box-shadow: 0 0 10px rgba(0,0,0,0.4);
            border-color: #333;
        }

        .factor-text {
            flex: 1;
            font-weight: 500;
            color: #2c3e50;
            font-size: 14px;
        }

        .note-button {
            background: #f39c12;
            color: white;
            border: none;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            font-size: 12px;
        }

        .note-button:hover {
            background: #e67e22;
            transform: scale(1.1);
        }

        .note-input {
            width: 100%;
            margin-top: 8px;
            padding: 6px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 12px;
            display: none;
            resize: vertical;
            min-height: 40px;
        }

        .note-input.visible {
            display: block;
        }

        .buttons {
            text-align: center;
            padding: 25px;
            background: #f8f9fa;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            margin: 0 8px;
            transition: all 0.3s;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.2);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn.secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .btn.tertiary {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .profile-result {
            display: none;
            padding: 30px;
            background: white;
            border-top: 3px solid #4facfe;
        }

        .profile-result.visible {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .profile-result h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.4rem;
        }

        .profile-section {
            margin-bottom: 20px;
            padding: 18px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .profile-section h3 {
            color: #2c3e50;
            margin-bottom: 12px;
            border-bottom: 2px solid #4facfe;
            padding-bottom: 5px;
            font-size: 1.1rem;
        }

        .profile-section h4 {
            color: #2c3e50;
            margin-top: 15px;
            margin-bottom: 8px;
            font-size: 1rem;
        }

        .profile-section ul {
            list-style: none;
            padding-left: 0;
        }

        .profile-section li {
            padding: 6px 0;
            border-bottom: 1px solid #eee;
            color: #555;
            line-height: 1.4;
        }

        .profile-section li:last-child {
            border-bottom: none;
        }

        .recommendations {
            background: #e8f5e8;
            padding: 20px;
            border-radius: 8px;
            border-left: 5px solid #2ecc71;
        }

        .recommendations ul {
            padding-left: 20px;
        }

        .recommendations li {
            list-style: disc;
            margin-bottom: 8px;
        }

        .success-message {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
            animation: slideDown 0.3s ease;
        }

        .success-message.visible {
            display: block;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media print {
            body { background: white !important; padding: 0 !important; }
            .container { box-shadow: none !important; border-radius: 0 !important; }
            .instructions, .factors-section, .diagram-section, .buttons, .form-section, .auto-save-indicator, .success-message { display: none !important; }
            .profile-result { display: block !important; }
        }

        @media (max-width: 768px) {
            .factors-section { grid-template-columns: 1fr; }
            .diagram-wrapper { flex-direction: column; gap: 30px; }
            .star-container { width: 350px; height: 350px; }
            .petal { width: 100px; height: 60px; }
            .center-circle { width: 80px; height: 80px; font-size: 12px; }
            .auto-save-indicator { top: 10px; right: 10px; font-size: 11px; }
        }
    </style>
</head>
<body>
    <div class="auto-save-indicator" id="autoSaveIndicator">
        üíæ Sauvegarde automatique
    </div>

    <div class="container">
        <div class="header">
            <h1>Outil de cartographie des profils d'apprenants</h1>
            <p>Version p√©tales - Analyse multidimensionnelle</p>
            <div class="version-badge">‚ú® Version am√©lior√©e</div>
        </div>

        <div class="instructions">
            <p><strong>Cette cartographie permet d'analyser les profils d'apprenants selon 6 dimensions cl√©s :</strong></p>
            <p>Chaque dimension est repr√©sent√©e par un p√©tale color√©. √âvaluez les facteurs pertinents en cliquant sur les cercles correspondants et ajoutez des notes si n√©cessaire.</p>
            <p><strong>Comment noter les facteurs :</strong> Pour √©valuer l'importance d'un facteur, ajoutez une notation entre parenth√®ses dans les notes, par exemple "(4/5)".</p>
            <p><strong>üíæ Sauvegarde automatique :</strong> Vos donn√©es sont enregistr√©es automatiquement dans votre navigateur.</p>
        </div>

        <div class="form-section">
            <div class="input-group">
                <label for="learner-name">Nom de l'apprenant :</label>
                <input type="text" id="learner-name" placeholder="Entrez le nom de l'apprenant">
            </div>
            <div class="input-group">
                <label for="context">Contexte et observations (parcours, niveau, difficult√©s observ√©es...):</label>
                <textarea id="context" rows="4" placeholder="D√©crivez le contexte et vos observations sur cet apprenant"></textarea>
            </div>
        </div>

        <div class="diagram-section">
            <div class="diagram-title">Cartographie du profil de l'apprenant</div>
            <div class="diagram-wrapper">
                <div class="star-container">
                    <div class="center-circle">
                        APPRENANT<br>& APPRENTISSAGE
                    </div>
                    
                    <div class="petal petal-social" data-dimension="social">
                        <div class="petal-badge" id="badge-social">0</div>
                        <div class="petal-points" id="points-social"></div>
                    </div>
                    <div class="petal petal-apprentissage" data-dimension="apprentissage">
                        <div class="petal-badge" id="badge-apprentissage">0</div>
                        <div class="petal-points" id="points-apprentissage"></div>
                    </div>
                    <div class="petal petal-ecrit" data-dimension="ecrit">
                        <div class="petal-badge" id="badge-ecrit">0</div>
                        <div class="petal-points" id="points-ecrit"></div>
                    </div>
                    <div class="petal petal-oral" data-dimension="oral">
                        <div class="petal-badge" id="badge-oral">0</div>
                        <div class="petal-points" id="points-oral"></div>
                    </div>
                    <div class="petal petal-numerique" data-dimension="numerique">
                        <div class="petal-badge" id="badge-numerique">0</div>
                        <div class="petal-points" id="points-numerique"></div>
                    </div>
                    <div class="petal petal-transversal" data-dimension="transversal">
                        <div class="petal-badge" id="badge-transversal">0</div>
                        <div class="petal-points" id="points-transversal"></div>
                    </div>
                </div>
                
                <div class="labels-container">
                    <div class="label label-social">
                        Environnement<br>socioculturel
                        <span class="label-count" id="count-social">0</span>
                    </div>
                    <div class="label label-apprentissage">
                        Comp√©tences<br>d'apprentissage
                        <span class="label-count" id="count-apprentissage">0</span>
                    </div>
                    <div class="label label-ecrit">
                        Rapport<br>√† l'√©crit
                        <span class="label-count" id="count-ecrit">0</span>
                    </div>
                    <div class="label label-oral">
                        Habilet√©s<br>langagi√®res orales
                        <span class="label-count" id="count-oral">0</span>
                    </div>
                    <div class="label label-numerique">
                        Num√©ratie<br>& num√©rique
                        <span class="label-count" id="count-numerique">0</span>
                    </div>
                    <div class="label label-transversal">
                        Comp√©tences<br>transversales
                        <span class="label-count" id="count-transversal">0</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="buttons">
            <button class="btn" onclick="generateProfile()">G√©n√©rer le profil</button>
            <button class="btn secondary" id="printBtn" onclick="printProfile()" disabled>Imprimer la cartographie</button>
            <button class="btn tertiary" onclick="resetTool()">R√©initialiser l'outil</button>
        </div>

        <div class="factors-section">
            <div class="factor-category social">
                <h3>
                    Environnement socioculturel
                    <span class="category-counter" id="counter-social">0 s√©lectionn√©</span>
                </h3>
                
                <div class="factor-item">
                    <div class="factor-circle social" data-factor="utilisation-francais"></div>
                    <span class="factor-text">Utilisation du fran√ßais au quotidien</span>
                    <button class="note-button" onclick="toggleNote('utilisation-francais')">?</button>
                    <textarea class="note-input" id="note-utilisation-francais" placeholder="Ajoutez vos observations..."></textarea>
                </div>
                
                <div class="factor-item">
                    <div class="factor-circle social" data-factor="integration-sociale"></div>
                    <span class="factor-text">Int√©gration sociale</span>
                    <button class="note-button" onclick="toggleNote('integration-sociale')">?</button>
                    <textarea class="note-input" id="note-integration-sociale" placeholder="Ajoutez vos observations..."></textarea>
                </div>
                
                <div class="factor-item">
                    <div class="factor-circle social" data-factor="situation-economique"></div>
                    <span class="factor-text">Situation socio-√©conomique</span>
                    <button class="note-button" onclick="toggleNote('situation-economique')">?</button>
                    <textarea class="note-input" id="note-situation-economique" placeholder="Ajoutez vos observations..."></textarea>
                </div>
                
                <div class="factor-item">
                    <div class="factor-circle social" data-factor="reseaux-soutien"></div>
                    <span class="factor-text">R√©seaux de soutien</span>
                    <button class="note-button" onclick="toggleNote('reseaux-soutien')">?</button>
                    <textarea class="note-input" id="note-reseaux-soutien" placeholder="Ajoutez vos observations..."></textarea>
                </div>
                
                <div class="factor-item">
                    <div class="factor-circle social" data-factor="stabilite-migratoire"></div>
                    <span class="factor-text">Stabilit√© du parcours migratoire</span>
                    <button class="note-button" onclick="toggleNote('stabilite-migratoire')">?</button>
                    <textarea class="note-input" id="note-stabilite-migratoire" placeholder="Ajoutez vos observations..."></textarea>
                </div>
                
                <div class="factor-item">
                    <div class="factor-circle social" data-factor="disponibilite-hors-cours"></div>
                    <span class="factor-text">Disponibilit√© pour consolider hors temps de cours</span>
                    <button class="note-button" onclick="toggleNote('disponibilite-hors-cours')">?</button>
                    <textarea class="note-input" id="note-disponibilite-hors-cours" placeholder="Ajoutez vos observations..."></textarea>
                </div>
            </div>

            <div class="factor-category apprentissage">
                <h3>
                    Comp√©tences d'apprentissage
                    <span class="category-counter" id="counter-apprentissage">0 s√©lectionn√©</span>
                </h3>
                
                <div class="factor-item">
                    <div class="factor-circle apprentissage" data-factor="parcours-scolaire"></div>
                    <span class="factor-text">Parcours scolaire ant√©rieur</span>
                    <button class="note-button" onclick="toggleNote('parcours-scolaire')">?</button>
                    <textarea class="note-input" id="note-parcours-scolaire" placeholder="Ajoutez vos observations..."></textarea>
                </div>
                
                <div class="factor-item">
                    <div class="factor-circle apprentissage" data-factor="methodes-apprentissage"></div>
                    <span class="factor-text">M√©thodes d'apprentissage famili√®res</span>
                    <button class="note-button" onclick="toggleNote('methodes-apprentissage')">?</button>
                    <textarea class="note-input" id="note-methodes-apprentissage" placeholder="Ajoutez vos observations..."></textarea>
                </div>
                
                <div class="factor-item">
                    <div class="factor-circle apprentissage" data-factor="autonomie-apprentissage"></div>
                    <span class="factor-text">Autonomie d'apprentissage</span>
                    <button class="note-button" onclick="toggleNote('autonomie-apprentissage')">?</button>
                    <textarea class="note-input" id="note-autonomie-apprentissage" placeholder="Ajoutez vos observations..."></textarea>
                </div>
                
                <div class="factor-item">
                    <div class="factor-circle apprentissage" data-factor="langues-maitrisees"></div>
                    <span class="factor-text">Langues ma√Ætris√©es</span>
                    <button class="note-button" onclick="toggleNote('langues-maitrisees')">?</button>
                    <textarea class="note-input" id="note-langues-maitrisees" placeholder="Ajoutez vos observations..."></textarea>
                </div>
                
                <div class="factor-item">
                    <div class="factor-circle apprentissage" data-factor="objectifs"></div>
                    <span class="factor-text">Capacit√© √† se fixer des objectifs</span>
                    <button class="note-button" onclick="toggleNote('objectifs')">?</button>
                    <textarea class="note-input" id="note-objectifs" placeholder="Ajoutez vos observations..."></textarea>
                </div>
            </div>

            <div class="factor-category ecrit">
                <h3>
                    Rapport √† l'√©crit
                    <span class="category-counter" id="counter-ecrit">0 s√©lectionn√©</span>
                </h3>
                
                <div class="factor-item">
                    <div class="factor-circle ecrit" data-factor="alphabetisation-origine"></div>
                    <span class="factor-text">Alphab√©tisation dans la langue d'origine</span>
                    <button class="note-button" onclick="toggleNote('alphabetisation-origine')">?</button>
                    <textarea class="note-input" id="note-alphabetisation-origine" placeholder="Ajoutez vos observations..."></textarea>
                </div>
                
                <div class="factor-item">
                    <div class="factor-circle ecrit" data-factor="conscience-phonologique"></div>
                    <span class="factor-text">Conscience phonologique</span>
                    <button class="note-button" onclick="toggleNote('conscience-phonologique')">?</button>
                    <textarea class="note-input" id="note-conscience-phonologique" placeholder="Ajoutez vos observations..."></textarea>
                </div>
                
                <div class="factor-item">
                    <div class="factor-circle ecrit" data-factor="alphabet-latin"></div>
                    <span class="factor-text">Familiarit√© avec l'alphabet latin</span>
                    <button class="note-button" onclick="toggleNote('alphabet-latin')">?</button>
                    <textarea class="note-input" id="note-alphabet-latin" placeholder="Ajoutez vos observations..."></textarea>
                </div>
                
                <div class="factor-item">
                    <div class="factor-circle ecrit" data-factor="production-ecrite"></div>
                    <span class="factor-text">Capacit√© √† produire de l'√©crit</span>
                    <button class="note-button" onclick="toggleNote('production-ecrite')">?</button>
                    <textarea class="note-input" id="note-production-ecrite" placeholder="Ajoutez vos observations..."></textarea>
                </div>
                
                <div class="factor-item">
                    <div class="factor-circle ecrit" data-factor="erreurs-fossilisees"></div>
                    <span class="factor-text">Erreurs fossilis√©es sp√©cifiques</span>
                    <button class="note-button" onclick="toggleNote('erreurs-fossilisees')">?</button>
                    <textarea class="note-input" id="note-erreurs-fossilisees" placeholder="Ajoutez vos observations..."></textarea>
                </div>
            </div>

            <div class="factor-category oral">
                <h3>
                    Habilet√©s langagi√®res orales
                    <span class="category-counter" id="counter-oral">0 s√©lectionn√©</span>
                </h3>
                
                <div class="factor-item">
                    <div class="factor-circle oral" data-factor="comprehension-orale"></div>
                    <span class="factor-text">Compr√©hension orale</span>
                    <button class="note-button" onclick="toggleNote('comprehension-orale')">?</button>
                    <textarea class="note-input" id="note-comprehension-orale" placeholder="Ajoutez vos observations..."></textarea>
                </div>
                
                <div class="factor-item">
                    <div class="factor-circle oral" data-factor="expression-orale"></div>
                    <span class="factor-text">Expression orale</span>
                    <button class="note-button" onclick="toggleNote('expression-orale')">?</button>
                    <textarea class="note-input" id="note-expression-orale" placeholder="Ajoutez vos observations..."></textarea>
                </div>
                
                <div class="factor-item">
                    <div class="factor-circle oral" data-factor="prononciation-phonologie"></div>
                    <span class="factor-text">Prononciation et phonologie</span>
                    <button class="note-button" onclick="toggleNote('prononciation-phonologie')">?</button>
                    <textarea class="note-input" id="note-prononciation-phonologie" placeholder="Ajoutez vos observations..."></textarea>
                </div>
            </div>

            <div class="factor-category numerique">
                <h3>
                    Num√©ratie & num√©rique
                    <span class="category-counter" id="counter-numerique">0 s√©lectionn√©</span>
                </h3>
                
                <div class="factor-item">
                    <div class="factor-circle numerique" data-factor="calcul-mental"></div>
                    <span class="factor-text">Calcul mental</span>
                    <button class="note-button" onclick="toggleNote('calcul-mental')">?</button>
                    <textarea class="note-input" id="note-calcul-mental" placeholder="Ajoutez vos observations..."></textarea>
                </div>
                
                <div class="factor-item">
                    <div class="factor-circle numerique" data-factor="numeratie-ecrite"></div>
                    <span class="factor-text">Num√©ratie √©crite (pourcentages, fractions)</span>
                    <button class="note-button" onclick="toggleNote('numeratie-ecrite')">?</button>
                    <textarea class="note-input" id="note-numeratie-ecrite" placeholder="Ajoutez vos observations..."></textarea>
                </div>
                
                <div class="factor-item">
                    <div class="factor-circle numerique" data-factor="interpretation-donnees"></div>
                    <span class="factor-text">Interpr√©tation de donn√©es (tableaux, graphiques)</span>
                    <button class="note-button" onclick="toggleNote('interpretation-donnees')">?</button>
                    <textarea class="note-input" id="note-interpretation-donnees" placeholder="Ajoutez vos observations..."></textarea>
                </div>
                
                <div class="factor-item">
                    <div class="factor-circle numerique" data-factor="usage-technologies"></div>
                    <span class="factor-text">Usage de base des technologies</span>
                    <button class="note-button" onclick="toggleNote('usage-technologies')">?</button>
                    <textarea class="note-input" id="note-usage-technologies" placeholder="Ajoutez vos observations..."></textarea>
                </div>
                
                <div class="factor-item">
                    <div class="factor-circle numerique" data-factor="communication-numerique"></div>
                    <span class="factor-text">Communication num√©rique √©crite</span>
                    <button class="note-button" onclick="toggleNote('communication-numerique')">?</button>
                    <textarea class="note-input" id="note-communication-numerique" placeholder="Ajoutez vos observations..."></textarea>
                </div>
                
                <div class="factor-item">
                    <div class="factor-circle numerique" data-factor="navigation-information"></div>
                    <span class="factor-text">Navigation dans l'information num√©rique</span>
                    <button class="note-button" onclick="toggleNote('navigation-information')">?</button>
                    <textarea class="note-input" id="note-navigation-information" placeholder="Ajoutez vos observations..."></textarea>
                </div>
            </div>

            <div class="factor-category transversal">
                <h3>
                    Comp√©tences transversales
                    <span class="category-counter" id="counter-transversal">0 s√©lectionn√©</span>
                </h3>
                
                <div class="factor-item">
                    <div class="factor-circle transversal" data-factor="adaptation-changements"></div>
                    <span class="factor-text">Capacit√© d'adaptation face aux changements</span>
                    <button class="note-button" onclick="toggleNote('adaptation-changements')">?</button>
                    <textarea class="note-input" id="note-adaptation-changements" placeholder="Ajoutez vos observations..."></textarea>
                </div>
                
                <div class="factor-item">
                    <div class="factor-circle transversal" data-factor="collaboration-equipe"></div>
                    <span class="factor-text">Collaboration et travail en √©quipe</span>
                    <button class="note-button" onclick="toggleNote('collaboration-equipe')">?</button>
                    <textarea class="note-input" id="note-collaboration-equipe" placeholder="Ajoutez vos observations..."></textarea>
                </div>
                
                <div class="factor-item">
                    <div class="factor-circle transversal" data-factor="gestion-stress"></div>
                    <span class="factor-text">Gestion du stress et tol√©rance √† la frustration</span>
                    <button class="note-button" onclick="toggleNote('gestion-stress')">?</button>
                    <textarea class="note-input" id="note-gestion-stress" placeholder="Ajoutez vos observations..."></textarea>
                </div>
                
                <div class="factor-item">
                    <div class="factor-circle transversal" data-factor="esprit-critique"></div>
                    <span class="factor-text">Esprit critique et r√©solution de probl√®mes</span>
                    <button class="note-button" onclick="toggleNote('esprit-critique')">?</button>
                    <textarea class="note-input" id="note-esprit-critique" placeholder="Ajoutez vos observations..."></textarea>
                </div>
            </div>
        </div>

        <div class="profile-result" id="profile-result">
            <div class="success-message" id="successMessage">
                ‚úÖ Profil g√©n√©r√© avec succ√®s ! Vous pouvez maintenant l'imprimer.
            </div>
            <h2 id="profile-title">Profil g√©n√©r√© pour</h2>
            <div class="profile-section">
                <h3>Contexte</h3>
                <p id="profile-context"></p>
            </div>
            <div class="profile-section">
                <h3>Facteurs significatifs identifi√©s</h3>
                <div id="profile-factors"></div>
            </div>
            <div class="profile-section recommendations">
                <h3>Recommandations pour le regroupement</h3>
                <div id="profile-recommendations"></div>
            </div>
            <div style="text-align: center; margin-top: 25px;">
                <button class="btn tertiary" onclick="printProfile()">Imprimer le profil</button>
            </div>
        </div>
    </div>

    <script>
        let selectedFactors = {
            social: new Set(),
            apprentissage: new Set(),
            ecrit: new Set(),
            oral: new Set(),
            numerique: new Set(),
            transversal: new Set()
        };

        let factorNotes = {};

        const petalColors = {
            social: '#3498db',
            apprentissage: '#9b59b6',
            ecrit: '#2ecc71',
            oral: '#f39c12',
            numerique: '#e67e22',
            transversal: '#e74c3c'
        };

        // Charger les donn√©es sauvegard√©es au d√©marrage
        window.addEventListener('DOMContentLoaded', function() {
            loadFromLocalStorage();
        });

        // Event listeners pour les cercles de facteurs
        document.querySelectorAll('.factor-circle').forEach(circle => {
            circle.addEventListener('click', function() {
                const factor = this.getAttribute('data-factor');
                let dimension = '';
                
                if (this.classList.contains('social')) dimension = 'social';
                else if (this.classList.contains('apprentissage')) dimension = 'apprentissage';
                else if (this.classList.contains('ecrit')) dimension = 'ecrit';
                else if (this.classList.contains('oral')) dimension = 'oral';
                else if (this.classList.contains('numerique')) dimension = 'numerique';
                else if (this.classList.contains('transversal')) dimension = 'transversal';
                
                if (selectedFactors[dimension].has(factor)) {
                    selectedFactors[dimension].delete(factor);
                    this.classList.remove('selected');
                } else {
                    selectedFactors[dimension].add(factor);
                    this.classList.add('selected');
                }
                
                updatePetals();
                updateCounters();
                saveToLocalStorage();
            });
        });

        // Event listeners pour les p√©tales
        document.querySelectorAll('.petal').forEach(petal => {
            petal.addEventListener('click', function() {
                const dimension = this.getAttribute('data-dimension');
                if (dimension) {
                    const targetSection = document.querySelector(`.factor-category.${dimension}`);
                    if (targetSection) {
                        targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                }
            });
        });

        // Auto-save pour les champs de texte
        document.getElementById('learner-name').addEventListener('input', saveToLocalStorage);
        document.getElementById('context').addEventListener('input', saveToLocalStorage);

        function toggleNote(factorId) {
            const noteInput = document.getElementById('note-' + factorId);
            noteInput.classList.toggle('visible');
            if (noteInput.classList.contains('visible')) {
                noteInput.focus();
            }
        }

        function createPoint(dimension) {
            const point = document.createElement('div');
            point.className = 'point';
            point.style.background = petalColors[dimension];
            
            // Position al√©atoire dans l'ellipse du p√©tale
            const angle = Math.random() * 2 * Math.PI;
            const radiusX = 50;
            const radiusY = 25;
            
            const x = 50 + (radiusX * 0.7) * Math.cos(angle) * Math.random() - 4;
            const y = 50 + (radiusY * 0.7) * Math.sin(angle) * Math.random() - 4;
            
            point.style.left = x + '%';
            point.style.top = y + '%';
            
            return point;
        }

        function updatePetals() {
            Object.keys(selectedFactors).forEach(dimension => {
                const petal = document.querySelector(`.petal-${dimension}`);
                const count = selectedFactors[dimension].size;
                
                // Activer/d√©sactiver le p√©tale
                petal.classList.toggle('active', count > 0);
                
                // Mettre √† jour les points
                updatePoints(dimension, count);
            });
        }

        function updatePoints(dimension, count) {
            const container = document.getElementById(`points-${dimension}`);
            container.innerHTML = '';
            
            for (let i = 0; i < count; i++) {
                const point = createPoint(dimension);
                container.appendChild(point);
                
                // Animation d'apparition
                setTimeout(() => {
                    point.style.transform = 'scale(1.3)';
                    setTimeout(() => {
                        point.style.transform = 'scale(1)';
                    }, 200);
                }, i * 100);
            }
        }

        function updateCounters() {
            Object.keys(selectedFactors).forEach(dimension => {
                const count = selectedFactors[dimension].size;
                
                // Mettre √† jour le badge sur le p√©tale
                const badge = document.getElementById(`badge-${dimension}`);
                badge.textContent = count;
                
                // Mettre √† jour le compteur dans le label
                const labelCount = document.getElementById(`count-${dimension}`);
                labelCount.textContent = count;
                labelCount.classList.toggle('visible', count > 0);
                
                // Mettre √† jour le compteur dans la cat√©gorie
                const categoryCounter = document.getElementById(`counter-${dimension}`);
                categoryCounter.textContent = count > 0 ? `${count} s√©lectionn√©${count > 1 ? 's' : ''}` : '0 s√©lectionn√©';
            });
        }

        function getFactorText(factorKey) {
            const factorTexts = {
                // Social
                'utilisation-francais': 'Utilisation du fran√ßais au quotidien',
                'integration-sociale': 'Int√©gration sociale',
                'situation-economique': 'Situation socio-√©conomique',
                'reseaux-soutien': 'R√©seaux de soutien',
                'stabilite-migratoire': 'Stabilit√© du parcours migratoire',
                'disponibilite-hors-cours': 'Disponibilit√© pour consolider hors temps de cours',
                
                // Apprentissage
                'parcours-scolaire': 'Parcours scolaire ant√©rieur',
                'methodes-apprentissage': 'M√©thodes d\'apprentissage famili√®res',
                'autonomie-apprentissage': 'Autonomie d\'apprentissage',
                'langues-maitrisees': 'Langues ma√Ætris√©es',
                'objectifs': 'Capacit√© √† se fixer des objectifs',
                
                // √âcrit
                'alphabetisation-origine': 'Alphab√©tisation dans la langue d\'origine',
                'conscience-phonologique': 'Conscience phonologique',
                'alphabet-latin': 'Familiarit√© avec l\'alphabet latin',
                'production-ecrite': 'Capacit√© √† produire de l\'√©crit',
                'erreurs-fossilisees': 'Erreurs fossilis√©es sp√©cifiques',
                
                // Oral
                'comprehension-orale': 'Compr√©hension orale',
                'expression-orale': 'Expression orale',
                'prononciation-phonologie': 'Prononciation et phonologie',
                
                // Num√©rique
                'calcul-mental': 'Calcul mental',
                'numeratie-ecrite': 'Num√©ratie √©crite (pourcentages, fractions)',
                'interpretation-donnees': 'Interpr√©tation de donn√©es (tableaux, graphiques)',
                'usage-technologies': 'Usage de base des technologies',
                'communication-numerique': 'Communication num√©rique √©crite',
                'navigation-information': 'Navigation dans l\'information num√©rique',
                
                // Transversal
                'adaptation-changements': 'Capacit√© d\'adaptation face aux changements',
                'collaboration-equipe': 'Collaboration et travail en √©quipe',
                'gestion-stress': 'Gestion du stress et tol√©rance √† la frustration',
                'esprit-critique': 'Esprit critique et r√©solution de probl√®mes'
            };
            return factorTexts[factorKey] || factorKey;
        }

        function generateProfile() {
            const name = document.getElementById('learner-name').value;
            const context = document.getElementById('context').value;
            
            // Validation am√©lior√©e
            if (!name.trim()) {
                alert('‚ö†Ô∏è Veuillez entrer le nom de l\'apprenant avant de g√©n√©rer le profil.');
                document.getElementById('learner-name').focus();
                return;
            }

            // V√©rifier qu'au moins un facteur est s√©lectionn√©
            const totalFactors = Object.values(selectedFactors).reduce((sum, set) => sum + set.size, 0);
            if (totalFactors === 0) {
                alert('‚ö†Ô∏è Veuillez s√©lectionner au moins un facteur avant de g√©n√©rer le profil.\n\nCliquez sur les cercles color√©s pour s√©lectionner les facteurs pertinents pour cet apprenant.');
                return;
            }

            // Collecter les notes
            factorNotes = {};
            document.querySelectorAll('.note-input').forEach(input => {
                if (input.value.trim()) {
                    const factorId = input.id.replace('note-', '');
                    factorNotes[factorId] = input.value.trim();
                }
            });

            // Mettre √† jour le profil
            document.getElementById('profile-title').textContent = 'Profil g√©n√©r√© pour ' + name;
            document.getElementById('profile-context').textContent = context || 'Aucun contexte sp√©cifi√©';

            // G√©n√©rer les facteurs par dimension
            const factorsHtml = generateFactorsHtml();
            document.getElementById('profile-factors').innerHTML = factorsHtml;

            // G√©n√©rer des recommandations
            const recommendations = generateRecommendations();
            document.getElementById('profile-recommendations').innerHTML = recommendations;

            // Afficher le message de succ√®s
            const successMessage = document.getElementById('successMessage');
            successMessage.classList.add('visible');
            setTimeout(() => {
                successMessage.classList.remove('visible');
            }, 5000);

            // Activer le bouton d'impression
            document.getElementById('printBtn').disabled = false;

            // Afficher le profil
            document.getElementById('profile-result').classList.add('visible');
            document.getElementById('profile-result').scrollIntoView({ behavior: 'smooth' });
        }

        function generateFactorsHtml() {
            let html = '';
            
            const dimensions = {
                'social': 'Environnement socioculturel',
                'apprentissage': 'Comp√©tences d\'apprentissage',
                'ecrit': 'Rapport √† l\'√©crit',
                'oral': 'Habilet√©s langagi√®res orales',
                'numerique': 'Num√©ratie & num√©rique',
                'transversal': 'Comp√©tences transversales'
            };

            for (const [dim, title] of Object.entries(dimensions)) {
                if (selectedFactors[dim].size > 0) {
                    html += `<h4>${title} (${selectedFactors[dim].size} facteur${selectedFactors[dim].size > 1 ? 's' : ''})</h4><ul>`;
                    
                    selectedFactors[dim].forEach(factor => {
                        const factorText = getFactorText(factor);
                        const note = factorNotes[factor] ? ` - <em>${factorNotes[factor]}</em>` : '';
                        html += `<li><strong>${factorText}</strong>${note}</li>`;
                    });
                    
                    html += '</ul>';
                }
            }

            return html || '<p>Aucun facteur sp√©cifique identifi√©.</p>';
        }

        function generateRecommendations() {
            const totalFactors = Object.values(selectedFactors).reduce((sum, set) => sum + set.size, 0);
            
            if (totalFactors === 0) {
                return '<p>Effectuez une analyse plus d√©taill√©e pour obtenir des recommandations personnalis√©es.</p>';
            }

            let recommendations = '<p><strong>Sur la base des facteurs identifi√©s :</strong></p><ul>';

            // Profil Alpha
            if (selectedFactors.ecrit.size >= 3 && selectedFactors.apprentissage.size <= 2) {
                recommendations += '<li><strong>Profil Alpha :</strong> Approche sp√©cialis√©e en alphab√©tisation avec d√©veloppement de la conscience phonologique</li>';
            }

            // Profil Illettrisme
            if (selectedFactors.ecrit.size >= 2 && selectedFactors.social.size >= 2) {
                recommendations += '<li><strong>Profil Illettrisme :</strong> Rem√©diation cibl√©e avec valorisation des comp√©tences orales</li>';
            }

            // Profil FLE
            if (selectedFactors.oral.size >= 2 && selectedFactors.apprentissage.size >= 2) {
                recommendations += '<li><strong>Profil FLE/S :</strong> Approche communicative avec d√©veloppement des habilet√©s orales</li>';
            }

            // Recommandations par dimension
            if (selectedFactors.transversal.size >= 3) {
                recommendations += '<li><strong>Comp√©tences transversales :</strong> Valoriser et d√©velopper ces comp√©tences comme levier d\'apprentissage</li>';
            }

            if (selectedFactors.numerique.size >= 3) {
                recommendations += '<li><strong>Num√©ratie/num√©rique :</strong> Int√©grer ces comp√©tences comme support d\'apprentissage</li>';
            }

            recommendations += '<li><strong>Suivi r√©gulier :</strong> R√©√©valuer le profil tous les 2-3 mois pour ajuster l\'accompagnement</li>';
            recommendations += '<li><strong>Approche holistique :</strong> Tenir compte de toutes les dimensions identifi√©es dans la planification p√©dagogique</li>';
            recommendations += '</ul>';

            return recommendations;
        }

        function printProfile() {
            if (!document.getElementById('profile-result').classList.contains('visible')) {
                alert('‚ö†Ô∏è Veuillez d\'abord g√©n√©rer le profil avant de l\'imprimer.');
                return;
            }
            
            window.print();
        }

        function resetTool() {
            if (confirm('√ätes-vous s√ªr de vouloir r√©initialiser l\'outil ? Toutes les donn√©es seront perdues.')) {
                // R√©initialiser les champs
                document.getElementById('learner-name').value = '';
                document.getElementById('context').value = '';
                
                // R√©initialiser les s√©lections
                selectedFactors = {
                    social: new Set(),
                    apprentissage: new Set(),
                    ecrit: new Set(),
                    oral: new Set(),
                    numerique: new Set(),
                    transversal: new Set()
                };
                factorNotes = {};
                
                // R√©initialiser l'apparence
                document.querySelectorAll('.factor-circle').forEach(circle => {
                    circle.classList.remove('selected');
                });
                
                document.querySelectorAll('.petal').forEach(petal => {
                    petal.classList.remove('active');
                });
                
                // Vider tous les points
                document.querySelectorAll('.petal-points').forEach(container => {
                    container.innerHTML = '';
                });
                
                document.querySelectorAll('.note-input').forEach(input => {
                    input.value = '';
                    input.classList.remove('visible');
                });

                // R√©initialiser les compteurs
                updateCounters();

                // D√©sactiver le bouton d'impression
                document.getElementById('printBtn').disabled = true;

                // Cacher le profil
                document.getElementById('profile-result').classList.remove('visible');
                
                // Effacer le localStorage
                localStorage.removeItem('cartographieData');
                
                // Remonter en haut
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // Sauvegarde automatique
        function saveToLocalStorage() {
            const data = {
                learnerName: document.getElementById('learner-name').value,
                context: document.getElementById('context').value,
                selectedFactors: {
                    social: Array.from(selectedFactors.social),
                    apprentissage: Array.from(selectedFactors.apprentissage),
                    ecrit: Array.from(selectedFactors.ecrit),
                    oral: Array.from(selectedFactors.oral),
                    numerique: Array.from(selectedFactors.numerique),
                    transversal: Array.from(selectedFactors.transversal)
                },
                factorNotes: factorNotes
            };

            localStorage.setItem('cartographieData', JSON.stringify(data));
            
            // Afficher l'indicateur de sauvegarde
            const indicator = document.getElementById('autoSaveIndicator');
            indicator.classList.add('visible');
            setTimeout(() => {
                indicator.classList.remove('visible');
            }, 2000);
        }

        // Charger depuis le localStorage
        function loadFromLocalStorage() {
            const savedData = localStorage.getItem('cartographieData');
            if (savedData) {
                const data = JSON.parse(savedData);
                
                // Restaurer les champs de texte
                document.getElementById('learner-name').value = data.learnerName || '';
                document.getElementById('context').value = data.context || '';
                
                // Restaurer les facteurs s√©lectionn√©s
                if (data.selectedFactors) {
                    Object.keys(data.selectedFactors).forEach(dimension => {
                        selectedFactors[dimension] = new Set(data.selectedFactors[dimension]);
                        
                        // Marquer les cercles comme s√©lectionn√©s
                        data.selectedFactors[dimension].forEach(factor => {
                            const circle = document.querySelector(`.factor-circle[data-factor="${factor}"]`);
                            if (circle) {
                                circle.classList.add('selected');
                            }
                        });
                    });
                }
                
                // Restaurer les notes
                if (data.factorNotes) {
                    factorNotes = data.factorNotes;
                    Object.keys(factorNotes).forEach(factorId => {
                        const input = document.getElementById('note-' + factorId);
                        if (input) {
                            input.value = factorNotes[factorId];
                        }
                    });
                }
                
                // Mettre √† jour l'affichage
                updatePetals();
                updateCounters();
            }
        }

        // Sauvegarder automatiquement les notes
        document.querySelectorAll('.note-input').forEach(input => {
            input.addEventListener('input', function() {
                const factorId = this.id.replace('note-', '');
                if (this.value.trim()) {
                    factorNotes[factorId] = this.value.trim();
                } else {
                    delete factorNotes[factorId];
                }
                saveToLocalStorage();
            });
        });
    </script>
</body>
</html>