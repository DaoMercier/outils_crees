<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio de D√©veloppement des Comp√©tences - Brevet F√©d√©ral de Formateur/trice</title>
    <style>
        :root {
            --primary-color: #2a6496;
            --secondary-color: #3498db;
            --accent-color: #e67e22;
            --light-bg: #f8f9fa;
            --border-color: #dee2e6;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --text-color: #333;
            --text-light: #6c757d;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: #f4f7f9;
            margin: 0;
            padding: 0;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: white;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        
        header {
            text-align: center;
            padding: 20px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 6px 6px 0 0;
            margin-bottom: 30px;
            position: relative;
        }
        
        header h1 {
            margin: 0;
            font-size: 2.2em;
        }
        
        header p {
            margin: 10px 0 0;
            font-size: 1.1em;
            opacity: 0.9;
        }
        
      .attribution {
    margin-top: 15px;
    font-size: 0.85em;
    opacity: 0.9;
    text-align: center;
}
        
        .logo {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 80px;
            height: auto;
        }
        
        .tabs {
            display: flex;
            flex-wrap: wrap;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 30px;
        }
        
        .tab {
            padding: 12px 25px;
            cursor: pointer;
            background-color: #f1f1f1;
            border: none;
            border-radius: 6px 6px 0 0;
            font-weight: 600;
            color: var(--text-light);
            margin-right: 5px;
            margin-bottom: 5px;
            transition: all 0.3s ease;
        }
        
        .tab.active {
            background-color: var(--primary-color);
            color: white;
        }
        
        .tab:hover:not(.active) {
            background-color: #e9ecef;
        }
        
        .tab-content {
            display: none;
            padding: 20px;
            border: 1px solid var(--border-color);
            border-top: none;
            border-radius: 0 0 6px 6px;
            animation: fadeIn 0.5s;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        h2 {
            color: var(--primary-color);
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 10px;
            margin-top: 30px;
        }
        
        h3 {
            color: var(--secondary-color);
            margin-top: 25px;
            padding-left: 10px;
            border-left: 4px solid var(--accent-color);
        }
        
        .card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 25px;
            border-left: 5px solid var(--primary-color);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .card-title {
            font-size: 1.2em;
            font-weight: 600;
            color: var(--primary-color);
            margin: 0;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #1e5185;
        }
        
        .btn-success {
            background-color: var(--success-color);
            color: white;
        }
        
        .btn-success:hover {
            background-color: #219653;
        }
        
        .btn-warning {
            background-color: var(--warning-color);
            color: white;
        }
        
        .btn-warning:hover {
            background-color: #e67e22;
        }
        
        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
        }
        
        .btn-outline {
            border: 1px solid var(--primary-color);
            background: transparent;
            color: var(--primary-color);
        }
        
        .btn-outline:hover {
            background-color: #f0f7ff;
        }
        
        .btn-group {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-color);
        }
        
        .form-control {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-family: inherit;
            font-size: 1em;
            transition: border-color 0.2s ease;
        }
        
        .form-control:focus {
            border-color: var(--secondary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.25);
        }
        
        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }
        
        .competence-selector {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .competence-card {
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .competence-card:hover {
            border-color: var(--secondary-color);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .competence-card.selected {
            border-color: var(--success-color);
            background-color: rgba(39, 174, 96, 0.1);
        }
        
        .competence-card h4 {
            margin-top: 0;
            color: var(--primary-color);
        }
        
        .competence-card p {
            margin-bottom: 0;
            font-size: 0.9em;
            color: var(--text-light);
        }
        
        .situation-wrapper {
            background-color: var(--light-bg);
            border-radius: 6px;
            padding: 20px;
            margin-bottom: 25px;
        }
        
        .proof-card {
            display: flex;
            background-color: white;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
            gap: 15px;
            align-items: center;
        }
        
        .proof-icon {
            font-size: 1.5em;
            color: var(--accent-color);
            flex-shrink: 0;
        }
        
        .proof-details {
            flex: 1;
        }
        
        .proof-title {
            font-weight: 600;
            margin: 0 0 5px 0;
        }
        
        .proof-description {
            color: var(--text-light);
            margin: 0;
            font-size: 0.9em;
        }
        
        .proof-upload {
            background-color: var(--light-bg);
            border: 2px dashed var(--border-color);
            border-radius: 6px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: border-color 0.2s;
            margin-bottom: 15px;
        }
        
        .proof-upload:hover {
            border-color: var(--accent-color);
        }
        
        .proof-upload i {
            font-size: 2.5em;
            color: var(--text-light);
            margin-bottom: 15px;
        }
        
        .proof-upload p {
            margin: 0;
            color: var(--text-light);
        }
        
        .progress-tracker {
            margin: 30px 0;
        }
        
        .progress-bar {
            background-color: var(--light-bg);
            border-radius: 8px;
            height: 10px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background-color: var(--success-color);
            border-radius: 8px;
            width: 0;
            transition: width 1s ease;
        }
        
        .progress-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.9em;
            color: var(--text-light);
        }
        
        .rating-scale {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
        }
        
        .rating-item {
            text-align: center;
            flex: 1;
            max-width: 100px;
            cursor: pointer;
        }
        
        .rating-circle {
            height: 35px;
            width: 35px;
            border-radius: 50%;
            background-color: var(--light-bg);
            margin: 0 auto 8px;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .rating-item:hover .rating-circle {
            background-color: #d4e9f7;
        }
        
        .rating-item.selected .rating-circle {
            background-color: var(--primary-color);
            color: white;
        }
        
        .rating-label {
            font-size: 0.85em;
        }
        
        .timeline {
            margin: 30px 0;
            position: relative;
        }
        
        .timeline::before {
            content: '';
            position: absolute;
            top: 0;
            bottom: 0;
            left: 20px;
            width: 4px;
            background-color: var(--secondary-color);
            border-radius: 4px;
        }
        
        .timeline-item {
            position: relative;
            padding-left: 60px;
            margin-bottom: 30px;
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: 18px;
            top: 15px;
            width: 10px;
            height: 10px;
            background-color: var(--secondary-color);
            border-radius: 50%;
            z-index: 1;
        }
        
        .timeline-item.milestone::before {
            background-color: var(--accent-color);
            border: 2px solid white;
            width: 16px;
            height: 16px;
            left: 14px;
            top: 12px;
        }
        
        .timeline-date {
            position: absolute;
            left: 45px;
            top: 0px;
            font-size: 0.9em;
            color: var(--text-light);
        }
        
        .timeline-content {
            background-color: white;
            padding: 15px;
            border-radius: 6px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .timeline-title {
            margin-top: 0;
            color: var(--primary-color);
        }
        
        .reflection-prompts {
            margin: 30px 0;
        }
        
        .reflection-prompt {
            background-color: #fff3e0;
            border-left: 4px solid var(--accent-color);
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 0 6px 6px 0;
        }
        
        .reflection-prompt p {
            margin: 0;
            font-style: italic;
            color: #775500;
        }
        
        .theory-link {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
            padding: 15px;
            background-color: #f0f7ff;
            border-radius: 6px;
        }
        
        .theory-icon {
            margin-right: 15px;
            color: var(--primary-color);
            font-size: 1.3em;
        }
        
        .theory-content {
            flex: 1;
        }
        
        .theory-content h4 {
            margin-top: 0;
            color: var(--primary-color);
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        .comparison-table th, .comparison-table td {
            border: 1px solid var(--border-color);
            padding: 12px;
            text-align: left;
        }
        
        .comparison-table th {
            background-color: var(--light-bg);
            font-weight: 600;
        }
        
        .comparison-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        .development-goals {
            margin: 30px 0;
        }
        
        .goal-card {
            background-color: white;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid var(--accent-color);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .goal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .goal-title {
            font-weight: 600;
            margin: 0;
        }
        
        .goal-date {
            font-size: 0.85em;
            color: var(--text-light);
        }
        
        .goal-progress {
            margin: 15px 0;
        }
        
        .alert {
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            border-left: 4px solid;
        }
        
        .alert-info {
            background-color: #e1f5fe;
            border-color: #03a9f4;
            color: #014361;
        }
        
        .alert-warning {
            background-color: #fff8e1;
            border-color: #ffc107;
            color: #856404;
        }
        
        .alert-success {
            background-color: #e8f5e9;
            border-color: #4caf50;
            color: #1b5e20;
        }
        
        .alert-danger {
            background-color: #ffebee;
            border-color: #f44336;
            color: #b71c1c;
        }
        
        .alert-info h4, .alert-warning h4, .alert-success h4, .alert-danger h4 {
            margin-top: 0;
            color: inherit;
        }
        
        footer {
            text-align: center;
            padding: 25px;
            margin-top: 50px;
            color: var(--text-light);
            border-top: 1px solid var(--border-color);
        }
        
        .help-section {
            margin-bottom: 30px;
        }
        
        .help-step {
            background-color: white;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid var(--primary-color);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .help-step h4 {
            margin-top: 0;
            color: var(--primary-color);
        }
        
        .help-image {
            max-width: 100%;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            margin: 10px 0;
        }
        
        .note {
            background-color: #fff8e1;
            padding: 10px 15px;
            border-radius: 4px;
            margin: 10px 0;
            font-style: italic;
            border-left: 3px solid #ffc107;
        }
        
        .shortcut {
            display: inline-block;
            background-color: #f1f1f1;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
            margin: 0 2px;
        }
        
        .accordion {
            background-color: #f1f1f1;
            color: var(--primary-color);
            cursor: pointer;
            padding: 18px;
            width: 100%;
            text-align: left;
            border: none;
            outline: none;
            transition: 0.4s;
            border-radius: 4px;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .accordion:hover {
            background-color: #ddd;
        }
        
        .accordion-panel {
            padding: 0 18px;
            background-color: white;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.2s ease-out;
            border-radius: 0 0 4px 4px;
            border: 1px solid #f1f1f1;
            border-top: none;
        }
        
        .accordion:after {
            content: '\02795'; /* Unicode character for "plus" sign (+) */
            font-size: 13px;
            color: var(--primary-color);
            float: right;
            margin-left: 5px;
        }
        
        .accordion.active:after {
            content: "\2796"; /* Unicode character for "minus" sign (-) */
        }
        
        .active {
            background-color: #e9ecef;
        }
        
        .save-status {
            display: inline-block;
            padding: 5px 10px;
            font-size: 0.85em;
            border-radius: 3px;
            margin-left: 10px;
            transition: opacity 0.3s ease;
        }
        
        .save-success {
            background-color: rgba(39, 174, 96, 0.2);
            color: var(--success-color);
        }
        
        .save-error {
            background-color: rgba(231, 76, 60, 0.2);
            color: var(--danger-color);
        }
        
        .hidden {
            display: none;
        }
        
        .fade-out {
            opacity: 0;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        
        .modal-content {
            background-color: white;
            margin: 10% auto;
            padding: 20px;
            width: 80%;
            max-width: 600px;
            border-radius: 6px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            position: relative;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .modal-title {
            margin: 0;
            color: var(--primary-color);
        }
        
        .close-modal {
            color: var(--text-light);
            font-size: 1.5em;
            font-weight: bold;
            cursor: pointer;
        }
        
        .close-modal:hover {
            color: var(--text-color);
        }
        
        .export-options {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .export-option {
            flex: 1;
            min-width: 150px;
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .export-option:hover {
            background-color: var(--light-bg);
            border-color: var(--secondary-color);
        }
        
        .export-option i {
            font-size: 2em;
            margin-bottom: 10px;
            color: var(--primary-color);
        }
        
        .backup-reminder {
            background-color: #e1f5fe;
            padding: 10px 15px;
            border-radius: 4px;
            margin: 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .backup-reminder i {
            color: #03a9f4;
            font-size: 1.5em;
        }
        
        /* Styles pour les crit√®res de performance */
        .critere-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 10px;
            padding: 8px;
            background-color: var(--light-bg);
            border-radius: 4px;
        }
        
        .critere-checkbox {
            margin-right: 10px;
            margin-top: 3px;
        }
        
        .critere-label {
            margin: 0;
            font-weight: normal;
        }
        
        /* Styles pour la liste des domaines de comp√©tence */
        .domaine-heading {
            background-color: var(--light-bg);
            padding: 10px 15px;
            margin-top: 20px;
            border-radius: 4px;
            font-weight: 600;
            color: var(--primary-color);
            border-left: 4px solid var(--accent-color);
        }
        
        @media print {
            body {
                background-color: white;
                color: black;
            }
            
            .container {
                max-width: 100%;
                box-shadow: none;
                padding: 0;
                margin: 0;
            }
            
            header {
                background-color: white;
                color: black;
                padding: 10px 0;
                text-align: left;
            }
            
            .tabs, .btn, .action-buttons, footer, .backup-reminder {
                display: none !important;
            }
            
            .tab-content {
                display: block !important;
                padding: 0;
                border: none;
            }
            
            .card {
                border: 1px solid #ddd;
                box-shadow: none;
                break-inside: avoid;
                page-break-inside: avoid;
                margin: 10px 0;
            }
            
            .card:hover {
                transform: none;
                box-shadow: none;
            }
            
            h2 {
                color: black;
                border-bottom: 1px solid black;
            }
            
            h3 {
                color: black;
                border-left: 2px solid black;
            }
            
            a {
                text-decoration: none;
                color: black;
            }
            
            .accordion-panel {
                max-height: none !important;
                display: block !important;
            }
        }
        
        @media (max-width: 768px) {
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                border-radius: 0;
                margin-right: 0;
                margin-bottom: 2px;
            }
            
            .competence-selector {
                grid-template-columns: 1fr;
            }
            
            .rating-scale {
                flex-wrap: wrap;
            }
            
            .rating-item {
                margin-bottom: 10px;
                min-width: 60px;
            }
            
            .timeline-item {
                padding-left: 45px;
            }
            
            .timeline-date {
                position: relative;
                left: 0;
                top: 0;
                margin-bottom: 5px;
            }
            
            .card-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .action-buttons {
                margin-top: 10px;
                width: 100%;
                justify-content: flex-start;
            }
            
            .export-options {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Portfolio de D√©veloppement des Comp√©tences</h1>
            <p>Brevet F√©d√©ral de Formateur/trice d'Adultes</p>
            <div class="attribution">Cr√©√© par Dao Mercier pour le CPNE-AS - D√©veloppement : Claude (Anthropic, 2025)</div>
        </header>
        
        <div class="tabs">
    <div class="tabs">
    <button class="tab active" onclick="openTab(event, 'guide')" style="background: #D4EDDA; color: #155724;">üìñ Guide d'utilisation</button>
    <button class="tab" onclick="openTab(event, 'example')" style="background: #D4EDDA; color: #155724;">üìù Exemple</button>
    <button class="tab" onclick="openTab(event, 'overview')">Tableau de bord</button>
    <button class="tab" onclick="openTab(event, 'competences')">Comp√©tences op√©rationnelles</button>
    <button class="tab" onclick="openTab(event, 'situations')">Situations de travail</button>
    <button class="tab" onclick="openTab(event, 'evidence')">Preuves et Justificatifs</button>
    <button class="tab" onclick="openTab(event, 'reflection')">R√©flexion et √âvaluation</button>
    <button class="tab" onclick="openTab(event, 'progress')">Progr√®s et Plans</button>
</div>
        
        <!-- VUE D'ENSEMBLE -->
       <!-- Guide Tab -->
<div id="guide" class="tab-content active">
    <div class="bg-white rounded-lg shadow-sm p-8 mb-6">
        <h2 class="text-2xl font-bold text-gray-800 mb-4">üìñ Comment utiliser ce portfolio ?</h2>
        
        <div class="bg-purple-50 border-l-4 border-purple-400 p-4 mb-6">
            <p class="text-gray-700 italic">
                Ce portfolio est votre <strong>outil de travail personnel</strong> pour d√©velopper vos comp√©tences d'accompagnement. 
                Il vous accompagne tout au long de votre formation et vous aide √† pr√©parer votre certification.
            </p>
        </div>

        <div class="space-y-6">
            <div>
                <h3 class="text-xl font-semibold text-gray-800 mb-3 flex items-center">
                    <span class="bg-purple-100 text-purple-700 rounded-full w-8 h-8 flex items-center justify-center mr-3 text-sm font-bold">1</span>
                    D√©couvrez l'outil
                </h3>
                <div class="ml-11 space-y-2 text-gray-700">
                    <p>üëâ <strong>Explorez les 5 onglets</strong> pour comprendre la structure du portfolio</p>
                    <p>üëâ <strong>Regardez l'exemple pr√©-rempli</strong> dans "Situations d'apprentissage" pour voir √† quoi ressemble une situation document√©e</p>
                    <p>üëâ <strong>Pas de panique !</strong> Vous n'avez pas besoin de tout remplir d√®s maintenant</p>
                </div>
            </div>

            <div>
                <h3 class="text-xl font-semibold text-gray-800 mb-3 flex items-center">
                    <span class="bg-purple-100 text-purple-700 rounded-full w-8 h-8 flex items-center justify-center mr-3 text-sm font-bold">2</span>
                    Documentez vos situations r√©elles
                </h3>
                <div class="ml-11 space-y-2 text-gray-700">
                    <p>üëâ Allez dans <strong>"Situations d'apprentissage"</strong> et cliquez sur "Ajouter une situation"</p>
                    <p>üëâ Choisissez une situation d'accompagnement que vous vivez actuellement (groupe OU individuel)</p>
                    <p>üëâ Remplissez progressivement : vous pouvez commencer par le contexte, puis ajouter le reste au fur et √† mesure</p>
                    <p class="text-sm italic text-gray-600">üí° Conseil : √âcrivez comme si vous preniez des notes pour vous-m√™me. Pas besoin de phrases parfaites !</p>
                </div>
            </div>

            <div>
                <h3 class="text-xl font-semibold text-gray-800 mb-3 flex items-center">
                    <span class="bg-purple-100 text-purple-700 rounded-full w-8 h-8 flex items-center justify-center mr-3 text-sm font-bold">3</span>
                    Exp√©rimentez sur le terrain
                </h3>
                <div class="ml-11 space-y-2 text-gray-700">
                    <p>üëâ Dans chaque situation, une section <strong>"Exp√©rimentations"</strong> vous permet de noter :</p>
                    <ul class="list-disc list-inside ml-4 space-y-1">
                        <li>Ce que vous avez test√© concr√®tement</li>
                        <li>Ce qui a fonctionn√©</li>
                        <li>Ce qui a √©t√© difficile</li>
                        <li>Ce que vous en apprenez</li>
                    </ul>
                    <p class="text-sm italic text-gray-600">üí° Conseil : Les "√©checs" sont aussi pr√©cieux que les r√©ussites. Documentez tout !</p>
                </div>
            </div>

            <div>
                <h3 class="text-xl font-semibold text-gray-800 mb-3 flex items-center">
                    <span class="bg-purple-100 text-purple-700 rounded-full w-8 h-8 flex items-center justify-center mr-3 text-sm font-bold">4</span>
                    Identifiez vos comp√©tences
                </h3>
                <div class="ml-11 space-y-2 text-gray-700">
                    <p>üëâ Pour chaque situation, cochez les <strong>comp√©tences</strong> que vous activez</p>
                    <p>üëâ Rendez-vous dans l'onglet <strong>"Comp√©tences"</strong> pour voir votre progression globale</p>
                    <p>üëâ Cela vous aide √† prendre conscience de vos forces et axes de d√©veloppement</p>
                </div>
            </div>

            <div>
                <h3 class="text-xl font-semibold text-gray-800 mb-3 flex items-center">
                    <span class="bg-purple-100 text-purple-700 rounded-full w-8 h-8 flex items-center justify-center mr-3 text-sm font-bold">5</span>
                    Pr√©parez votre certification
                </h3>
                <div class="ml-11 space-y-2 text-gray-700">
                    <p>üëâ Le portfolio vous aide √† collecter <strong>progressivement</strong> les mat√©riaux pour votre dossier final</p>
                    <p>üëâ Collectez des <strong>preuves/artefacts</strong> au fur et √† mesure (photos, documents, t√©moignages...)</p>
                    <p>üëâ √Ä la fin du module, vous aurez d√©j√† une bonne base pour votre certification</p>
                </div>
            </div>
        </div>

        <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mt-8">
            <h4 class="font-semibold text-gray-800 mb-2">‚ùì Questions fr√©quentes</h4>
            <div class="space-y-3 text-gray-700 text-sm">
                <div>
                    <p class="font-medium">¬´ Je n'ai pas encore de situation √† documenter ¬ª</p>
                    <p class="ml-4">‚Üí Pas de souci ! Vous pouvez documenter une situation pass√©e r√©cente et r√©fl√©chir √† ce que vous auriez pu faire diff√©remment.</p>
                </div>
                <div>
                    <p class="font-medium">¬´ Le portfolio est complexe, par o√π commencer ? ¬ª</p>
                    <p class="ml-4">‚Üí Commencez UNIQUEMENT par l'onglet "Situations d'apprentissage". Ajoutez UNE situation. Le reste viendra progressivement.</p>
                </div>
                <div>
                    <p class="font-medium">¬´ Combien de temps √ßa prend ? ¬ª</p>
                    <p class="ml-4">‚Üí 30-45 minutes pour documenter une premi√®re situation. Ensuite, 10-15 minutes apr√®s chaque exp√©rimentation terrain.</p>
                </div>
                <div>
                    <p class="font-medium">¬´ Est-ce que mes donn√©es sont sauvegard√©es ? ¬ª</p>
                    <p class="ml-4">‚Üí Oui ! Tout est enregistr√© localement dans votre navigateur. Pensez √† exporter r√©guli√®rement (bouton en haut √† droite).</p>
                </div>
            </div>
        </div>

        <div class="mt-8 text-center">
            <button onclick="showTab('situations')" class="bg-purple-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-purple-700 transition-colors">
                üöÄ Commencer : Ajouter ma premi√®re situation
            </button>
        </div>
    </div>
</div> 
<!-- EXEMPLE DE PORTFOLIO -->
<div id="example" class="tab-content">
    <div class="bg-white rounded-lg shadow-sm p-8 mb-6">
        <h2 class="text-2xl font-bold text-gray-800 mb-4">üìù Exemple : Portfolio en construction (Module MDA)</h2>
        
        <div class="bg-green-50 border-l-4 border-green-400 p-4 mb-6">
            <p class="text-gray-700">
                <strong>Ceci est un exemple fictif</strong> pour vous montrer √† quoi ressemble un portfolio en cours de d√©veloppement. 
                Notez comment la situation est d√©crite d'abord, puis les comp√©tences sont identifi√©es apr√®s coup ! üòä
            </p>
        </div>

        <!-- Profil -->
        <div class="mb-8">
            <h3 class="text-xl font-semibold text-gray-800 mb-4 border-b pb-2">üë§ Profil personnel</h3>
            
            <div class="space-y-3 text-gray-700">
                <div>
                    <p class="font-medium text-gray-800">Nom :</p>
                    <p>Jean-Marc Favre <em>(fictif)</em></p>
                </div>
                
                <div>
                    <p class="font-medium text-gray-800">Institution :</p>
                    <p>Centre de formation professionnelle TransportPlus</p>
                </div>
                
                <div>
                    <p class="font-medium text-gray-800">Exp√©rience :</p>
                    <p>Formateur depuis 4 ans dans le domaine du transport de personnes. J'accompagne principalement des adultes en reconversion vers le m√©tier de conducteur de bus. Mon parcours de 15 ans comme conducteur puis chef d'√©quipe me permet d'apporter une exp√©rience terrain concr√®te √† mes formations.</p>
                </div>
                
                <div>
                    <p class="font-medium text-gray-800">Domaines de sp√©cialisation :</p>
                    <p>Conduite professionnelle, relation client, gestion du stress, s√©curit√© des passagers</p>
                </div>
            </div>
        </div>

        <!-- Une situation d'apprentissage -->
        <div class="mb-8">
            <h3 class="text-xl font-semibold text-gray-800 mb-4 border-b pb-2">üìö Situation de travail #1</h3>
            
            <div class="bg-gray-50 p-6 rounded-lg space-y-4">
                <div>
                    <p class="font-medium text-gray-800 mb-2">Titre de la situation :</p>
                    <p class="text-gray-700">Tensions dans un groupe h√©t√©rog√®ne lors d'une formation "Gestion des passagers difficiles"</p>
                </div>
                
                <div>
                    <p class="font-medium text-gray-800 mb-2">Date :</p>
                    <p class="text-gray-700">15 janvier 2026</p>
                </div>
                
                <div>
                    <p class="font-medium text-gray-800 mb-2">Contexte :</p>
                    <p class="text-gray-700">Formation de 2 jours pour un groupe de 10 conducteurs de bus. Groupe tr√®s h√©t√©rog√®ne : 4 nouveaux conducteurs en fin de formation initiale (peu d'exp√©rience terrain) + 6 conducteurs exp√©riment√©s (5-15 ans de m√©tier) envoy√©s en "recyclage" suite √† des incidents avec des passagers. Certains exp√©riment√©s sont venus √† reculons, consid√©rant qu'ils n'ont "rien √† apprendre".</p>
                </div>
                
                <div>
                    <p class="font-medium text-gray-800 mb-2">Description d√©taill√©e :</p>
                    <p class="text-gray-700">D√®s le premier exercice en sous-groupes, j'ai senti une tension. Les conducteurs exp√©riment√©s monopolisaient la parole et minimisaient les apports th√©oriques : "Sur le terrain, c'est pas comme √ßa". Un participant exp√©riment√©, Marc, a fait une remarque d√©sobligeante √† une nouvelle, Sonia, qui avait propos√© une technique de d√©sescalade : "Tu verras quand t'auras un gars bourr√© √† 23h, ta technique...". Sonia s'est referm√©e et n'a plus particip√© de la matin√©e.<br><br>J'ai d√ª intervenir pour recadrer sans braquer Marc (qui a de l'influence sur le groupe), tout en redonnant de l'espace √† Sonia et aux autres nouveaux.</p>
                </div>
                
                <div>
                    <p class="font-medium text-gray-800 mb-2">Comp√©tences mobilis√©es :</p>
                    <div class="flex flex-wrap gap-2 mt-2">
                        <span class="bg-purple-100 text-purple-700 px-3 py-1 rounded-full text-sm">F1 - Percevoir et comprendre les dynamiques de groupes</span>
                        <span class="bg-purple-100 text-purple-700 px-3 py-1 rounded-full text-sm">F3 - Intervenir dans les processus de groupes</span>
                        <span class="bg-purple-100 text-purple-700 px-3 py-1 rounded-full text-sm">I2 - Pr√©server l'int√©grit√© des participants</span>
                    </div>
                    <p class="text-sm text-gray-600 mt-2 italic">‚Üí J'ai identifi√© ces comp√©tences apr√®s avoir v√©cu la situation, en relisant le profil de qualification.</p>
                </div>
                
                <div class="bg-blue-50 p-4 rounded border-l-4 border-blue-400 mt-4">
                    <p class="font-medium text-gray-800 mb-2">üß™ Ce que j'ai test√© :</p>
                    <p class="text-gray-700 mb-3">Apr√®s la pause, j'ai restructur√© les sous-groupes en m√©langeant syst√©matiquement nouveaux et exp√©riment√©s, avec une consigne explicite : "Les exp√©riment√©s partagent UN cas v√©cu, les nouveaux posent des questions et proposent des alternatives. On cherche ensemble." J'ai aussi valoris√© explicitement l'apport des regards "neufs".</p>
                    
                    <p class="font-medium text-gray-800 mb-2">‚úÖ Ce qui a fonctionn√© :</p>
                    <p class="text-gray-700 mb-3">Marc s'est retrouv√© en bin√¥me avec Sonia pour un jeu de r√¥le. En jouant le passager difficile (son expertise), il a naturellement commenc√© √† coacher Sonia. L'apr√®s-midi, l'ambiance avait chang√© ‚Äî les exp√©riment√©s ont commenc√© √† dire "nous" en parlant du groupe.</p>
                    
                    <p class="font-medium text-gray-800 mb-2">‚ö†Ô∏è Ce qui a √©t√© difficile :</p>
                    <p class="text-gray-700 mb-3">Je n'avais pas anticip√© cette tension. Ma pr√©paration √©tait trop "neutre", je n'avais pas pens√© √† la dynamique nouveaux/exp√©riment√©s. J'ai d√ª improviser le remaniement des groupes.</p>
                    
                    <p class="font-medium text-gray-800 mb-2">üìù Ce que j'en apprends :</p>
                    <p class="text-gray-700 mb-3">L'h√©t√©rog√©n√©it√© d'exp√©rience est une richesse MAIS elle doit √™tre explicitement g√©r√©e d√®s le d√©part. Les r√©sistances des "envoy√©s en formation" sont souvent li√©es √† un sentiment de non-reconnaissance de leur expertise.</p>
                    
                    <p class="font-medium text-gray-800 mb-2">üéØ Prochaines √©tapes :</p>
                    <p class="text-gray-700">Pour ma prochaine formation avec un groupe mixte, je pr√©vois : un tour de table initial qui valorise l'exp√©rience de chacun, des r√¥les explicites dans les sous-groupes (expert terrain / regard neuf), une activit√© brise-glace qui met les exp√©riment√©s en position de transmettre.</p>
                </div>
                
                <div class="mt-4">
                    <p class="font-medium text-gray-800 mb-2">üìé Preuves envisag√©es :</p>
                    <ul class="list-disc list-inside text-gray-700 space-y-1 ml-4">
                        <li>Photo du tableau avec les productions des sous-groupes (apr√®s-midi)</li>
                        <li>Feedback anonyme de fin de formation (extraits pertinents)</li>
                        <li>Ma fiche de pr√©paration annot√©e avec les ajustements faits en direct</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Vue sur les comp√©tences -->
        <div class="mb-8">
            <h3 class="text-xl font-semibold text-gray-800 mb-4 border-b pb-2">üéØ Comp√©tences du domaine F (Dynamique de groupe)</h3>
            
            <div class="space-y-3">
                <div class="bg-gray-50 p-4 rounded">
                    <div class="flex justify-between items-center mb-2">
                        <span class="font-medium text-gray-800">F1 - Percevoir et comprendre les dynamiques de groupes</span>
                        <span class="text-sm text-purple-600 font-medium">Pratiqu√© 2 fois</span>
                    </div>
                    <div class="bg-gray-200 rounded-full h-2">
                        <div class="bg-purple-600 h-2 rounded-full" style="width: 50%"></div>
                    </div>
                    <p class="text-sm text-gray-600 mt-2">En d√©veloppement - Je d√©tecte les tensions mais j'ai besoin de les anticiper davantage</p>
                </div>
                
                <div class="bg-gray-50 p-4 rounded">
                    <div class="flex justify-between items-center mb-2">
                        <span class="font-medium text-gray-800">F3 - Intervenir dans les processus de groupes</span>
                        <span class="text-sm text-purple-600 font-medium">Pratiqu√© 2 fois</span>
                    </div>
                    <div class="bg-gray-200 rounded-full h-2">
                        <div class="bg-purple-600 h-2 rounded-full" style="width: 45%"></div>
                    </div>
                    <p class="text-sm text-gray-600 mt-2">En d√©veloppement - Mon intervention a fonctionn√© mais √©tait r√©active plut√¥t que proactive</p>
                </div>
                
                <div class="bg-gray-50 p-4 rounded">
                    <div class="flex justify-between items-center mb-2">
                        <span class="font-medium text-gray-800">I2 - Pr√©server l'int√©grit√© des participants</span>
                        <span class="text-sm text-purple-600 font-medium">Pratiqu√© 3 fois</span>
                    </div>
                    <div class="bg-gray-200 rounded-full h-2">
                        <div class="bg-purple-600 h-2 rounded-full" style="width: 65%"></div>
                    </div>
                    <p class="text-sm text-gray-600 mt-2">Comp√©tent - Je suis attentif √† ce que personne ne soit mis en difficult√© publiquement</p>
                </div>
            </div>
        </div>

        <!-- R√©flexions -->
        <div class="bg-yellow-50 border-l-4 border-yellow-400 p-6">
            <h4 class="font-semibold text-gray-800 mb-3">üí≠ R√©flexions en cours</h4>
            <div class="space-y-3 text-gray-700 text-sm">
                <p><strong>Question que je me pose :</strong> Comment mieux pr√©parer l'accueil des groupes h√©t√©rog√®nes, notamment quand certains participants sont "envoy√©s" et potentiellement r√©sistants ?</p>
                <p><strong>Piste √† explorer :</strong> Inclure syst√©matiquement un temps de "reconnaissance de l'expertise" en d√©but de formation pour les participants exp√©riment√©s.</p>
                <p><strong>Lien th√©orique √† approfondir :</strong> Revoir les mod√®les de Tuckman (forming, storming, norming, performing) pour mieux anticiper les phases de groupe.</p>
            </div>
        </div>
    </div>
</div>
<div id="overview" class="tab-content active">
            <h2>Vue d'ensemble de votre d√©veloppement professionnel</h2>
            
            <div class="alert alert-info">
                <h4>Bienvenue dans votre portfolio de d√©veloppement des comp√©tences</h4>
                <p>Ce portfolio est con√ßu pour vous accompagner tout au long de votre parcours vers le Brevet F√©d√©ral de Formateur/trice. Il vous permettra de documenter vos comp√©tences op√©rationnelles, de collecter des preuves de votre pratique professionnelle et de pr√©parer votre dossier de d√©veloppement des comp√©tences pour l'examen final.</p>
                <p><strong>Nouveau sur cet outil ?</strong> Consultez l'onglet "<strong>Guide d'utilisation</strong>" pour des instructions d√©taill√©es sur l'utilisation de ce portfolio.</p>
            </div>
            
            <div class="backup-reminder">
                <i>üíæ</i>
                <div>
                    <strong>Important :</strong> Vos donn√©es sont sauvegard√©es automatiquement sur cet appareil uniquement. Pour √©viter toute perte, exportez r√©guli√®rement votre portfolio. <a href="#" onclick="openExportModal()">Exporter maintenant</a>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Gestion des donn√©es</h3>
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="openExportModal()">Exporter</button>
                        <button class="btn btn-outline" onclick="document.getElementById('import-file').click()">Importer</button>
                        <input type="file" id="import-file" accept=".json" style="display: none;" onchange="importData(this.files[0])">
                        <button class="btn btn-outline" onclick="printPortfolio()">Imprimer</button>
                        <button class="btn btn-danger" onclick="resetPortfolio()" style="margin-left: 10px;">üóëÔ∏è R√©initialiser</button>
                    </div>
                </div>
                
                <p>Votre portfolio est automatiquement sauvegard√© sur cet appareil. Pour le conserver ou le transf√©rer:</p>
                <ul>
                    <li><strong>Exportation :</strong> T√©l√©chargez votre portfolio au format JSON (pour le sauvegarder) ou PDF (pour l'imprimer)</li>
                    <li><strong>Importation :</strong> Chargez un portfolio pr√©c√©demment export√© au format JSON</li>
                    <li><strong>Impression :</strong> Imprimez votre portfolio ou sauvegardez-le en PDF</li>
                </ul>
                
                <div class="alert alert-warning">
                    <p><strong>Attention :</strong> Vos donn√©es sont stock√©es uniquement sur cet appareil (stockage local du navigateur). En cas de nettoyage des donn√©es de navigation ou de changement d'appareil, vos informations pourraient √™tre perdues.</p>
                </div>
                
                <div id="save-status" class="save-status hidden"></div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Profil personnel</h3>
                    <div class="action-buttons">
                        <button class="btn btn-outline" onclick="saveProfile()">Enregistrer</button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="name">Nom complet:</label>
                    <input type="text" id="name" class="form-control" placeholder="Votre nom et pr√©nom complet">
                </div>
                
                <div class="form-group">
                    <label>Institution(s)/Entreprise(s):</label>
                    <div id="institutions-list" style="margin-bottom:0.5rem;"></div>
                    <div style="display:flex;gap:0.5rem;align-items:center;">
                        <input type="text" id="institution-input" class="form-control" placeholder="Ajouter un lieu de travail" style="flex:1;">
                        <button type="button" class="btn btn-success" onclick="addInstitution()" style="white-space:nowrap;padding:0.4rem 0.8rem;">+ Ajouter</button>
                    </div>
                    <small style="color:#666;">Vous pouvez ajouter plusieurs employeurs.</small>
                </div>
                
                <div class="form-group">
                    <label for="experience">Exp√©rience dans la formation d'adultes:</label>
                    <textarea id="experience" class="form-control" placeholder="D√©crivez bri√®vement votre parcours et votre exp√©rience dans la formation d'adultes"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="specialties">Domaines de sp√©cialisation:</label>
                    <textarea id="specialties" class="form-control" placeholder="Vos domaines d'expertise ou de sp√©cialisation en tant que formateur/trice"></textarea>
                </div>
            </div>
            
            <div class="progress-tracker">
                <h3>Progression globale</h3>
                <div class="progress-bar">
                    <div class="progress-fill" id="global-progress" style="width: 0%;"></div>
                </div>
                <div class="progress-stats">
                    <span>D√©butant</span>
                    <span>En progression</span>
                    <span>Avanc√©</span>
                    <span>Expert</span>
                </div>
                <p style="font-size: 0.9rem; color: #666; margin-top: 0.5rem;">La progression se calcule selon le nombre de comp√©tences document√©es.</p>
            </div>
            
            <h3>R√©sum√© des comp√©tences document√©es</h3>
            <div id="competences-overview" class="competence-selector">
                <!-- Les comp√©tences seront affich√©es ici dynamiquement -->
            </div>
            
            <h3>Preuves et justificatifs</h3>
            <div class="card" style="margin-bottom: 1.5rem;">
                <div class="card-header">
                    <span id="proofs-counter">0 preuve enregistr√©e</span>
                </div>
                <div id="proofs-summary" style="padding: 1rem;">
                    <p style="color: #666; font-style: italic;">Aucune preuve ajout√©e. Allez dans l'onglet "Preuves et justificatifs" pour en ajouter.</p>
                </div>
            </div>
            
            <div class="timeline" id="timeline-container">
                <h3>Chronologie de votre d√©veloppement</h3>
                
                <div class="alert alert-info" style="margin: 1rem 0;">
                    <p>Votre chronologie se construira automatiquement au fur et √† mesure que vous documentez vos situations de travail et vos comp√©tences.</p>
                    <p><strong>Commencez par :</strong> Aller dans l'onglet "Situations de travail" pour d√©crire une premi√®re exp√©rience !</p>
                </div>
            </div>
        </div>
        
        <!-- GUIDE D'UTILISATION -->
        <div id="help" class="tab-content">
            <h2>Guide d'utilisation d√©taill√© du portfolio</h2>
            
            <div class="alert alert-success">
                <h4>Pourquoi utiliser ce portfolio ?</h4>
                <p>Ce portfolio vous aidera √† documenter et √† r√©fl√©chir sur vos comp√©tences en tant que formateur/trice d'adultes. Il vous permettra de pr√©parer efficacement votre dossier de d√©veloppement des comp√©tences pour l'examen final du Brevet F√©d√©ral.</p>
            </div>
            
            <button class="accordion">1. Comment naviguer dans le portfolio</button>
            <div class="accordion-panel">
                <div class="help-step">
                    <h4>Navigation par onglets</h4>
                    <p>Le portfolio est organis√© en plusieurs onglets, accessibles en haut de la page :</p>
                    <ul>
                        <li><strong>Vue d'ensemble</strong> : r√©sum√© de votre progression et profil personnel</li>
                        <li><strong>Guide d'utilisation</strong> : instructions d√©taill√©es (vous √™tes ici)</li>
                        <li><strong>Comp√©tences op√©rationnelles</strong> : pour documenter les comp√©tences que vous souhaitez d√©velopper</li>
                        <li><strong>Situations de travail</strong> : pour d√©crire des situations concr√®tes o√π vous avez mobilis√© ces comp√©tences</li>
                        <li><strong>Preuves et justificatifs</strong> : pour collecter des preuves de votre pratique professionnelle</li>
                        <li><strong>R√©flexion et √©valuation</strong> : pour analyser et √©valuer votre niveau de ma√Ætrise</li>
                        <li><strong>Progr√®s et plans</strong> : pour suivre votre progression et planifier votre d√©veloppement</li>
                    </ul>
                    <p>Pour passer d'un onglet √† l'autre, cliquez simplement sur l'onglet souhait√©.</p>
                </div>
            </div>
            
            <button class="accordion">2. Sauvegarde de vos donn√©es</button>
            <div class="accordion-panel">
                <div class="help-step">
                    <h4>Comment vos donn√©es sont-elles sauvegard√©es?</h4>
                    <p>Ce portfolio utilise le stockage local (localStorage) de votre navigateur, ce qui signifie que:</p>
                    <ul>
                        <li>Vos donn√©es sont sauvegard√©es <strong>automatiquement</strong> sur l'appareil que vous utilisez actuellement</li>
                        <li>Les donn√©es restent disponibles m√™me apr√®s la fermeture du navigateur ou l'extinction de l'ordinateur</li>
                        <li>Vos informations restent <strong>priv√©es</strong> et ne sont pas transmises √† un serveur externe</li>
                        <li>Les donn√©es sont li√©es √† ce navigateur et √† cet appareil sp√©cifique - elles ne sont pas synchronis√©es automatiquement avec d'autres appareils</li>
                    </ul>
                    
                    <h4>Limites importantes √† conna√Ætre:</h4>
                    <ul>
                        <li>Si vous <strong>effacez les donn√©es de navigation</strong> ou les cookies, vos donn√©es seront perdues</li>
                        <li>Si vous <strong>changez d'appareil ou de navigateur</strong>, vous ne retrouverez pas vos donn√©es</li>
                        <li>Si vous utilisez une <strong>navigation priv√©e</strong>, les donn√©es ne seront pas conserv√©es apr√®s la fermeture de la fen√™tre</li>
                        <li>Le stockage local a une <strong>capacit√© limit√©e</strong> (g√©n√©ralement 5-10 Mo)</li>
                    </ul>
                    
                    <div class="alert alert-warning">
                        <p><strong>Important:</strong> Pour √©viter toute perte de donn√©es, exportez r√©guli√®rement votre portfolio au format JSON et conservez ce fichier en lieu s√ªr.</p>
                    </div>
                </div>
            </div>
            
            <button class="accordion">3. Comment exporter, importer et imprimer</button>
            <div class="accordion-panel">
                <div class="help-step">
                    <h4>Exportation de votre portfolio</h4>
                    <p>Pour sauvegarder ou partager votre portfolio:</p>
                    <ol>
                        <li>Cliquez sur l'onglet "Vue d'ensemble"</li>
                        <li>Dans la section "Gestion des donn√©es", cliquez sur le bouton "Exporter"</li>
                        <li>Choisissez l'un des formats suivants:
                            <ul>
                                <li><strong>JSON</strong> - Format le plus complet pour sauvegarder toutes vos donn√©es</li>
                                <li><strong>PDF</strong> - Format recommand√© pour l'impression ou le partage</li>
                            </ul>
                        </li>
                        <li>Enregistrez le fichier export√© sur votre ordinateur ou votre espace de stockage</li>
                    </ol>
                    <div class="note">
                        <p><strong>Conseil:</strong> Cr√©ez des sauvegardes r√©guli√®res (par exemple, une fois par mois) et apr√®s chaque ajout important de contenu.</p>
                    </div>
                    
                    <h4>Importation de votre portfolio</h4>
                    <p>Pour restaurer un portfolio pr√©c√©demment export√©:</p>
                    <ol>
                        <li>Cliquez sur l'onglet "Vue d'ensemble"</li>
                        <li>Dans la section "Gestion des donn√©es", cliquez sur le bouton "Importer"</li>
                        <li>S√©lectionnez le fichier JSON que vous avez pr√©c√©demment export√©</li>
                        <li>Confirmez l'importation lorsque demand√©</li>
                    </ol>
                    <div class="alert alert-warning">
                        <p><strong>Attention:</strong> L'importation remplacera toutes les donn√©es actuellement pr√©sentes dans votre portfolio. Exportez vos donn√©es actuelles avant d'importer si vous souhaitez les conserver.</p>
                    </div>
                    
                    <h4>üîÑ Mise √† jour vers une nouvelle version du portfolio</h4>
                    <p>Si vous recevez une nouvelle version du fichier portfolio (v10, v11, etc.), suivez cette proc√©dure pour conserver vos donn√©es :</p>
                    <ol>
                        <li><strong>Dans l'ancienne version :</strong> Exportez vos donn√©es (bouton "Exporter" ‚Üí JSON)</li>
                        <li><strong>Sauvegardez</strong> le fichier JSON export√© en lieu s√ªr</li>
                        <li><strong>Ouvrez la nouvelle version</strong> du portfolio dans votre navigateur</li>
                        <li><strong>Importez</strong> votre fichier JSON (bouton "Importer")</li>
                        <li>V√©rifiez que toutes vos donn√©es sont bien pr√©sentes</li>
                    </ol>
                    <div class="alert alert-info">
                        <p><strong>Pourquoi cette proc√©dure ?</strong> Le stockage local (localStorage) est li√© √† l'emplacement exact du fichier. Si le nom ou l'emplacement du fichier change, vos donn√©es ne seront pas automatiquement r√©cup√©r√©es. L'export/import garantit le transfert de toutes vos donn√©es.</p>
                    </div>
                    
                    <h4>Impression de votre portfolio</h4>
                    <p>Pour imprimer votre portfolio ou le sauvegarder en PDF:</p>
                    <ol>
                        <li>Cliquez sur l'onglet "Vue d'ensemble"</li>
                        <li>Dans la section "Gestion des donn√©es", cliquez sur le bouton "Imprimer"</li>
                        <li>Une mise en page optimis√©e pour l'impression s'affichera</li>
                        <li>Utilisez la fonction d'impression de votre navigateur (g√©n√©ralement Ctrl+P ou Cmd+P)</li>
                        <li>Pour cr√©er un PDF, s√©lectionnez "Enregistrer au format PDF" ou "Imprimer en PDF" dans les options d'impression</li>
                    </ol>
                </div>
            </div>
            
            <button class="accordion">4. üéØ NOUVELLE APPROCHE : Situation ‚Üí Comp√©tence (recommand√©)</button>
            <div class="accordion-panel">
                <div class="help-step">
                    <h4>La d√©marche MDA (Module de D√©veloppement d'Accompagnement)</h4>
                    <p>Cette version du portfolio privil√©gie une approche <strong>inductive</strong> : vous partez de votre pratique pour identifier les comp√©tences.</p>
                    
                    <div class="alert alert-success" style="margin: 1rem 0;">
                        <h4>Comment proc√©der ?</h4>
                        <ol>
                            <li><strong>Vivez une situation</strong> de formation (que vous avez anim√©e ou v√©cue)</li>
                            <li><strong>Allez dans l'onglet "Situations de travail"</strong></li>
                            <li><strong>D√©crivez la situation</strong> : contexte, ce qui s'est pass√©, les d√©fis rencontr√©s</li>
                            <li><strong>Identifiez les comp√©tences mobilis√©es</strong> en utilisant la recherche (tapez un mot-cl√© comme "groupe", "feedback", "√©galit√©")</li>
                            <li><strong>S√©lectionnez une ou plusieurs comp√©tences</strong> (Ctrl+clic pour en s√©lectionner plusieurs)</li>
                            <li><strong>Documentez vos exp√©rimentations</strong> : ce que vous avez test√©, ce qui a march√©, ce qui a √©t√© difficile</li>
                            <li><strong>Cliquez sur "Enregistrer"</strong></li>
                        </ol>
                    </div>
                    
                    <h4>Que se passe-t-il ensuite ?</h4>
                    <ul>
                        <li>Votre situation est sauvegard√©e</li>
                        <li>Les comp√©tences que vous avez s√©lectionn√©es sont <strong>automatiquement ajout√©es</strong> √† votre portfolio</li>
                        <li>Elles apparaissent dans la <strong>Vue d'ensemble</strong> et dans l'onglet <strong>Comp√©tences</strong></li>
                        <li>La <strong>chronologie</strong> se met √† jour avec votre nouvelle situation</li>
                    </ul>
                    
                    <div class="note">
                        <p><strong>Avantage :</strong> Cette approche refl√®te votre pratique r√©elle. Vous ne "cochez" pas des comp√©tences abstraites ‚Äî vous partez de situations v√©cues et analysez ensuite les comp√©tences en jeu.</p>
                    </div>
                </div>
            </div>
            
            <button class="accordion">5. Ajouter des comp√©tences manuellement (optionnel)</button>
            <div class="accordion-panel">
                <div class="help-step">
                    <h4>Ajouter une comp√©tence sans passer par une situation</h4>
                    <p>Si vous pr√©f√©rez l'approche traditionnelle (Comp√©tence ‚Üí Situation), vous pouvez aussi :</p>
                    <ol>
                        <li>Aller dans l'onglet "Comp√©tences op√©rationnelles"</li>
                        <li>S√©lectionner un domaine (A √† I) puis une comp√©tence</li>
                        <li>D√©crire son importance pour votre pratique</li>
                        <li>Enregistrer</li>
                    </ol>
                    <p>Cependant, <strong>l'approche recommand√©e</strong> reste de partir des situations v√©cues.</p>
                </div>
            </div>
            
            <button class="accordion">6. Utiliser le profil de qualification int√©gr√©</button>
            <div class="accordion-panel">
                <div class="help-step">
                    <h4>Profil de qualification int√©gr√©</h4>
                    <p>Cette version du portfolio int√®gre le profil de qualification officiel du Brevet F√©d√©ral de Formateur/trice d'Adultes :</p>
                    <ul>
                        <li>Tous les <strong>domaines de comp√©tences</strong> (A √† I) sont disponibles dans le menu d√©roulant</li>
                        <li>Chaque <strong>comp√©tence op√©rationnelle</strong> (A1, B2, C3, etc.) est associ√©e √† son domaine</li>
                        <li>Les <strong>crit√®res de performance</strong> officiels s'affichent automatiquement pour chaque comp√©tence</li>
                    </ul>
                    
                    <h4>Avantages de cette int√©gration :</h4>
                    <ul>
                        <li><strong>Gain de temps</strong> - plus besoin de recopier les comp√©tences et crit√®res</li>
                        <li><strong>Conformit√© garantie</strong> avec le r√©f√©rentiel officiel</li>
                        <li><strong>S√©lection facile</strong> des comp√©tences pertinentes pour votre pratique</li>
                        <li><strong>Documentation structur√©e</strong> selon les exigences du brevet f√©d√©ral</li>
                    </ul>
                    
                    <div class="note">
                        <p><strong>Astuce :</strong> Vous pouvez s√©lectionner ou d√©s√©lectionner certains crit√®res de performance pour vous concentrer sur ceux qui sont les plus pertinents pour votre pratique professionnelle.</p>
                    </div>
                </div>
            </div>
            
            <div class="alert alert-info" style="margin-top: 30px;">
                <h4>Besoin d'aide suppl√©mentaire ?</h4>
                <p>Si vous rencontrez des difficult√©s avec l'utilisation de ce portfolio, n'h√©sitez pas √† contacter votre formateur/trice ou √† poser vos questions lors des sessions de formation.</p>
            </div>
        </div>
        
        <!-- COMP√âTENCES OP√âRATIONNELLES -->
        <div id="competences" class="tab-content">
            <h2>Comp√©tences op√©rationnelles</h2>
            
            <div class="alert alert-info">
                <h4>üí° Comment √ßa fonctionne ?</h4>
                <p>Les comp√©tences s'ajoutent <strong>automatiquement</strong> lorsque vous documentez des situations de travail dans l'onglet "Situations". Vous pouvez aussi en ajouter manuellement ci-dessous si vous le souhaitez.</p>
                <p>Pour l'examen final du Brevet F√©d√©ral, vous devrez pr√©senter 3 comp√©tences op√©rationnelles avec des situations concr√®tes.</p>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Ajouter une nouvelle comp√©tence op√©rationnelle</h3>
                </div>
                
                <div class="alert alert-info">
                    <p>S√©lectionnez une comp√©tence dans le profil de qualification du Brevet F√©d√©ral de Formateur/trice d'Adultes. Les crit√®res de performance associ√©s s'afficheront automatiquement.</p>
                </div>
                
                <div class="form-group">
                    <label for="domain-select">Domaine de comp√©tence:</label>
                    <select id="domain-select" class="form-control" onchange="loadCompetences(this.value)">
                        <option value="">S√©lectionnez un domaine de comp√©tence</option>
                        <!-- Options des domaines A √† I ajout√©es dynamiquement -->
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="competence-select">Comp√©tence op√©rationnelle:</label>
                    <select id="competence-select" class="form-control" onchange="loadCriteres(this.value)" disabled>
                        <option value="">S√©lectionnez d'abord un domaine</option>
                        <!-- Options des comp√©tences ajout√©es dynamiquement -->
                    </select>
                </div>
                
                <div id="competence-details" class="hidden">
                    <div class="form-group">
                        <label for="competence-description">Description de la comp√©tence:</label>
                        <textarea id="competence-description" class="form-control" readonly></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Crit√®res de performance associ√©s:</label>
                        <div id="criteres-container">
                            <!-- Crit√®res de performance ajout√©s dynamiquement -->
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="competence-importance">Importance dans votre pratique:</label>
                        <textarea id="competence-importance" class="form-control" placeholder="Pourquoi cette comp√©tence est-elle importante dans votre pratique professionnelle?"></textarea>
                    </div>
                    
                    <button class="btn btn-success" onclick="saveCompetence()">Enregistrer cette comp√©tence</button>
                </div>
            </div>
            
            <h3>Mes comp√©tences document√©es</h3>
            <div id="competences-list">
                <!-- Les comp√©tences enregistr√©es seront affich√©es ici -->
            </div>
        </div>
        
        <!-- SITUATIONS DE TRAVAIL -->
        <div id="situations" class="tab-content">
            <h2>Situations de travail</h2>
            
            <div class="alert alert-success">
                <h4>üéØ Nouvelle approche : Situation ‚Üí Comp√©tence</h4>
                <p><strong>Commencez ici !</strong> D√©crivez une situation que vous avez v√©cue, puis identifiez les comp√©tences que vous avez mobilis√©es. Les comp√©tences s√©lectionn√©es seront automatiquement ajout√©es √† votre portfolio.</p>
                <p><em>Cette approche refl√®te votre pratique r√©elle : vous vivez d'abord une situation, puis vous analysez les comp√©tences en jeu.</em></p>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Ajouter une nouvelle situation de travail</h3>
                </div>
                
                <div class="form-group">
                    <label for="situation-title">Titre de la situation:</label>
                    <input type="text" id="situation-title" class="form-control" placeholder="Ex: Animation d'une formation sur...">
                </div>
                
                <div class="form-group">
                    <label for="competence-search">üîç Rechercher une comp√©tence (tapez un mot-cl√©):</label>
                    <input type="text" id="competence-search" class="form-control" placeholder="Ex: groupe, √©galit√©, feedback, dynamique, intervention..." oninput="filterCompetences(this.value)">
                    <small style="color: #666;">Tapez pour filtrer les comp√©tences, puis s√©lectionnez dans la liste ci-dessous</small>
                </div>
                
                <div class="form-group">
                    <label for="competence-linked">Comp√©tence(s) op√©rationnelle(s) mobilis√©e(s):</label>
                    <select id="competence-linked" class="form-control" multiple size="8" style="height: auto; min-height: 200px;">
                        <!-- Toutes les comp√©tences du r√©f√©rentiel BFFA -->
                    </select>
                    <small style="color: #666;">üí° Maintenez Ctrl (ou Cmd sur Mac) pour s√©lectionner plusieurs comp√©tences. Une situation peut mobiliser plusieurs comp√©tences !</small>
                </div>
                
                <div class="form-group">
                    <label for="situation-date">Date de la situation:</label>
                    <input type="date" id="situation-date" class="form-control">
                </div>
                
                <div class="form-group">
                    <label for="situation-context">Contexte de la situation:</label>
                    <textarea id="situation-context" class="form-control" placeholder="D√©crivez le contexte: public, lieu, dur√©e, cadre institutionnel..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="situation-description">Description d√©taill√©e de la situation:</label>
                    <textarea id="situation-description" class="form-control" placeholder="D√©crivez la situation de travail en d√©tail: ce qui s'est pass√©, vos actions, les d√©fis rencontr√©s..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="competence-relevance">Pertinence pour la comp√©tence choisie:</label>
                    <textarea id="competence-relevance" class="form-control" placeholder="Expliquez en quoi cette situation illustre la comp√©tence op√©rationnelle choisie"></textarea>
                </div>
                <!-- Section Exp√©rimentations -->
<div class="form-group" style="border-left: 4px solid #E6E6FA; padding-left: 1rem; background-color: #F9F9FF;">
    <h4 style="color: #6B46C1; margin-bottom: 1rem; display: flex; align-items: center;">
        üß™ Exp√©rimentations
        <span style="font-size: 0.875rem; font-weight: normal; color: #666; margin-left: 0.5rem;">(Facultatif)</span>
    </h4>
    
    <div class="form-group">
        <label for="experimentation-tested">Ce que j'ai test√©:</label>
        <small style="display: block; color: #666; margin-bottom: 0.5rem;">
            Ex: J'ai essay√© de poser des questions ouvertes pour favoriser l'√©change...
        </small>
        <textarea id="experimentation-tested" class="form-control" rows="3"></textarea>
    </div>
    
    <div class="form-group">
        <label for="experimentation-positive">Ce qui s'est pass√© (positif):</label>
        <small style="display: block; color: #666; margin-bottom: 0.5rem;">
            Ex: Les participants ont davantage pris la parole, ambiance plus vivante...
        </small>
        <textarea id="experimentation-positive" class="form-control" rows="3"></textarea>
    </div>
    
    <div class="form-group">
        <label for="experimentation-difficult">Ce qui a √©t√© difficile:</label>
        <small style="display: block; color: #666; margin-bottom: 0.5rem;">
            Ex: G√©rer le temps, certains monopolisaient la parole...
        </small>
        <textarea id="experimentation-difficult" class="form-control" rows="3"></textarea>
    </div>
    
    <div class="form-group">
        <label for="experimentation-learning">Ce que j'en apprends:</label>
        <small style="display: block; color: #666; margin-bottom: 0.5rem;">
            Ex: Je vois que je dois travailler sur la gestion du temps de parole √©quitable...
        </small>
        <textarea id="experimentation-learning" class="form-control" rows="3"></textarea>
    </div>
    
    <div class="form-group">
        <label for="experimentation-next">Prochaines √©tapes:</label>
        <small style="display: block; color: #666; margin-bottom: 0.5rem;">
            Ex: Tester un tour de table structur√© pour √©quilibrer les prises de parole...
        </small>
        <textarea id="experimentation-next" class="form-control" rows="3"></textarea>
    </div>
</div>
                <button class="btn btn-success" onclick="saveSituation()">Enregistrer cette situation</button>
            </div>
            
            <h3>Mes situations de travail document√©es</h3>
            <div id="situations-list">
                <!-- Les situations de travail seront affich√©es ici -->
            </div>
        </div>
        
        <!-- PREUVES ET JUSTIFICATIFS -->
        <div id="evidence" class="tab-content">
            <h2>Preuves et Justificatifs</h2>
            
            <div class="alert alert-info">
                <p>Cette section vous permet de collecter et d'organiser les preuves et justificatifs qui d√©montrent votre ma√Ætrise des comp√©tences op√©rationnelles. Pour l'examen final, vous devrez fournir au moins un exemple concret par comp√©tence.</p>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Ajouter une nouvelle preuve</h3>
                </div>
                
                <div class="form-group">
                    <label for="proof-title">Titre du document/preuve:</label>
                    <input type="text" id="proof-title" class="form-control" placeholder="Ex: Plan de formation, √âvaluation des participants...">
                </div>
                
                <div class="form-group">
                    <label for="proof-type">Type de document:</label>
                    <select id="proof-type" class="form-control">
                        <option value="">S√©lectionner un type</option>
                        <option value="plan">Plan/Conception de formation</option>
                        <option value="material">Mat√©riel p√©dagogique</option>
                        <option value="evaluation">√âvaluation/Feedback</option>
                        <option value="photo">Document photographique</option>
                        <option value="video">Enregistrement vid√©o</option>
                        <option value="certificate">Attestation/Certificat</option>
                        <option value="other">Autre</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="proof-situation">Situation de travail li√©e:</label>
                    <select id="proof-situation" class="form-control">
                        <option value="">S√©lectionner une situation</option>
                        <!-- Ajout√© dynamiquement en fonction des situations enregistr√©es -->
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="proof-file-reference">R√©f√©rence du fichier:</label>
                    <input type="text" id="proof-file-reference" class="form-control" placeholder="Ex: Plan_formation_J1.pdf (dans dossier MDA/Preuves)">
                    <small style="color: #666;">üìÅ Indiquez le nom et l'emplacement de votre fichier sur votre ordinateur ou cloud</small>
                </div>
                
                <div class="form-group">
                    <label for="proof-description">Description et importance de cette preuve:</label>
                    <textarea id="proof-description" class="form-control" placeholder="D√©crivez ce document et expliquez en quoi il d√©montre votre ma√Ætrise de la comp√©tence op√©rationnelle"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="proof-theory">Lien avec des mod√®les ou th√©ories:</label>
                    <textarea id="proof-theory" class="form-control" placeholder="√âtablissez un lien entre cette preuve et des mod√®les/th√©ories/concepts p√©dagogiques"></textarea>
                </div>
                
                <button class="btn btn-success" onclick="saveProof()">Enregistrer cette preuve</button>
            </div>
            
            <h3>Mes preuves et justificatifs</h3>
            <div id="proofs-list">
                <!-- Les preuves seront affich√©es ici -->
            </div>
        </div>
        
        <!-- R√âFLEXION ET √âVALUATION -->
        <div id="reflection" class="tab-content">
            <h2>R√©flexion et √âvaluation</h2>
            
            <div class="alert alert-info">
                <h4>üí≠ R√©fl√©chir sur vos comp√©tences document√©es</h4>
                <p>Cette section vous aide √† analyser vos pratiques et √©valuer votre niveau de ma√Ætrise.</p>
                <p><strong>Note :</strong> Seules les comp√©tences que vous avez d√©j√† document√©es via des situations de travail apparaissent ici. La r√©flexion part de l'exp√©rience v√©cue !</p>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Ajouter une nouvelle r√©flexion</h3>
                </div>
                
                <div class="form-group">
                    <label for="reflection-competence">Comp√©tence concern√©e:</label>
                    <select id="reflection-competence" class="form-control">
                        <option value="">S√©lectionner une comp√©tence document√©e</option>
                        <!-- Ajout√© dynamiquement en fonction des comp√©tences enregistr√©es -->
                    </select>
                </div>
                
                <div class="form-group">
                    <label>√âvaluation de votre niveau actuel:</label>
                    <div class="rating-scale">
                        <div class="rating-item" onclick="selectRating(this, 1)">
                            <div class="rating-circle">1</div>
                            <div class="rating-label">Novice</div>
                        </div>
                        <div class="rating-item" onclick="selectRating(this, 2)">
                            <div class="rating-circle">2</div>
                            <div class="rating-label">D√©butant</div>
                        </div>
                        <div class="rating-item" onclick="selectRating(this, 3)">
                            <div class="rating-circle">3</div>
                            <div class="rating-label">Comp√©tent</div>
                        </div>
                        <div class="rating-item" onclick="selectRating(this, 4)">
                            <div class="rating-circle">4</div>
                            <div class="rating-label">Avanc√©</div>
                        </div>
                        <div class="rating-item" onclick="selectRating(this, 5)">
                            <div class="rating-circle">5</div>
                            <div class="rating-label">Expert</div>
                        </div>
                    </div>
                </div>
                
                <div id="reflection-criteria" class="hidden">
                    <h4>Analyse par crit√®res de performance</h4>
                    <div id="criteria-evaluation-container">
                        <!-- G√©n√©r√© dynamiquement en fonction de la comp√©tence s√©lectionn√©e -->
                    </div>
                </div>
                
                <div class="reflection-prompts">
                    <h4>Questions de r√©flexion</h4>
                    
                    <div class="reflection-prompt">
                        <p>Comment votre conception de cette comp√©tence a-t-elle √©volu√© au cours de votre parcours professionnel?</p>
                    </div>
                    
                    <div class="form-group">
                        <textarea id="reflection-evolution" class="form-control" rows="5" placeholder="D√©crivez l'√©volution de votre conception de cette comp√©tence..."></textarea>
                    </div>
                    
                    <div class="reflection-prompt">
                        <p>Quelles situations vous ont permis de d√©velopper significativement cette comp√©tence?</p>
                    </div>
                    
                    <div class="form-group">
                        <textarea id="reflection-situations" class="form-control" rows="5" placeholder="D√©crivez les situations qui vous ont permis de d√©velopper cette comp√©tence..."></textarea>
                    </div>
                    
                    <div class="reflection-prompt">
                        <p>Comment cette comp√©tence s'articule-t-elle avec d'autres comp√©tences du profil de qualification?</p>
                    </div>
                    
                    <div class="form-group">
                        <textarea id="reflection-articulation" class="form-control" rows="5" placeholder="D√©crivez les liens entre cette comp√©tence et d'autres comp√©tences..."></textarea>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="reflection-theory">Mod√®le th√©orique li√© √† cette comp√©tence:</label>
                    <textarea id="reflection-theory" class="form-control" rows="5" placeholder="D√©crivez un mod√®le ou une th√©orie qui √©claire votre compr√©hension de cette comp√©tence..."></textarea>
                </div>
                
                <button class="btn btn-success" onclick="saveReflection()">Enregistrer cette r√©flexion</button>
            </div>
            
            <h3>Mes r√©flexions document√©es</h3>
            <div id="reflections-list">
                <!-- Les r√©flexions seront affich√©es ici -->
            </div>
        </div>
        
        <!-- PROGR√àS ET PLANS -->
        <div id="progress" class="tab-content">
            <h2>Progr√®s et Plans de d√©veloppement</h2>
            
            <div class="alert alert-info">
                <h4>üéØ Planifier votre d√©veloppement</h4>
                <p>Cette section vous permet de suivre votre progression et de planifier votre d√©veloppement professionnel futur.</p>
                <p><strong>Note :</strong> Toutes les comp√©tences du r√©f√©rentiel BFFA sont disponibles ici ‚Äî vous pouvez vous fixer des objectifs sur des comp√©tences que vous n'avez pas encore pratiqu√©es !</p>
            </div>
            
            <div class="progress-tracker">
                <h3>Progression par comp√©tence</h3>
                <div id="competences-progress">
                    <!-- G√©n√©r√© dynamiquement en fonction des comp√©tences et r√©flexions -->
                </div>
            </div>
            
            <div class="development-goals">
                <h3>Objectifs de d√©veloppement</h3>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Ajouter un nouvel objectif</h3>
                    </div>
                    
                    <div class="form-group">
                        <label for="goal-title">Titre de l'objectif:</label>
                        <input type="text" id="goal-title" class="form-control" placeholder="Ex: Approfondir mes comp√©tences en...">
                    </div>
                    
                    <div class="form-group">
                        <label for="goal-competence">Comp√©tence concern√©e:</label>
                        <select id="goal-competence" class="form-control">
                            <option value="">S√©lectionner une comp√©tence</option>
                            <!-- Ajout√© dynamiquement en fonction des comp√©tences enregistr√©es -->
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="goal-description">Description d√©taill√©e:</label>
                        <textarea id="goal-description" class="form-control" placeholder="D√©crivez pr√©cis√©ment ce que vous souhaitez d√©velopper"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="goal-actions">Actions √† entreprendre:</label>
                        <textarea id="goal-actions" class="form-control" placeholder="Quelles actions concr√®tes allez-vous mettre en place?"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="goal-deadline">√âch√©ance:</label>
                        <input type="date" id="goal-deadline" class="form-control">
                    </div>
                    
                    <button class="btn btn-success" onclick="saveGoal()">Enregistrer cet objectif</button>
                </div>
                
                <div id="goals-list">
                    <!-- Les objectifs seront affich√©s ici -->
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Pr√©parer mon dossier pour l'examen final</h3>
                </div>
                
                <div class="alert alert-warning">
                    <h4>Rappel des exigences pour l'examen final</h4>
                    <p>Pour l'examen final du Brevet f√©d√©ral, vous devrez:</p>
                    <ul>
                        <li>S√©lectionner 3 comp√©tences op√©rationnelles parmi les 4 propos√©es</li>
                        <li>Documenter une situation de travail concr√®te pour chaque comp√©tence</li>
                        <li>Fournir au moins un exemple/preuve par comp√©tence</li>
                        <li>Pr√©senter une r√©flexion approfondie sur votre pratique</li>
                        <li>√âtablir des liens avec des mod√®les et concepts th√©oriques</li>
                    </ul>
                </div>
                
                <h4>√âtat de pr√©paration actuel</h4>
                <div id="exam-preparation">
                    <!-- G√©n√©r√© dynamiquement en fonction du contenu du portfolio -->
                </div>
                
                <div class="btn-group">
                    <button class="btn btn-warning" onclick="generateDossierPreview()">G√©n√©rer un aper√ßu du dossier final</button>
                    <button class="btn btn-outline" onclick="printPortfolio()">Imprimer le dossier</button>
                </div>
            </div>
        </div>
        
        <!-- Modal d'exportation -->
        <div id="export-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Exporter votre portfolio</h3>
                    <span class="close-modal" onclick="closeExportModal()">&times;</span>
                </div>
                
                <p>Choisissez le format d'exportation souhait√©:</p>
                
                <div class="export-options">
                    <div class="export-option" onclick="exportJSON()">
                        <i>üìÑ</i>
                        <h4>JSON</h4>
                        <p>Format complet pour sauvegarder toutes vos donn√©es</p>
                        <small>Recommand√© pour les sauvegardes r√©guli√®res</small>
                    </div>
                    
                    <div class="export-option" onclick="printPortfolio()">
                        <i>üìë</i>
                        <h4>PDF</h4>
                        <p>Format optimis√© pour l'impression et le partage</p>
                        <small>Id√©al pour l'examen final</small>
                    </div>
                </div>
                
                <div class="alert alert-info" style="margin-top: 20px;">
                    <p><strong>Conseil :</strong> Cr√©ez des sauvegardes r√©guli√®res au format JSON et conservez-les en lieu s√ªr. Utilisez le format PDF pour partager votre travail ou pour l'impression.</p>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Portfolio de D√©veloppement des Comp√©tences - Brevet F√©d√©ral de Formateur/trice d'Adultes ¬© 2025 | Cr√©√© par Dao Mercier</p>
        </footer>
    </div>
    
    <script>
        // Structure JSON du profil de qualification
        const qualificationProfile = {
            "domaines": [
                {
                    "id": "A",
                    "titre": "Planifier des activit√©s de formation et d'apprentissage",
                    "description": "Les formateurs sont conscients de la n√©cessit√© de planifier soigneusement les diff√©rentes activit√©s d'enseignement et d'apprentissage.",
                    "competences": [
                        {
                            "id": "A1",
                            "titre": "Planifier sommairement une session d'enseignement/d'apprentissage ou d'un encadrement de formation en tenant compte des directives institutionnelles et du curriculum",
                            "criteres_performance": [
                                "analyse les conditions g√©n√©rales prescrites ainsi que les destinataires.",
                                "saisit les caract√©ristiques et les potentiels de groupes d'apprentissage sp√©cifiques ou de certains participants.",
                                "identifie, d√©crit et repr√©sente les situations importantes.",
                                "√©tablit une analyse de la mati√®re et la r√©duit ou l'ajuste de mani√®re compr√©hensible."
                            ]
                        },
                        {
                            "id": "A2",
                            "titre": "Construire et documenter, sous forme de planification d√©taill√©e ax√©e sur les processus d'apprentissage, les contenus et la forme de l'enseignement et de l'apprentissage",
                            "criteres_performance": [
                                "√©tablit, en utilisant un mod√®le de processus d'apprentissage, une planification du d√©roulement logique et claire, d√©taill√©e dans une mesure judicieuse.",
                                "tient compte des ressources des participants dans le d√©veloppement des comp√©tences.",
                                "√©tablit activement des liens avec la r√©alit√© et la situation des participants.",
                                "planifie les activit√©s d'enseignement/d'apprentissage relevant de l'environnement, du groupe, du th√®me et de ses propres ressources."
                            ]
                        },
                        {
                            "id": "A3",
                            "titre": "Formuler des objectifs d'apprentissage op√©rationnalis√©s selon les comp√©tences prescrites",
                            "criteres_performance": [
                                "formule les objectifs d'apprentissage de mani√®re r√©aliste et adapt√©e aux prescriptions, aux exigences de la situation de r√©f√©rence et du groupe d'apprentissage, de mani√®re √† ce qu'ils puissent √™tre v√©rifi√©s.",
                                "avec les participants, atteint dans l'ensemble les objectifs d'apprentissage par le d√©veloppement souhait√© des comp√©tences et des ressources."
                            ]
                        },
                        {
                            "id": "A4",
                            "titre": "Planifier l'utilisation des m√©dias d'enseignement et d'apprentissage",
                            "criteres_performance": [
                                "s√©lectionne et planifie le m√©dium ad√©quat sur la base de l'√©tape du processus d'apprentissage, du d√©veloppement des comp√©tences et du contenu",
                                "s√©lectionne et planifie de mani√®re judicieuse les m√©dias num√©riques en lien avec le besoin de formation, le mandat de l'institution et les besoins des participants.",
                                "identifie les potentiels TIC gr√¢ce √† une utilisation bas√©e sur la technologie"
                            ]
                        },
                        {
                            "id": "A5",
                            "titre": "D√©velopper des t√¢ches d'apprentissage ax√©es sur les comp√©tences et les objectifs",
                            "criteres_performance": [
                                "proc√®de √† un choix cibl√© des t√¢ches d'apprentissage, des mandats et des documents d'apprentissage, selon le degr√© de comp√©tence des participants, ou cr√©ation et mise √† disposition de ses propres versions",
                                "d√©finit les t√¢ches d'apprentissage en lien avec le monde du travail et la vie quotidienne.",
                                "situe clairement les t√¢ches d'apprentissage dans le processus d'apprentissage.",
                                "propose un potentiel suffisant en mati√®re de diff√©renciation interne.",
                                "les t√¢ches d'apprentissage sont d√©velopp√©es de mani√®re √† ce que leur forme et leur fonction soient correctes."
                            ]
                        },
                        {
                            "id": "A6",
                            "titre": "Planifier le transfert avec des conceptions et des m√©thodes ad√©quates",
                            "criteres_performance": [
                                "planifie le transfert avant, pendant et apr√®s la session d'apprentissage.",
                                "tient compte du transfert √† titre de principe subordonn√©.",
                                "planifie et contr√¥le un transfert direct et proche."
                            ]
                        },
                        {
                            "id": "A7",
                            "titre": "Planifier des proc√©dures d'examen valides",
                            "criteres_performance": [
                                "int√®gre les mesures d'√©valuation de mani√®re organique √† la planification didactique.",
                                "choisit des instruments d'√©valuation appropri√©s compte tenu des contenus, des comp√©tences, des objectifs d'apprentissage et des participants.",
                                "√©labore des crit√®res, des indicateurs et des proc√©d√©s de mesure pour √©valuer les prestations d'apprentissage.",
                                "formule des t√¢ches de contr√¥le valides, ax√©es sur les comp√©tences et adapt√©es au niveau trait√©."
                            ]
                        },
                        {
                            "id": "A8",
                            "titre": "Planifier des formes de communication bas√©es sur les technologies pour soutenir l'apprentissage",
                            "criteres_performance": [
                                "√©value les chances et les limites des formes de communication bas√©es sur la technologie.",
                                "planifie consciemment et de mani√®re cibl√©e l'√©change social et la collaboration au sein des environnements d'apprentissage num√©riques."
                            ]
                        },
                        {
                            "id": "A9",
                            "titre": "Planifier des contextes d'apprentissage de type ¬´ blended learning ¬ª",
                            "criteres_performance": [
                                "planifie et met en ≈ìuvre des formats de blended learning en tenant compte de l'infrastructure, des r√©formes didactiques, du d√©veloppement du personnel et de l'organisation et des m√©dias.",
                                "√©tend les environnements d'apprentissage au moyen d'outils num√©riques ad√©quats et les int√®gre aux processus d'apprentissage."
                            ]
                        },
                        {
                            "id": "A10",
                            "titre": "Adapter et utiliser des m√©dias simples, bas√©s sur la technologie, √† diff√©rents processus d'apprentissage",
                            "criteres_performance": [
                                "utilise les techniques de base du traitement num√©rique au moyen de programmes largement r√©pandus et d'outils destin√©s aux auteurs.",
                                "soutient les participants de fa√ßon cibl√©e dans l'utilisation des m√©dias num√©riques et con√ßoit des environnements d'apprentissage num√©riques."
                            ]
                        },
                        {
                            "id": "A11",
                            "titre": "Int√©grer la r√©flexion relative √† la didactique professionnelle dans la planification des sessions d'apprentissage",
                            "criteres_performance": [
                                "tient compte des directives dans leur propre branche.",
                                "int√®gre les situations et activit√©s professionnelles de r√©f√©rence.",
                                "d√©veloppe des environnements d'enseignement et d'apprentissage sp√©cifiques au champ professionnel."
                            ]
                        }
                    ]
                },
                {
                    "id": "B",
                    "titre": "Mener des activit√©s de formation et d'apprentissage",
                    "description": "Les formateurs conduisent les activit√©s de formation planifi√©es en tenant compte des conditions de travail et des ressources disponibles.",
                    "competences": [
                        {
                            "id": "B1",
                            "titre": "Utiliser diff√©rentes formes d'enseignement et d'apprentissage dans le cadre d'un processus d'apprentissage et en fonction des objectifs fix√©s",
                            "criteres_performance": [
                                "utilise efficacement et de fa√ßon cibl√©e les formes d'enseignement et d'apprentissage pr√©vues.",
                                "suit un mod√®le de processus d'apprentissage et utilise les m√©thodes correctement d'un point de vue professionnel.",
                                "utilise des m√©thodes participatives, qui motivent et encouragent l'apprentissage."
                            ]
                        },
                        {
                            "id": "B2",
                            "titre": "Guider les processus de travail et les √©tapes d'apprentissage",
                            "criteres_performance": [
                                "met en ≈ìuvre un mod√®le d'instruction ad√©quat.",
                                "pose des questions ax√©es sur le d√©veloppement.",
                                "permet l'exploration par les participants.",
                                "incite les participants √† mener une r√©flexion."
                            ]
                        },
                        {
                            "id": "B3",
                            "titre": "Utiliser les m√©dias bas√©s sur la technologie durant le processus d'enseignement/d'apprentissage",
                            "criteres_performance": [
                                "s√©lectionne et/ou cr√©e du mat√©riel d'enseignement analogue ou num√©rique.",
                                "utilise des m√©dias d'enseignement et d'apprentissage vari√©s de mani√®re ax√©e sur les objectifs.",
                                "se sert correctement des applications, auxiliaires et appareils."
                            ]
                        },
                        {
                            "id": "B4",
                            "titre": "Mettre en ≈ìuvre la planification d√©taill√©e en fonction des circonstances et des processus",
                            "criteres_performance": [
                                "observe ce qui se produit dans les sessions d'enseignement/d'apprentissage de mani√®re attentive, per√ßoit les divergences par rapport √† la planification et proc√®de imm√©diatement √† des adaptations du d√©roulement et des formes de travail social.",
                                "atteint des comp√©tences et objectifs d'apprentissage essentiels de la planification d√©taill√©e avec les participants."
                            ]
                        },
                        {
                            "id": "B5",
                            "titre": "Assurer les r√©sultats d'apprentissage dans le processus d'apprentissage, individuellement et collectivement",
                            "criteres_performance": [
                                "assure ou fait assurer les r√©sultats concernant le produit et le processus.",
                                "met en r√©seau et visualise les r√©sultats de l'enseignement et de l'apprentissage."
                            ]
                        },
                        {
                            "id": "B6",
                            "titre": "√âvaluer les performances et le comportement d'apprentissage",
                            "criteres_performance": [
                                "compose les situations d'√©valuation de la forme de mani√®re ad√©quate.",
                                "organise et r√©alise les formes d'examen sommatives de mani√®re compl√®te.",
                                "√©value les prestations √† l'examen sur la base des crit√®res pr√©vus et repr√©sente les r√©sultats correspondants de mani√®re adapt√©e.",
                                "donne aux participants des retours individuels utiles."
                            ]
                        },
                        {
                            "id": "B7",
                            "titre": "Utiliser les m√©thodes et proc√©d√©s ad√©quats pour le transfert et la v√©rification des r√©sultats de l'apprentissage",
                            "criteres_performance": [
                                "utilise des m√©thodes et des t√¢ches ad√©quates pour le transfert d'apprentissage.",
                                "assure le transfert de l'apprentissage gr√¢ce √† des t√¢ches concr√®tes.",
                                "permet aux participants de r√©fl√©chir aux r√©sultats du transfert."
                            ]
                        },
                        {
                            "id": "B8",
                            "titre": "Concevoir des activit√©s d'apprentissage et d'interaction sociale pour favoriser l'apprentissage",
                            "criteres_performance": [
                                "formule des mandats qui d√©crivent de mani√®re claire la situation, la t√¢che d√©taill√©e, l'organisation et l'√©valuation.",
                                "maximise le temps √† disposition pour l'apprentissage actif et minimise les activit√©s qui n'ont pas d'influence sur l'apprentissage.",
                                "permet l'apprentissage entre les participants."
                            ]
                        },
                        {
                            "id": "B9",
                            "titre": "R√©aliser m√©thodiquement la diff√©renciation au sein de groupes h√©t√©rog√®nes",
                            "criteres_performance": [
                                "tient compte de l'h√©t√©rog√©n√©it√© dans la formation des groupes.",
                                "permet des trajectoires d'apprentissage individuelles."
                            ]
                        },
                        {
                            "id": "B10",
                            "titre": "Utiliser des m√©thodes orient√©es pratiques dans des situations d'enseignement/d'apprentissage complexes",
                            "criteres_performance": [
                                "analyse et √©value les formes √©largies d'enseignement et d'apprentissage au regard des caract√©ristiques qualitatives de l'orientation vers l'action.",
                                "utilise des concepts didactiques orient√©s vers l'action pour ses propres sessions d'enseignement et d'apprentissage.",
                                "utilise des m√©thodes orient√©es vers l'action en tenant compte des domaines fonctionnels des participants."
                            ]
                        }
                    ]
                },
                {
                    "id": "C",
                    "titre": "√âvaluer les activit√©s de formation et d'apprentissage",
                    "description": "Dans leur travail, les formateurs se mettent r√©guli√®rement en qu√™te du feedback des participants et d√©veloppent continuellement leur propre activit√© d'enseignement.",
                    "competences": [
                        {
                            "id": "C1",
                            "titre": "R√©aliser des feedbacks complets en exploitant des moyens p√©dagogiques appropri√©s",
                            "criteres_performance": [
                                "accepte, dans une approche constructive, les retours de diff√©rentes formes d'√©valuation, les interpr√®te et les int√®gre √† sa propre pratique ainsi qu'au processus de d√©veloppement et d'apprentissage personnel.",
                                "demande continuellement le feedback des participants et m√®ne une r√©flexion sur celui-ci.",
                                "informe le groupe de mani√®re ad√©quate des conclusions tir√©es du feedback."
                            ]
                        },
                        {
                            "id": "C2",
                            "titre": "Mettre en ≈ìuvre les mesures d'assurance qualit√© prescrites",
                            "criteres_performance": [
                                "utilise les concepts de d√©veloppement et d'assurance de la qualit√© prescrits pour sa propre activit√© de formation.",
                                "assure les standards lors de la r√©alisation des sessions d'enseignement et d'apprentissage.",
                                "met en ≈ìuvre et √©value les √©valuations prescrites dans son propre domaine sp√©cifique."
                            ]
                        },
                        {
                            "id": "C3",
                            "titre": "R√©fl√©chir √† sa propre qualit√© d'enseignement/d'apprentissage et la d√©velopper",
                            "criteres_performance": [
                                "planifie des √©valuations ax√©es sur les r√©sultats pour ses propres sessions d'enseignement et d'apprentissage.",
                                "formule des crit√®res et indicateurs de qualit√©.",
                                "d√©veloppe ses propres instruments de mesure pour son propre domaine sp√©cifique.",
                                "planifie, r√©alise et appr√©cie ses propres √©valuations dans son propre domaine et champ professionnel."
                            ]
                        }
                    ]
                },
                {
                    "id": "D",
                    "titre": "Interagir avec les participants dans le processus d'apprentissage",
                    "description": "Les formateurs cr√©ent une atmosph√®re d'apprentissage constructive et pratiquent un style d'interaction et de communication positif.",
                    "competences": [
                        {
                            "id": "D1",
                            "titre": "Entretenir des relations empreintes de respect avec les participants",
                            "criteres_performance": [
                                "√©coute les objections en restant objectif.",
                                "tient compte des besoins sp√©cifiques dans les phases individuelles.",
                                "traite les participants sans jugement, d'√©gal √† √©gal, en s'effor√ßant de les encourager et communique avec eux dans cette optique.",
                                "accorde de l'importance √† l'estime des autres dans son attitude fondamentale.",
                                "permet aux participants de faire l'exp√©rience de ¬´l'apprentissage par l'enseignement¬ª."
                            ]
                        },
                        {
                            "id": "D2",
                            "titre": "Permettre l'interactions et la communication respectueuses entre les participants dans le processus d'apprentissage",
                            "criteres_performance": [
                                "laisse du temps √† la r√©flexion et √† la recherche de r√©ponses aux questions.",
                                "donne des impulsions et pose des questions ouvertes.",
                                "structure et anime le dialogue avec l'assembl√©e.",
                                "autorise la contradiction, la divergence et anime la discussion ouverte.",
                                "favorise la tol√©rance √† l'ambigu√Øt√©."
                            ]
                        },
                        {
                            "id": "D3",
                            "titre": "Favoriser un environnement propice √† l'apprentissage",
                            "criteres_performance": [
                                "met en ≈ìuvre des strat√©gies ad√©quates pour am√©nager un climat favorable √† l'apprentissage.",
                                "guide les individus et les groupes avec clart√© et calme.",
                                "veille au respect des r√®gles avec le concours des participants."
                            ]
                        }
                    ]
                },
                {
                    "id": "E",
                    "titre": "Accompagner les apprenants individuellement, en mettant l'accent sur le soutien et les processus d'apprentissage",
                    "description": "Les formateurs accompagnent les participants dans leur processus d'apprentissage, depuis la perception de la situation d'apprentissage jusqu'√† la r√©alisation des objectifs d'apprentissage, et les soutiennent avec des m√©thodes ad√©quates.",
                    "competences": [
                        {
                            "id": "E1",
                            "titre": "Fournir aux participants des retours sur les comp√©tences et les progr√®s d'apprentissage",
                            "criteres_performance": [
                                "communique et donne un feedback en t√©moignant de l'estime √† l'autre et en s'exprimant clairement.",
                                "reconna√Æt et nomme les ressources de la personne qu'elle accompagne."
                            ]
                        },
                        {
                            "id": "E2",
                            "titre": "D√©terminer les objectifs d'apprentissage d√©riv√©s des comp√©tences du point de vue du formateur ou conjointement avec les participants et v√©rifier leur r√©alisation",
                            "criteres_performance": [
                                "analyse les objectifs et contenus prescrits et les harmonise avec les conditions-cadres et les besoins de la personne √† encadrer.",
                                "incite les participants √† formuler leurs propres objectifs d'apprentissage.",
                                "√©value les ressources permettant d'atteindre les objectifs et cr√©e des conditions pour pouvoir les utiliser.",
                                "recherche des propositions de solutions avec la personne √† accompagner, les √©value et les choisit.",
                                "agende et v√©rifie la r√©alisation des objectifs avec les participants."
                            ]
                        },
                        {
                            "id": "E3",
                            "titre": "Concevoir des processus d'accompagnement en tenant compte de l'auto-organisation et de l'auto-efficacit√©",
                            "criteres_performance": [
                                "identifie des situations dans lesquelles l'auto-efficacit√© des participants est encourag√©e.",
                                "formule les t√¢ches de telle mani√®re que les participants puissent les r√©aliser de mani√®re autonome.",
                                "cr√©e ou modifie les documents d'apprentissage pour l'encadrement individuel."
                            ]
                        },
                        {
                            "id": "E4",
                            "titre": "Mener des entretiens individuels en ayant conscience de son attitude et des r√¥les dans l'entretien",
                            "criteres_performance": [
                                "analyse et r√©fl√©chit au contact et √† la relation avec la personne √† accompagner.",
                                "v√©rifie, sous un angle critique, sa propre perception et ses pr√©jug√©s possibles.",
                                "aborde de mani√®re ad√©quate les demandes de son partenaire de discussion.",
                                "con√ßoit de mani√®re reconnaissable les phases essentielles du d√©roulement de la conversation.",
                                "cat√©gorise la situation et le r√¥le dans diff√©rentes constellations de la discussion et les repr√©sente de mani√®re ad√©quate.",
                                "cr√©e des liens avec les concepts et les mod√®les de la communication et de la conduite de discussions."
                            ]
                        },
                        {
                            "id": "E5",
                            "titre": "Saisir les comportements d'apprentissage, identifier les probl√®mes d'apprentissage et aider la personne accompagn√©e dans la r√©solution des probl√®mes",
                            "criteres_performance": [
                                "per√ßoit le comportement d'apprentissage des participants et les difficult√©s li√©es √† celui-ci et r√©fl√©chit √† leurs causes possibles avec les participants.",
                                "√©value les ressources permettant d'atteindre les objectifs et en tient compte comme point de d√©part chez les participantes et les participants.",
                                "soutient les participantes et les participants dans la mise en ≈ìuvre de strat√©gies de travail et d'apprentissage."
                            ]
                        },
                        {
                            "id": "E6",
                            "titre": "Choisir avec justification les m√©thodes d'accompagnement de l'apprentissage",
                            "criteres_performance": [
                                "s√©lectionne des m√©thodes ad√©quates pour le processus d'apprentissage.",
                                "planifie correctement l'utilisation des m√©thodes."
                            ]
                        },
                        {
                            "id": "E7",
                            "titre": "Renseigner une personne int√©ress√©e sur les possibilit√©s de formation continue et de certification dans son domaine sp√©cifique",
                            "criteres_performance": [
                                "situe correctement sa propre activit√© de formation dans le paysage de la formation.",
                                "d√©crit les possibilit√©s de formation continue pour son propre champ professionnel.",
                                "donne des renseignements diff√©renci√©s sur les possibilit√©s de formation et de formation continue dans son propre domaine sp√©cialis√© et champ professionnel."
                            ]
                        }
                    ]
                },
                {
                    "id": "F",
                    "titre": "Diriger et mod√©rer des groupes",
                    "description": "L'apprentissage en groupes se d√©roule dans un √©change vivant, que les diff√©rents membres du groupe per√ßoivent objectivement et subjectivement de diff√©rentes mani√®res.",
                    "competences": [
                        {
                            "id": "F1",
                            "titre": "Percevoir et comprendre les dynamiques de groupe",
                            "criteres_performance": [
                                "d√©crit ou visualise les caract√©ristiques d'un groupe d'apprentissage.",
                                "reconna√Æt et nomme les processus de groupe essentiels dans une situation particuli√®re."
                            ]
                        },
                        {
                            "id": "F2",
                            "titre": "Percevoir le comportement relationnel d'un groupe (communication) et l'influencer activement",
                            "criteres_performance": [
                                "per√ßoit et analyse de mani√®re diff√©renci√©e le comportement en mati√®re de communication dans le groupe et ses propres r√©actions",
                                "d√©veloppe et utilise des strat√©gies de mani√®re proactive.",
                                "intervient de mani√®re √† soutenir la communication, en fonction de la situation."
                            ]
                        },
                        {
                            "id": "F3",
                            "titre": "Intervenir dans les processus de groupes de mani√®re appropri√©e en regard de la situation",
                            "criteres_performance": [
                                "g√©n√®re des hypoth√®ses et formule des options d'interventions possibles en fonction de la situation.",
                                "justifie le choix de l'intervention ou des interventions effectu√©es.",
                                "vise le d√©veloppement de la situation du groupe."
                            ]
                        },
                        {
                            "id": "F4",
                            "titre": "Clarifier les r√¥les dans les groupes",
                            "criteres_performance": [
                                "per√ßoit et analyse de mani√®re diff√©renci√©e la situation ainsi que son ou ses propres r√¥les et r√©actions.",
                                "reconna√Æt et identifie un conflit de r√¥le dans une situation particuli√®re.",
                                "aborde et clarifie un conflit de r√¥les lorsqu'il surgit."
                            ]
                        },
                        {
                            "id": "F5",
                            "titre": "D√©velopper des conventions d'apprentissage avec les groupes",
                            "criteres_performance": [
                                "a conscience de ses propres valeurs et attitudes en lien avec la conduite de groupes.",
                                "r√©dige des conventions d'apprentissage ou les d√©veloppe avec les groupes."
                            ]
                        },
                        {
                            "id": "F6",
                            "titre": "Animer le contenu selon les questions √† traiter",
                            "criteres_performance": [
                                "planifie une mod√©ration de mani√®re anticip√©e.",
                                "adapte la mod√©ration de mani√®re ax√©e sur le processus.",
                                "con√ßoit les phases de mod√©ration de mani√®re cibl√©e sur les objectifs, avec des m√©thodes appropri√©es.",
                                "prend un r√¥le de conseiller et d'accompagnateur du processus, per√ßoit et r√©fl√©chit consciemment aux points divergents.",
                                "veille au respect des r√®gles de communication et de comportement.",
                                "assure les r√©sultats avec le groupe.",
                                "vise √† atteindre un consensus avec le groupe pendant toute la dur√©e du processus."
                            ]
                        },
                        {
                            "id": "F7",
                            "titre": "Animer des processus d'interaction",
                            "criteres_performance": [
                                "examine les processus de groupe et les rend visibles par la m√©tacommunication.",
                                "guide le groupe dans son d√©veloppement autonome."
                            ]
                        }
                    ]
                },
                {
                    "id": "G",
                    "titre": "Concevoir des activit√©s de formation et d'apprentissage ax√©es sur les comp√©tences et le transfert",
                    "description": "Les formateurs d√©veloppent, dans leur domaine de sp√©cialisation, des concepts didactiques visant √† obtenir les comp√©tences sp√©cifiques et g√©n√©rales et d√©veloppent des concepts de transfert r√©alisables.",
                    "competences": [
                        {
                            "id": "G1",
                            "titre": "Clarifier, dans son propre domaine d'expertise, le besoin de formation ainsi que les int√©r√™ts et les pr√©requis du public cible pour une unit√© de formation",
                            "criteres_performance": [
                                "clarifie les pr√©requis des destinataires et en tient compte dans la planification.",
                                "clarifie et prend en compte les conditions aussi pendant le processus d'enseignement/d'apprentissage."
                            ]
                        },
                        {
                            "id": "G2",
                            "titre": "Formuler des comp√©tences sp√©cifiques et interdisciplinaires",
                            "criteres_performance": [
                                "formule un profil de comp√©tences pour une session d'apprentissage dans son propre domaine sp√©cifique.",
                                "extrait des ressources des comp√©tences.",
                                "identifie et formule les situations de travail pertinentes pour les comp√©tences."
                            ]
                        },
                        {
                            "id": "G3",
                            "titre": "D√©velopper un concept didactique pour une unit√© de formation sp√©cifique",
                            "criteres_performance": [
                                "d√©veloppe ses propres principes didactiques et en extrait des cons√©quences didactiques concr√®tes.",
                                "formule, dans sa conception didactique, des contenus, formes d'enseignement/d'apprentissage et modalit√©s d'apprentissage en accord avec la conception de l'enseignement/l'apprentissage.",
                                "con√ßoit le design didactique de mani√®re coh√©rente avec la conception de l'enseignement et de l'apprentissage et les principes didactiques."
                            ]
                        },
                        {
                            "id": "G4",
                            "titre": "Concevoir la validation de l'acquisition des comp√©tences",
                            "criteres_performance": [
                                "con√ßoit des strat√©gies coh√©rentes et des instruments pour √©valuer les prestations.",
                                "met en place des justificatifs de prestations et des instruments d'√©valuation de mani√®re ax√©e sur les comp√©tences."
                            ]
                        },
                        {
                            "id": "G5",
                            "titre": "D√©velopper un concept de transfert pour une unit√© de formation",
                            "criteres_performance": [
                                "d√©crit un concept de transfert avec des formes, des orientations, des moments, etc. en s'aidant de justifications th√©oriques.",
                                "con√ßoit le transfert au niveau personnel, interpersonnel et mat√©riel."
                            ]
                        },
                        {
                            "id": "G6",
                            "titre": "Concevoir des sessions d'enseignement/d'apprentissage orient√©es sur une th√©matique avec une biographie sp√©cifique",
                            "criteres_performance": [
                                "formule des t√¢ches de transfert concr√®tes, qui abordent le d√©veloppement ult√©rieur des comp√©tences vis√©es en tenant compte de la situation d'apprentissage et de travail individuelle ainsi que de la biographie personnelle.",
                                "am√©nage les sessions de transfert au moyen de t√¢ches qui peuvent √™tre adapt√©es aux participants en fonction de leur situation individuelle."
                            ]
                        }
                    ]
                },
                {
                    "id": "H",
                    "titre": "R√©fl√©chir √† leurs propres actions professionnelles et les d√©velopper continuellement",
                    "description": "Les formateurs r√©fl√©chissent √† leur propre r√¥le, √† leur conception de l'apprentissage, √† leurs valeurs et attitudes et se d√©veloppent continuellement.",
                    "competences": [
                        {
                            "id": "H1",
                            "titre": "Clarifier son propre r√¥le et influencer en cons√©quence",
                            "criteres_performance": [
                                "comprend le r√¥le comme une action r√©ciproque entre personnes, fonction et attentes des autres.",
                                "reconna√Æt son propre r√¥le en fonction de la situation et y r√©fl√©chit.",
                                "se penche sur les diff√©rences de perception dans le r√¥le.",
                                "reconna√Æt sa propre fonction de mod√®le et adapte ses actions √©thiques, sociales et √©cologiques aux valeurs transmises."
                            ]
                        },
                        {
                            "id": "H2",
                            "titre": "R√©fl√©chir sur sa propre conception de l'enseignement et de l'apprentissage, sur ses propres valeurs, attitudes et normes dans le contexte de son exp√©rience et ressources sp√©cifiques",
                            "criteres_performance": [
                                "formule sa propre conception de l'enseignement/apprentissage.",
                                "d√©crit des situations, interpr√®te sur la base de jugements et exp√©riences personnels, analyse en s'appuyant sur la th√©orie et cat√©gorise professionnellement gr√¢ce √† un discours critique int√©grant plusieurs perspectives.",
                                "comprend sa propre biographie comme une d√©terminante de la conception de l'enseignement et de l'apprentissage et du comportement en la mati√®re."
                            ]
                        },
                        {
                            "id": "H3",
                            "titre": "V√©rifier son propre comportement et l'adapter si n√©cessaire",
                            "criteres_performance": [
                                "r√©fl√©chit √† son propre comportement en se percevant lui-m√™me et en percevant les autres.",
                                "prend conscience de ses possibles angles morts.",
                                "utilise des strat√©gies de changement de comportement."
                            ]
                        },
                        {
                            "id": "H4",
                            "titre": "R√©fl√©chir aux probl√®mes de la pratique et les r√©soudre au sein d'une √©quipe coll√©giale",
                            "criteres_performance": [
                                "collabore avec d'autres formateurs.",
                                "rend exploitables les r√©sultats de conseils coll√©giaux pour ses propres actions."
                            ]
                        },
                        {
                            "id": "H5",
                            "titre": "D√©velopper et appliquer des strat√©gies pour la gestion des situations difficiles",
                            "criteres_performance": [
                                "anticipe les situations difficiles et prend des mesures de mani√®re proactive.",
                                "per√ßoit et nomme les situations difficiles sur le plan cognitif, physique et √©motionnel.",
                                "applique des strat√©gies de d√©lestage dans les situations o√π s'exerce une certaine pression."
                            ]
                        },
                        {
                            "id": "H6",
                            "titre": "Anticiper et prendre en compte les changements, les incertitudes, les contradictions et la complexit√© dans ses propres mises en ≈ìuvre didactiques",
                            "criteres_performance": [
                                "reconna√Æt et peut nommer les contradictions",
                                "reconna√Æt les ambigu√Øt√©s et les supporte.",
                                "fait preuve de calme dans les situations contradictoires."
                            ]
                        },
                        {
                            "id": "H7",
                            "titre": "D√©velopper une compr√©hension de la profession dans son propre contexte de travail",
                            "criteres_performance": [
                                "est en mesure de d√©crire son d√©veloppement personnel en tant que formateurs.",
                                "r√©fl√©chit √† ses propres conclusions ax√©es sur l'exp√©rience et les compare aux r√©sultats de la recherche.",
                                "r√©fl√©chit √† son action professionnelle avant, pendant et apr√®s l'action."
                            ]
                        },
                        {
                            "id": "H8",
                            "titre": "Int√©grer la diversit√© lors de ses r√©flexions sur les sessions d'enseignement/d'apprentissage",
                            "criteres_performance": [
                                "d√©crit la diversit√© dans un groupe d'apprentissage",
                                "applique la prise en compte de la diversit√© √† titre de principe dans l'action didactique."
                            ]
                        }
                    ]
                },
                {
                    "id": "I",
                    "titre": "Mettre en ≈ìuvre des normes √©thiques",
                    "description": "Les formateurs sont conscients de leur r√¥le de conception au sein de leur contexte de travail. Ils permettent un apprentissage de toute une vie, prot√®gent l'int√©grit√© des participants et respectent la diversit√© dans toutes ses dimensions possibles.",
                    "competences": [
                        {
                            "id": "I1",
                            "titre": "Encourager et rendre possible l'apprentissage tout au long de la vie",
                            "criteres_performance": [
                                "permet de faire un bilan et d'accompagner.",
                                "incite les personnes peu qualifi√©es √† suivre et terminer une formation professionnelle."
                            ]
                        },
                        {
                            "id": "I2",
                            "titre": "Pr√©server l'int√©grit√© des participants",
                            "criteres_performance": [
                                "con√ßoit son propre comportement de formation sans pr√©jug√©s.",
                                "aborde les participants d'√©gal √† √©gal.",
                                "vit dans une culture des questions visant √† se conna√Ætre soi-m√™me.",
                                "argumente de fa√ßon logique, coh√©rente et avec un choix de mots appr√©ciable.",
                                "pratique une √©coute active et pose des questions.",
                                "fait consciemment la d√©monstration d'un changement de perspective et incite les autres √† faire de m√™me."
                            ]
                        },
                        {
                            "id": "I3",
                            "titre": "Exploiter consciemment la diversit√©, l'interculturalit√©, la multiculturalit√© et la transculturalit√© lors de situations opportunes et constructives",
                            "criteres_performance": [
                                "clarifie la culture des valeurs dans le contexte de l'enseignement et de l'apprentissage et contribue consciemment √† fa√ßonner les valeurs institutionnelles.",
                                "questionne les sessions d'enseignement/d'apprentissage et les v√©rifie sous l'angle de la diversit√©.",
                                "aborde les discriminations et contribue activement √† les √©liminer."
                            ]
                        },
                        {
                            "id": "I4",
                            "titre": "Lib√©rer son activit√© professionnelle des pr√©jug√©s",
                            "criteres_performance": [
                                "communique et argumente avec impartialit√©."
                            ]
                        },
                        {
                            "id": "I5",
                            "titre": "Accepter les diverses orientations de valeurs et proc√©der √† des changements de perspective",
                            "criteres_performance": [
                                "pose des questions ouvertes en cas d'incertitudes.",
                                "pratique et √©value le changement de perspective de mani√®re transparente"
                            ]
                        },
                        {
                            "id": "I6",
                            "titre": "Interpr√©ter les processus d'enseignement/d'apprentissage en tant que concr√©tisation de l'apprentissage",
                            "criteres_performance": [
                                "propose des contextes qui encouragent l'autogestion et l'autor√©gulation.",
                                "incite √† l'autor√©flexion et propose des moyens et des m√©thodes pour le faire.",
                                "veille √† une co-construction de l'itin√©raire d'apprentissage."
                            ]
                        },
                        {
                            "id": "I7",
                            "titre": "Viser l'excellence dans ses activit√©s professionnelles",
                            "criteres_performance": [
                                "d√©finit des stimulations positives pour soi-m√™me et pour les autres.",
                                "consulte r√©guli√®rement des personnes ext√©rieures pour avoir leur avis.",
                                "v√©rifie concr√®tement les feedbacks et en extrait des mesures.",
                                "identifie ses propres comp√©tences et les compl√®te r√©guli√®rement."
                            ]
                        },
                        {
                            "id": "I8",
                            "titre": "Permettre l'√©galit√© des chances",
                            "criteres_performance": [
                                "v√©rifie et adapte les mesures d'encouragement.",
                                "encourage de mani√®re individualis√©e et permet l'acc√®s √† l'apprentissage."
                            ]
                        },
                        {
                            "id": "I9",
                            "titre": "Planifier et mettre en ≈ìuvre les ressources en personnel et en mat√©riel de fa√ßon durable",
                            "criteres_performance": [
                                "fait preuve d'une attitude r√©fl√©chie par rapport √† ses propres forces et faiblesses et par rapport √† celles des autres.",
                                "utilise les offres de repos ou de compensation.",
                                "v√©rifie continuellement les ressources mat√©rielles en lien avec la rentabilit√© et l'√©cologie et prend des mesures de r√©√©quilibrage ou d'optimisation si n√©cessaire."
                            ]
                        }
                    ]
                }
            ]
        };
        
        // Variables globales pour le stockage des donn√©es
        let portfolioData = {
            profile: {
                name: "",
                institution: "",
                institutions: [],
                experience: "",
                specialties: ""
            },
            competences: [],
            situations: [],
            proofs: [],
            reflections: [],
            goals: [],
            lastSaved: null
        };
        
        // Variable pour le mode √©dition des situations
        let editingSituationIndex = null;
        
        // Initialisation du portfolio
        document.addEventListener('DOMContentLoaded', function() {
            // Charger les donn√©es sauvegard√©es si elles existent
            loadData();
            
            // Initialiser les √©l√©ments de l'interface
            initializeUI();
            
            // Configuration des √©v√©nements de sauvegarde automatique
            setupAutoSave();
            
            // Afficher un message de bienvenue pour les nouveaux utilisateurs
            if (!portfolioData.lastSaved) {
                showWelcomeMessage();
            }
            
            // Configurer les accord√©ons pour le guide d'utilisation
            setupAccordions();
            
            // Initialiser l'interface de s√©lection des comp√©tences
            loadDomains();
            renderCompetences();
            
            // Afficher les situations d√©j√† sauvegard√©es
            renderSituations();
            
            // Afficher les preuves d√©j√† sauvegard√©es
            renderProofs();
            
            // Afficher les r√©flexions d√©j√† sauvegard√©es
            renderReflections();
            
            // Afficher les objectifs d√©j√† sauvegard√©s
            renderGoals();
            
            // Mettre √† jour le tableau de bord
            updateDashboard();
        });
        
        // Fonctions de gestion des donn√©es
        function loadData() {
            try {
                const savedData = localStorage.getItem('portfolioData');
                if (savedData) {
                    portfolioData = JSON.parse(savedData);
                    
                    // Remplir les champs du profil
                    document.getElementById('name').value = portfolioData.profile.name || "";
                    // Compatibilit√©: migrer l'ancien champ institution vers le tableau institutions
                    if (!portfolioData.profile.institutions) {
                        portfolioData.profile.institutions = portfolioData.profile.institution ? [portfolioData.profile.institution] : [];
                    }
                    renderInstitutions();
                    document.getElementById('experience').value = portfolioData.profile.experience || "";
                    document.getElementById('specialties').value = portfolioData.profile.specialties || "";
                    
                    // Mise √† jour de la date de derni√®re sauvegarde
                    if (portfolioData.lastSaved) {
                        const lastSaved = new Date(portfolioData.lastSaved);
                        console.log("Donn√©es charg√©es. Derni√®re sauvegarde: " + lastSaved.toLocaleString());
                    }
                }
            } catch (error) {
                console.error("Erreur lors du chargement des donn√©es:", error);
                showSaveStatus('save-error', 'Erreur lors du chargement des donn√©es');
            }
        }
        
        function saveData() {
            try {
                // Mettre √† jour la date de derni√®re sauvegarde
                portfolioData.lastSaved = new Date().toISOString();
                
                // Sauvegarder dans le localStorage
                localStorage.setItem('portfolioData', JSON.stringify(portfolioData));
                console.log("Donn√©es sauvegard√©es avec succ√®s: " + new Date().toLocaleString());
                
                return true;
            } catch (error) {
                console.error("Erreur lors de la sauvegarde des donn√©es:", error);
                showSaveStatus('save-error', 'Erreur lors de la sauvegarde');
                
                return false;
            }
        }
        
        // NOUVEAU: Fonction pour r√©initialiser le portfolio
        function resetPortfolio() {
            if (confirm('‚ö†Ô∏è √ätes-vous s√ªr de vouloir r√©initialiser votre portfolio ?\n\nCette action supprimera TOUTES vos donn√©es (profil, situations, comp√©tences, r√©flexions...).\n\nCette action est irr√©versible !')) {
                if (confirm('Derni√®re confirmation : voulez-vous vraiment tout effacer ?')) {
                    try {
                        // 1. Supprimer du localStorage
                        localStorage.removeItem('portfolioData');
                        
                        // 2. V√©rifier que c'est bien supprim√©
                        const check = localStorage.getItem('portfolioData');
                        console.log('Apr√®s suppression, localStorage contient:', check);
                        
                        // 3. R√©initialiser la variable en m√©moire
                        portfolioData = {
                            profile: { name: "", institution: "", institutions: [], experience: "", specialties: "" },
                            competences: [],
                            situations: [],
                            proofs: [],
                            reflections: [],
                            goals: [],
                            lastSaved: null
                        };
                        
                        // 4. Sauvegarder l'√©tat vide (pour √™tre s√ªr)
                        localStorage.setItem('portfolioData', JSON.stringify(portfolioData));
                        
                        // 5. Message et rechargement
                        alert('‚úÖ Portfolio r√©initialis√© avec succ√®s !\n\nLa page va se recharger.');
                        window.location.reload(true); // true = forcer le rechargement depuis le serveur/fichier
                    } catch (e) {
                        console.error('Erreur lors de la r√©initialisation:', e);
                        alert('‚ùå Erreur lors de la r√©initialisation: ' + e.message);
                    }
                }
            }
        }
        
        function saveProfile() {
            portfolioData.profile.name = document.getElementById('name').value;
            // institutions g√©r√©es via addInstitution/removeInstitution
            portfolioData.profile.institution = portfolioData.profile.institutions.join(', ');
            portfolioData.profile.experience = document.getElementById('experience').value;
            portfolioData.profile.specialties = document.getElementById('specialties').value;
            
            if (saveData()) {
                showSaveStatus('save-success', 'Profil enregistr√© avec succ√®s');
            }
        }
        
        // Fonctions pour la gestion des comp√©tences
        function loadDomains() {
            const select = document.getElementById('domain-select');
            if (!select) return;
            
            select.innerHTML = '<option value="">S√©lectionnez un domaine de comp√©tence</option>';
            
            qualificationProfile.domaines.forEach(domaine => {
                const option = document.createElement('option');
                option.value = domaine.id;
                option.textContent = `${domaine.id}: ${domaine.titre}`;
                select.appendChild(option);
            });
        }
        
        function loadCompetences(domaineId) {
            const select = document.getElementById('competence-select');
            if (!select) return;
            
            select.innerHTML = '<option value="">S√©lectionnez une comp√©tence</option>';
            
            if (!domaineId) {
                select.disabled = true;
                return;
            }
            
            const domaine = qualificationProfile.domaines.find(d => d.id === domaineId);
            if (domaine) {
                domaine.competences.forEach(competence => {
                    const option = document.createElement('option');
                    option.value = competence.id;
                    option.textContent = `${competence.id}: ${competence.titre}`;
                    select.appendChild(option);
                });
                select.disabled = false;
            }
            
            // Cacher les d√©tails de la comp√©tence
            const detailsElement = document.getElementById('competence-details');
            if (detailsElement) {
                detailsElement.classList.add('hidden');
            }
        }
        
        function loadCriteres(competenceId) {
            const detailsElement = document.getElementById('competence-details');
            if (!detailsElement) return;
            
            if (!competenceId) {
                detailsElement.classList.add('hidden');
                return;
            }
            
            // Trouver la comp√©tence s√©lectionn√©e
            let selectedCompetence = null;
            let selectedDomaine = null;
            
            for (const domaine of qualificationProfile.domaines) {
                const comp = domaine.competences.find(c => c.id === competenceId);
                if (comp) {
                    selectedCompetence = comp;
                    selectedDomaine = domaine;
                    break;
                }
            }
            
            if (selectedCompetence) {
                // Afficher la description
                const descriptionElement = document.getElementById('competence-description');
                if (descriptionElement) {
                    descriptionElement.value = `${selectedCompetence.titre}\n\nContexte: ${selectedDomaine.description}`;
                }
                
                // Afficher les crit√®res de performance
                const container = document.getElementById('criteres-container');
                if (container) {
                    container.innerHTML = '';
                    
                    selectedCompetence.criteres_performance.forEach((critere, index) => {
                        const div = document.createElement('div');
                        div.className = 'critere-item';
                        
                        const checkbox = document.createElement('input');
                        checkbox.type = 'checkbox';
                        checkbox.id = `critere-${index}`;
                        checkbox.className = 'critere-checkbox';
                        checkbox.checked = true;
                        
                        const label = document.createElement('label');
                        label.htmlFor = `critere-${index}`;
                        label.className = 'critere-label';
                        label.textContent = critere;
                        
                        div.appendChild(checkbox);
                        div.appendChild(label);
                        container.appendChild(div);
                    });
                }
                
                // Afficher les d√©tails de la comp√©tence
                detailsElement.classList.remove('hidden');
            }
        }
        
        function saveCompetence() {
            // Obtenir le domaine et la comp√©tence s√©lectionn√©s
            const domaineId = document.getElementById('domain-select').value;
            const competenceId = document.getElementById('competence-select').value;
            
            if (!domaineId || !competenceId) {
                alert('Veuillez s√©lectionner un domaine et une comp√©tence.');
                return;
            }
            
            // Trouver la comp√©tence dans le profil de qualification
            let selectedCompetence = null;
            let selectedDomaine = null;
            
            for (const domaine of qualificationProfile.domaines) {
                if (domaine.id === domaineId) {
                    selectedDomaine = domaine;
                    const comp = domaine.competences.find(c => c.id === competenceId);
                    if (comp) {
                        selectedCompetence = comp;
                        break;
                    }
                }
            }
            
            if (!selectedCompetence || !selectedDomaine) {
                alert('Comp√©tence non trouv√©e.');
                return;
            }
            
            // Obtenir les crit√®res de performance s√©lectionn√©s
            const criteres = [];
            document.querySelectorAll('.critere-checkbox:checked').forEach((checkbox, index) => {
                criteres.push(selectedCompetence.criteres_performance[index]);
            });
            
            // V√©rifier si l'importance a √©t√© renseign√©e
            const importance = document.getElementById('competence-importance').value;
            if (!importance.trim()) {
                alert('Veuillez indiquer l\'importance de cette comp√©tence dans votre pratique.');
                return;
            }
            
            // Cr√©er l'objet de comp√©tence √† sauvegarder
            const competenceToSave = {
                id: selectedCompetence.id,
                title: selectedCompetence.titre,
                domain: {
                    id: selectedDomaine.id,
                    title: selectedDomaine.titre
                },
                description: selectedCompetence.titre,
                criteria: criteres,
                importance: importance,
                dateAdded: new Date().toISOString()
            };
            
            // Ajouter la comp√©tence aux donn√©es du portfolio
            portfolioData.competences.push(competenceToSave);
            
            // Sauvegarder les donn√©es
            if (saveData()) {
                showSaveStatus('save-success', 'Comp√©tence enregistr√©e avec succ√®s');
                
                // R√©initialiser le formulaire
                document.getElementById('domain-select').value = '';
                document.getElementById('competence-select').value = '';
                document.getElementById('competence-select').disabled = true;
                document.getElementById('competence-importance').value = '';
                document.getElementById('competence-details').classList.add('hidden');
                
                // Mettre √† jour l'affichage des comp√©tences
                renderCompetences();
                updateCompetenceLinkedSelects();
            }
        }
        
        function renderCompetences() {
            // Afficher les comp√©tences dans l'onglet "Comp√©tences op√©rationnelles"
            const competencesList = document.getElementById('competences-list');
            if (competencesList) {
                competencesList.innerHTML = '';
                
                if (portfolioData.competences.length === 0) {
                    const emptyMessage = document.createElement('div');
                    emptyMessage.className = 'alert alert-info';
                    emptyMessage.textContent = 'Vous n\'avez pas encore document√© de comp√©tences. Utilisez le formulaire ci-dessus pour en ajouter.';
                    competencesList.appendChild(emptyMessage);
                } else {
                    // Regrouper les comp√©tences par domaine
                    const competencesByDomain = {};
                    
                    portfolioData.competences.forEach(competence => {
                        const domainId = competence.domain.id;
                        if (!competencesByDomain[domainId]) {
                            competencesByDomain[domainId] = [];
                        }
                        competencesByDomain[domainId].push(competence);
                    });
                    
                    // Afficher les comp√©tences par domaine
                    for (const domainId in competencesByDomain) {
                        // Trouver le domaine correspondant
                        const domain = qualificationProfile.domaines.find(d => d.id === domainId);
                        const domainTitle = domain ? domain.titre : 'Domaine inconnu';
                        
                        // Cr√©er un titre pour le domaine
                        const domainHeading = document.createElement('div');
                        domainHeading.className = 'domaine-heading';
                        domainHeading.textContent = `${domainId}: ${domainTitle}`;
                        competencesList.appendChild(domainHeading);
                        
                        // Afficher les comp√©tences de ce domaine
                        competencesByDomain[domainId].forEach((competence, index) => {
                            const card = createCompetenceCard(competence, index);
                            competencesList.appendChild(card);
                        });
                    }
                }
            }
            
            // Mettre √† jour le r√©sum√© des comp√©tences dans l'onglet "Vue d'ensemble"
            const competencesOverview = document.getElementById('competences-overview');
            if (competencesOverview) {
                competencesOverview.innerHTML = '';
                
                if (portfolioData.competences.length === 0) {
                    const emptyMessage = document.createElement('div');
                    emptyMessage.className = 'alert alert-info';
                    emptyMessage.textContent = 'Vous n\'avez pas encore document√© de comp√©tences.';
                    competencesOverview.appendChild(emptyMessage);
                } else {
                    portfolioData.competences.forEach(competence => {
                        // Trouver les situations associ√©es √† cette comp√©tence (v√©rifie competenceIds ET competenceId)
                        const situationsCount = portfolioData.situations.filter(s => {
                            const ids = s.competenceIds || [s.competenceId];
                            return ids.includes(competence.id);
                        }).length;
                        // Trouver les preuves associ√©es aux situations de cette comp√©tence
                        const situations = portfolioData.situations.filter(s => {
                            const ids = s.competenceIds || [s.competenceId];
                            return ids.includes(competence.id);
                        });
                        const situationIds = situations.map(s => s.id);
                        const proofsCount = portfolioData.proofs.filter(p => situationIds.includes(p.situationId)).length;
                        
                        const card = document.createElement('div');
                        card.className = 'competence-card';
                        card.innerHTML = `
                            <h4>${competence.id}: ${competence.title}</h4>
                            <p>${situationsCount} situation${situationsCount !== 1 ? 's' : ''} document√©e${situationsCount !== 1 ? 's' : ''}, ${proofsCount} preuve${proofsCount !== 1 ? 's' : ''}</p>
                        `;
                        competencesOverview.appendChild(card);
                    });
                }
            }
        }
        
        function createCompetenceCard(competence, index) {
            const card = document.createElement('div');
            card.className = 'card';
            
            const cardHeader = document.createElement('div');
            cardHeader.className = 'card-header';
            
            const cardTitle = document.createElement('h3');
            cardTitle.className = 'card-title';
            cardTitle.textContent = `${competence.id}: ${competence.title}`;
            
            const actionButtons = document.createElement('div');
            actionButtons.className = 'action-buttons';
            
            // Seulement le bouton Supprimer (les comp√©tences sont auto-g√©n√©r√©es via les situations)
            const deleteButton = document.createElement('button');
            deleteButton.className = 'btn btn-danger';
            deleteButton.textContent = 'Supprimer';
            deleteButton.onclick = () => deleteCompetence(index);
            
            actionButtons.appendChild(deleteButton);
            
            cardHeader.appendChild(cardTitle);
            cardHeader.appendChild(actionButtons);
            
            const description = document.createElement('p');
            description.innerHTML = `<strong>Description:</strong> ${competence.description}`;
            
            const criteriaTitle = document.createElement('h4');
            criteriaTitle.textContent = 'Crit√®res de performance:';
            
            const criteriaList = document.createElement('ul');
            competence.criteria.forEach(criterion => {
                const item = document.createElement('li');
                item.textContent = criterion;
                criteriaList.appendChild(item);
            });
            
            const importanceTitle = document.createElement('h4');
            importanceTitle.textContent = 'Importance dans ma pratique:';
            
            const importance = document.createElement('p');
            importance.textContent = competence.importance;
            
            card.appendChild(cardHeader);
            card.appendChild(description);
            card.appendChild(criteriaTitle);
            card.appendChild(criteriaList);
            card.appendChild(importanceTitle);
            card.appendChild(importance);
            
            // Ajouter la date d'ajout si disponible
            if (competence.dateAdded) {
                const dateAdded = document.createElement('p');
                dateAdded.className = 'text-light';
                dateAdded.style.fontSize = '0.9em';
                dateAdded.style.fontStyle = 'italic';
                dateAdded.style.marginTop = '15px';
                dateAdded.textContent = `Ajout√©e le: ${new Date(competence.dateAdded).toLocaleDateString()}`;
                card.appendChild(dateAdded);
            }
            
            return card;
        }
        
        function editCompetence(index) {
            const competence = portfolioData.competences[index];
            if (!competence) return;
            
            // Ouvrir l'onglet comp√©tences si n√©cessaire
            openTab({ currentTarget: document.querySelector('.tab[onclick*="competences"]') }, 'competences');
            
            // Faire d√©filer jusqu'au formulaire d'ajout
            document.querySelector('#competences .card').scrollIntoView({ behavior: 'smooth' });
            
            // Pr√©-remplir le formulaire avec les valeurs existantes
            // Note: Cette fonction est limit√©e car on ne peut pas r√©ellement √©diter la comp√©tence
            // √† partir du profil de qualification, mais on peut au moins montrer ses informations
            
            alert(`Pour modifier cette comp√©tence (${competence.id}), supprimez-la et ajoutez-la √† nouveau avec vos modifications.`);
        }
        
        function toggleExperimentations(id) {
    const content = document.getElementById(`experimentations-${id}`);
    const arrow = document.getElementById(`exp-arrow-${id}`);
    
    if (content.classList.contains('hidden')) {
        content.classList.remove('hidden');
        arrow.style.transform = 'rotate(180deg)';
    } else {
        content.classList.add('hidden');
        arrow.style.transform = 'rotate(0deg)';
    }
}
function deleteCompetence(index) {
            if (confirm('√ätes-vous s√ªr de vouloir supprimer cette comp√©tence ? Cette action supprimera √©galement toutes les situations de travail et preuves associ√©es.')) {
                const competenceToDelete = portfolioData.competences[index];
                
                // Supprimer la comp√©tence
                portfolioData.competences.splice(index, 1);
                
                // Supprimer les situations associ√©es
                const situationsToDelete = portfolioData.situations.filter(s => s.competenceId === competenceToDelete.id);
                const situationIdsToDelete = situationsToDelete.map(s => s.id);
                portfolioData.situations = portfolioData.situations.filter(s => s.competenceId !== competenceToDelete.id);
                
                // Supprimer les preuves associ√©es aux situations
                portfolioData.proofs = portfolioData.proofs.filter(p => !situationIdsToDelete.includes(p.situationId));
                
                // Supprimer les r√©flexions associ√©es
                portfolioData.reflections = portfolioData.reflections.filter(r => r.competenceId !== competenceToDelete.id);
                
                // Supprimer les objectifs associ√©s
                portfolioData.goals = portfolioData.goals.filter(g => g.competenceId !== competenceToDelete.id);
                
                if (saveData()) {
                    showSaveStatus('save-success', 'Comp√©tence supprim√©e avec succ√®s');
                    renderCompetences();
                    updateCompetenceLinkedSelects();
                }
            }
        }
        
        // NOUVEAU: Fonction pour mettre √† jour le tableau de bord (Vue d'ensemble)
        function updateDashboard() {
            // 1. Mettre √† jour la barre de progression
            const progressBar = document.getElementById('global-progress');
            if (progressBar) {
                // Calculer la progression bas√©e sur les comp√©tences document√©es (sur 50 possibles au total)
                const totalCompetences = 50; // Approximation du nombre total de comp√©tences BFFA
                const documentedCompetences = portfolioData.competences.length;
                const progressPercent = Math.min(100, Math.round((documentedCompetences / totalCompetences) * 100));
                progressBar.style.width = progressPercent + '%';
            }
            
            // 2. Mettre √† jour la chronologie avec les situations
            const timelineContainer = document.getElementById('timeline-container');
            if (timelineContainer) {
                timelineContainer.innerHTML = '<h3>Chronologie de votre d√©veloppement</h3>';
                
                if (portfolioData.situations.length === 0) {
                    const emptyMsg = document.createElement('div');
                    emptyMsg.className = 'alert alert-info';
                    emptyMsg.style.margin = '1rem 0';
                    emptyMsg.innerHTML = '<p>Votre chronologie se construira au fur et √† mesure que vous documentez vos situations.</p><p><strong>Commencez par :</strong> Aller dans l\'onglet "Situations de travail" !</p>';
                    timelineContainer.appendChild(emptyMsg);
                } else {
                    // Trier les situations par date (plus r√©cente d'abord)
                    const sortedSituations = [...portfolioData.situations].sort((a, b) => {
                        return new Date(b.date || b.dateAdded) - new Date(a.date || a.dateAdded);
                    });
                    
                    // Afficher les situations dans la chronologie
                    sortedSituations.forEach((situation, index) => {
                        const item = document.createElement('div');
                        item.className = 'timeline-item' + (index === 0 ? ' milestone' : '');
                        
                        // FIX 2 : Ajouter navigation vers la situation au clic
                        const originalIndex = portfolioData.situations.findIndex(s => s.id === situation.id);
                        if (originalIndex !== -1) {
                            item.style.cursor = 'pointer';
                            item.title = 'Cliquer pour ouvrir cette situation';
                            item.onclick = (function(idx) {
                                return function() {
                                    const tabBtn = document.querySelector('button.tab[onclick*="situations"]');
                                    if (tabBtn) tabBtn.click();
                                    setTimeout(() => editSituation(idx), 150);
                                };
                            })(originalIndex);
                        }
                        
                        const dateDiv = document.createElement('div');
                        dateDiv.className = 'timeline-date';
                        const situationDate = situation.date ? new Date(situation.date) : new Date(situation.dateAdded);
                        dateDiv.textContent = situationDate.toLocaleDateString('fr-CH', { day: 'numeric', month: 'long', year: 'numeric' });
                        
                        const contentDiv = document.createElement('div');
                        contentDiv.className = 'timeline-content';
                        
                        const title = document.createElement('h4');
                        title.className = 'timeline-title';
                        title.textContent = situation.title;
                        
                        // Trouver les comp√©tences li√©es
                        const compIds = situation.competenceIds || [situation.competenceId];
                        const compNames = compIds.map(id => {
                            for (const dom of qualificationProfile.domaines) {
                                const c = dom.competences.find(comp => comp.id === id);
                                if (c) return id;
                            }
                            return id;
                        }).join(', ');
                        
                        const desc = document.createElement('p');
                        desc.textContent = 'Comp√©tences: ' + compNames;
                        
                        contentDiv.appendChild(title);
                        contentDiv.appendChild(desc);
                        // Indicateur visuel si cliquable
                        if (originalIndex !== -1) {
                            const hint = document.createElement('small');
                            hint.style.cssText = 'color:#6366f1;font-style:italic;';
                            hint.textContent = '‚Üí Cliquer pour ouvrir';
                            contentDiv.appendChild(hint);
                        }
                        item.appendChild(dateDiv);
                        item.appendChild(contentDiv);
                        timelineContainer.appendChild(item);
                    });
                }
            }
            
            // 3. Afficher le compteur de preuves et justificatifs
            const proofsCounter = document.getElementById('proofs-counter');
            if (proofsCounter) {
                const proofsCount = portfolioData.proofs.length;
                proofsCounter.innerHTML = `<strong>${proofsCount}</strong> preuve${proofsCount !== 1 ? 's' : ''} enregistr√©e${proofsCount !== 1 ? 's' : ''}`;
            }
            
            // 4. Afficher la liste des preuves dans le dashboard
            const proofsSummary = document.getElementById('proofs-summary');
            if (proofsSummary) {
                if (portfolioData.proofs.length === 0) {
                    proofsSummary.innerHTML = '<p style="color: #666; font-style: italic;">Aucune preuve ajout√©e. Allez dans l\'onglet "Preuves et justificatifs" pour en ajouter.</p>';
                } else {
                    let html = '<ul style="margin: 0; padding-left: 1.5rem;">';
                    portfolioData.proofs.forEach(proof => {
                        // Trouver la situation li√©e
                        const situation = portfolioData.situations.find(s => s.id === proof.situationId);
                        const situationTitle = situation ? situation.title : 'Situation inconnue';
                        
                        // Trouver les comp√©tences via la situation
                        let compCodes = '';
                        if (situation) {
                            const compIds = situation.competenceIds || [situation.competenceId];
                            compCodes = compIds.filter(id => id).join(', ');
                        }
                        
                        html += `<li><strong>${proof.title}</strong>`;
                        if (compCodes) html += ` <span style="color: #666;">[${compCodes}]</span>`;
                        html += `<br><small style="color: #888;">via: ${situationTitle}</small></li>`;
                    });
                    html += '</ul>';
                    proofsSummary.innerHTML = html;
                }
            }
        }
        
        // Fonction pour mettre √† jour les menus d√©roulants de comp√©tences
        function updateCompetenceLinkedSelects() {
            // Mise √† jour du menu d√©roulant dans l'onglet "Situations de travail"
            // MODIFI√â: Charge TOUTES les comp√©tences du r√©f√©rentiel, pas seulement celles enregistr√©es
            const competenceLinked = document.getElementById('competence-linked');
            if (competenceLinked) {
                competenceLinked.innerHTML = '';
                
                // Parcourir tous les domaines du profil de qualification
                qualificationProfile.domaines.forEach(domaine => {
                    const optgroup = document.createElement('optgroup');
                    optgroup.label = `${domaine.id} - ${domaine.titre}`;
                    
                    domaine.competences.forEach(competence => {
                        const option = document.createElement('option');
                        option.value = competence.id;
                        option.textContent = `${competence.id} - ${competence.titre}`;
                        option.setAttribute('data-search', `${competence.id} ${competence.titre}`.toLowerCase());
                        optgroup.appendChild(option);
                    });
                    
                    competenceLinked.appendChild(optgroup);
                });
            }
            
            // Mise √† jour du menu d√©roulant dans l'onglet "R√©flexion et √âvaluation"
            // R√âFLEXION: Seulement les comp√©tences d√©j√† document√©es (on r√©fl√©chit sur le v√©cu)
            const reflectionCompetence = document.getElementById('reflection-competence');
            if (reflectionCompetence) {
                reflectionCompetence.innerHTML = '<option value="">S√©lectionner une comp√©tence document√©e</option>';
                
                if (portfolioData.competences.length === 0) {
                    const option = document.createElement('option');
                    option.value = "";
                    option.textContent = "‚ö†Ô∏è Documentez d'abord une situation !";
                    option.disabled = true;
                    reflectionCompetence.appendChild(option);
                } else {
                    portfolioData.competences.forEach(competence => {
                        const option = document.createElement('option');
                        option.value = competence.id;
                        option.textContent = `${competence.id}: ${competence.title}`;
                        reflectionCompetence.appendChild(option);
                    });
                }
            }
            
            // Mise √† jour du menu d√©roulant dans l'onglet "Progr√®s et Plans"
            // PROGR√àS: Toutes les comp√©tences du r√©f√©rentiel (on planifie l'avenir)
            const goalCompetence = document.getElementById('goal-competence');
            if (goalCompetence) {
                goalCompetence.innerHTML = '<option value="">S√©lectionner une comp√©tence</option>';
                
                // Parcourir tous les domaines du profil de qualification
                qualificationProfile.domaines.forEach(domaine => {
                    const optgroup = document.createElement('optgroup');
                    optgroup.label = `${domaine.id} - ${domaine.titre}`;
                    
                    domaine.competences.forEach(competence => {
                        const option = document.createElement('option');
                        option.value = competence.id;
                        option.textContent = `${competence.id} - ${competence.titre}`;
                        optgroup.appendChild(option);
                    });
                    
                    goalCompetence.appendChild(optgroup);
                });
            }
        }
        
        // NOUVEAU: Fonction pour filtrer les comp√©tences selon la recherche
        function filterCompetences(searchText) {
            const competenceLinked = document.getElementById('competence-linked');
            if (!competenceLinked) return;
            
            const searchLower = searchText.toLowerCase().trim();
            
            // Si pas de recherche, afficher tout
            if (!searchLower) {
                Array.from(competenceLinked.querySelectorAll('option')).forEach(opt => {
                    opt.style.display = '';
                });
                Array.from(competenceLinked.querySelectorAll('optgroup')).forEach(group => {
                    group.style.display = '';
                });
                return;
            }
            
            // Filtrer les options
            Array.from(competenceLinked.querySelectorAll('optgroup')).forEach(group => {
                let groupHasVisibleOption = false;
                
                Array.from(group.querySelectorAll('option')).forEach(opt => {
                    const searchData = opt.getAttribute('data-search') || opt.textContent.toLowerCase();
                    if (searchData.includes(searchLower)) {
                        opt.style.display = '';
                        groupHasVisibleOption = true;
                    } else {
                        opt.style.display = 'none';
                    }
                });
                
                group.style.display = groupHasVisibleOption ? '' : 'none';
            });
        }
        
        // Fonctions pour les situations de travail
        function saveSituation() {
            const title = document.getElementById('situation-title').value;
            const competenceSelect = document.getElementById('competence-linked');
            const selectedCompetences = Array.from(competenceSelect.selectedOptions).map(opt => opt.value);
            const date = document.getElementById('situation-date').value;
            const context = document.getElementById('situation-context').value;
            const description = document.getElementById('situation-description').value;
            const relevance = document.getElementById('competence-relevance').value;
            
            // Validation minimale - seulement titre et au moins une comp√©tence requis
            if (!title) {
                alert('Veuillez au moins donner un titre √† votre situation.');
                return;
            }
            
            if (selectedCompetences.length === 0) {
                alert('Veuillez s√©lectionner au moins une comp√©tence op√©rationnelle.');
                return;
            }
            
            // R√©cup√©rer les champs d'exp√©rimentation
const expTested = document.getElementById('experimentation-tested').value;
const expPositive = document.getElementById('experimentation-positive').value;
const expDifficult = document.getElementById('experimentation-difficult').value;
const expLearning = document.getElementById('experimentation-learning').value;
const expNext = document.getElementById('experimentation-next').value;

// Mode √©dition ou cr√©ation ?
const isEditing = editingSituationIndex !== null;
const situationId = isEditing ? portfolioData.situations[editingSituationIndex].id : 'sit_' + Date.now();

// Cr√©er l'objet de situation √† sauvegarder
const situationToSave = {
    id: situationId,
    title: title,
    competenceIds: selectedCompetences, // NOUVEAU: tableau de comp√©tences
    competenceId: selectedCompetences[0], // Garder pour compatibilit√©
    date: date || new Date().toISOString().split('T')[0],
    context: context,
    description: description,
    relevance: relevance,
    experimentations: {
        tested: expTested,
        positive: expPositive,
        difficult: expDifficult,
        learning: expLearning,
        next: expNext
    },
    dateAdded: isEditing ? portfolioData.situations[editingSituationIndex].dateAdded : new Date().toISOString()
};
            
            // Mettre √† jour ou ajouter la situation
            if (isEditing) {
                portfolioData.situations[editingSituationIndex] = situationToSave;
            } else {
                portfolioData.situations.push(situationToSave);
            }
            
            // NOUVEAU: Auto-ajouter les comp√©tences s√©lectionn√©es si elles n'existent pas encore
            selectedCompetences.forEach(compId => {
                // V√©rifier si cette comp√©tence est d√©j√† dans portfolioData.competences
                const exists = portfolioData.competences.find(c => c.id === compId);
                if (!exists) {
                    // Trouver les infos de la comp√©tence dans le r√©f√©rentiel
                    for (const domaine of qualificationProfile.domaines) {
                        const comp = domaine.competences.find(c => c.id === compId);
                        if (comp) {
                            // Ajouter la comp√©tence avec des valeurs par d√©faut
                            portfolioData.competences.push({
                                id: comp.id,
                                title: comp.titre,
                                description: comp.titre,
                                domain: { id: domaine.id, title: domaine.titre },
                                criteria: comp.criteres_performance || [],
                                importance: 'Comp√©tence ajout√©e automatiquement via une situation de travail.',
                                selfAssessment: 'en_developpement',
                                dateAdded: new Date().toISOString()
                            });
                            break;
                        }
                    }
                }
            });
            
            // Sauvegarder les donn√©es
            if (saveData()) {
                // Feedback visuel adapt√© au mode
                if (isEditing) {
                    alert('‚úÖ Situation mise √† jour avec succ√®s !');
                    showSaveStatus('save-success', 'Situation mise √† jour');
                    // R√©initialiser le mode √©dition
                    editingSituationIndex = null;
                    // Remettre le bouton normal
                    const saveBtn = document.querySelector('#situations .btn-success');
                    if (saveBtn) {
                        saveBtn.textContent = 'Enregistrer la situation';
                        saveBtn.style.backgroundColor = '';
                    }
                    // Supprimer le bouton Annuler
                    const cancelBtn = document.getElementById('cancel-edit-btn');
                    if (cancelBtn) cancelBtn.remove();
                } else {
                    alert('‚úÖ Situation enregistr√©e avec succ√®s !\n\nLes comp√©tences li√©es ont √©t√© ajout√©es √† votre portfolio.\nVous pouvez voir le tout dans la Vue d\'ensemble.');
                    showSaveStatus('save-success', 'Situation enregistr√©e avec succ√®s');
                }
                
                // R√©initialiser le formulaire
                document.getElementById('situation-title').value = '';
                // D√©selectionner toutes les comp√©tences (select multiple)
                const compSelect = document.getElementById('competence-linked');
                Array.from(compSelect.options).forEach(opt => opt.selected = false);
                document.getElementById('competence-search').value = '';
                filterCompetences(''); // R√©afficher toutes les options
                document.getElementById('situation-date').value = '';
                document.getElementById('situation-context').value = '';
                document.getElementById('situation-description').value = '';
                document.getElementById('competence-relevance').value = '';
		// R√©initialiser les champs d'exp√©rimentation
document.getElementById('experimentation-tested').value = '';
document.getElementById('experimentation-positive').value = '';
document.getElementById('experimentation-difficult').value = '';
document.getElementById('experimentation-learning').value = '';
document.getElementById('experimentation-next').value = '';
                
                // Mettre √† jour l'affichage des situations
                renderSituations();
                updateSituationLinkedSelects();
                
                // NOUVEAU: Mettre √† jour aussi les comp√©tences et le tableau de bord
                renderCompetences();
                updateDashboard();
                updateCompetenceLinkedSelects(); // Met √† jour les menus R√©flexion et Progr√®s
            }
        }
        
        function renderSituations() {
            const situationsList = document.getElementById('situations-list');
            if (!situationsList) return;
            
            situationsList.innerHTML = '';
            
            if (portfolioData.situations.length === 0) {
                const emptyMessage = document.createElement('div');
                emptyMessage.className = 'alert alert-info';
                emptyMessage.textContent = 'Vous n\'avez pas encore document√© de situations de travail. Utilisez le formulaire ci-dessus pour en ajouter.';
                situationsList.appendChild(emptyMessage);
            } else {
                // Fonction helper pour trouver une comp√©tence dans le r√©f√©rentiel
                function findCompetenceInProfile(compId) {
                    for (const domaine of qualificationProfile.domaines) {
                        const comp = domaine.competences.find(c => c.id === compId);
                        if (comp) return { id: comp.id, title: comp.titre, domaine: domaine.titre };
                    }
                    return null;
                }
                
                // Afficher toutes les situations (sans regroupement complexe)
                portfolioData.situations.forEach((situation, index) => {
                    // Trouver les infos de comp√©tence(s) dans le r√©f√©rentiel
                    const competenceIds = situation.competenceIds || [situation.competenceId];
                    const competenceInfos = competenceIds.map(id => findCompetenceInProfile(id)).filter(c => c);
                    
                    const card = document.createElement('div');
                    card.className = 'card';
                    card.id = situation.id;
                    card.style.marginBottom = '1.5rem';
                    
                    // Header avec titre et boutons
                    const cardHeader = document.createElement('div');
                    cardHeader.className = 'card-header';
                    
                    const cardTitle = document.createElement('h3');
                    cardTitle.className = 'card-title';
                    cardTitle.textContent = situation.title;
                    
                    const actionButtons = document.createElement('div');
                    actionButtons.className = 'action-buttons';
                    
                    // Bouton Modifier
                    const editButton = document.createElement('button');
                    editButton.className = 'btn btn-outline';
                    editButton.textContent = 'Modifier';
                    editButton.onclick = () => editSituation(index);
                    actionButtons.appendChild(editButton);
                    
                    // Bouton Supprimer
                    const deleteButton = document.createElement('button');
                    deleteButton.className = 'btn btn-danger';
                    deleteButton.textContent = 'Supprimer';
                    deleteButton.onclick = () => deleteSituation(index);
                    actionButtons.appendChild(deleteButton);
                    
                    cardHeader.appendChild(cardTitle);
                    cardHeader.appendChild(actionButtons);
                    card.appendChild(cardHeader);
                    
                    // Comp√©tences li√©es
                    if (competenceInfos.length > 0) {
                        const compDiv = document.createElement('div');
                        compDiv.style.cssText = 'margin-bottom: 1rem; display: flex; flex-wrap: wrap; gap: 0.5rem;';
                        competenceInfos.forEach(comp => {
                            const badge = document.createElement('span');
                            badge.style.cssText = 'background-color: #E9D5FF; color: #6B21A8; padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.875rem;';
                            badge.textContent = `${comp.id} - ${comp.title}`;
                            compDiv.appendChild(badge);
                        });
                        card.appendChild(compDiv);
                    }
                    
                    // Date
                    if (situation.date) {
                        const date = document.createElement('p');
                        date.innerHTML = `<strong>Date:</strong> ${new Date(situation.date).toLocaleDateString('fr-CH')}`;
                        card.appendChild(date);
                    }
                    
                    // Contexte
                    if (situation.context) {
                        const context = document.createElement('p');
                        context.innerHTML = `<strong>Contexte:</strong> ${situation.context}`;
                        card.appendChild(context);
                    }
                    
                    // Description
                    if (situation.description) {
                        const descTitle = document.createElement('h4');
                        descTitle.textContent = 'Description d√©taill√©e:';
                        descTitle.style.marginTop = '1rem';
                        card.appendChild(descTitle);
                        
                        const description = document.createElement('p');
                        description.textContent = situation.description;
                        card.appendChild(description);
                    }
                    
                    // Pertinence
                    if (situation.relevance) {
                        const relTitle = document.createElement('h4');
                        relTitle.textContent = 'Pertinence pour la/les comp√©tence(s):';
                        relTitle.style.marginTop = '1rem';
                        card.appendChild(relTitle);
                        
                        const relevance = document.createElement('p');
                        relevance.textContent = situation.relevance;
                        card.appendChild(relevance);
                    }
                    
                    // Exp√©rimentations
                    if (situation.experimentations && 
                        (situation.experimentations.tested || situation.experimentations.positive || 
                         situation.experimentations.difficult || situation.experimentations.learning || 
                         situation.experimentations.next)) {
                        
                        const expSection = document.createElement('div');
                        expSection.style.cssText = 'margin-top: 1rem; padding: 1rem; background-color: #F0F9FF; border-left: 4px solid #3B82F6; border-radius: 4px;';
                        
                        const expTitle = document.createElement('h4');
                        expTitle.textContent = 'üß™ Exp√©rimentations';
                        expTitle.style.color = '#1E40AF';
                        expSection.appendChild(expTitle);
                        
                        if (situation.experimentations.tested) {
                            const p = document.createElement('p');
                            p.innerHTML = `<strong>Ce que j'ai test√©:</strong> ${situation.experimentations.tested}`;
                            expSection.appendChild(p);
                        }
                        if (situation.experimentations.positive) {
                            const p = document.createElement('p');
                            p.innerHTML = `<strong>‚úÖ Ce qui a fonctionn√©:</strong> ${situation.experimentations.positive}`;
                            expSection.appendChild(p);
                        }
                        if (situation.experimentations.difficult) {
                            const p = document.createElement('p');
                            p.innerHTML = `<strong>‚ö†Ô∏è Ce qui a √©t√© difficile:</strong> ${situation.experimentations.difficult}`;
                            expSection.appendChild(p);
                        }
                        if (situation.experimentations.learning) {
                            const p = document.createElement('p');
                            p.innerHTML = `<strong>üìù Ce que j'en apprends:</strong> ${situation.experimentations.learning}`;
                            expSection.appendChild(p);
                        }
                        if (situation.experimentations.next) {
                            const p = document.createElement('p');
                            p.innerHTML = `<strong>üéØ Prochaines √©tapes:</strong> ${situation.experimentations.next}`;
                            expSection.appendChild(p);
                        }
                        
                        card.appendChild(expSection);
                    }
                    
                    situationsList.appendChild(card);
                });
            }
        }
        
        function createSituationCard(situation, index) {
            const card = document.createElement('div');
            card.className = 'card';
            card.id = situation.id;
            
            const cardHeader = document.createElement('div');
            cardHeader.className = 'card-header';
            
            const cardTitle = document.createElement('h3');
            cardTitle.className = 'card-title';
            cardTitle.textContent = situation.title;
            
            const actionButtons = document.createElement('div');
            actionButtons.className = 'action-buttons';
            
            const editButton = document.createElement('button');
            editButton.className = 'btn btn-outline';
            editButton.textContent = 'Modifier';
            editButton.onclick = () => editSituation(index);
            
            const deleteButton = document.createElement('button');
            deleteButton.className = 'btn btn-danger';
            deleteButton.textContent = 'Supprimer';
            deleteButton.onclick = () => deleteSituation(index);
            
            actionButtons.appendChild(editButton);
            actionButtons.appendChild(deleteButton);
            
            cardHeader.appendChild(cardTitle);
            cardHeader.appendChild(actionButtons);
            
            const date = document.createElement('p');
            date.innerHTML = `<strong>Date:</strong> ${new Date(situation.date).toLocaleDateString()}`;
            
            const context = document.createElement('p');
            context.innerHTML = `<strong>Contexte:</strong> ${situation.context}`;
            
            const descriptionTitle = document.createElement('h4');
            descriptionTitle.textContent = 'Description d√©taill√©e:';
            
            const description = document.createElement('p');
            description.textContent = situation.description;
            
            const relevanceTitle = document.createElement('h4');
            relevanceTitle.textContent = 'Pertinence pour la comp√©tence:';
            
            const relevance = document.createElement('p');
            relevance.textContent = situation.relevance;
            
            // Trouver les preuves associ√©es √† cette situation
            const associatedProofs = portfolioData.proofs.filter(p => p.situationId === situation.id);
            
            const proofsTitle = document.createElement('h4');
            proofsTitle.textContent = 'Preuves et justificatifs associ√©s:';
            
            const proofsList = document.createElement('ul');
            if (associatedProofs.length === 0) {
                const emptyItem = document.createElement('li');
                emptyItem.textContent = 'Aucune preuve associ√©e.';
                emptyItem.style.fontStyle = 'italic';
                proofsList.appendChild(emptyItem);
            } else {
                associatedProofs.forEach(proof => {
                    const item = document.createElement('li');
                    const link = document.createElement('a');
                    link.href = `#${proof.id}`;
                    link.textContent = proof.title;
                    item.appendChild(link);
                    proofsList.appendChild(item);
                });
            }
            
            card.appendChild(cardHeader);
            card.appendChild(date);
            card.appendChild(context);
            card.appendChild(descriptionTitle);
            card.appendChild(description);
            card.appendChild(relevanceTitle);
            card.appendChild(relevance);
            card.appendChild(proofsTitle);
            card.appendChild(proofsList);
            
  // Afficher les exp√©rimentations si elles existent
if (situation.experimentations && 
    (situation.experimentations.tested || situation.experimentations.positive || 
     situation.experimentations.difficult || situation.experimentations.learning || 
     situation.experimentations.next)) {
    
    const expSection = document.createElement('div');
    expSection.style.cssText = 'margin-top: 20px; padding: 15px; background-color: #F9F9FF; border-left: 4px solid #E6E6FA; border-radius: 4px;';
    
    const expTitle = document.createElement('h4');
    expTitle.style.color = '#6B46C1';
    expTitle.innerHTML = 'üß™ Exp√©rimentations';
    expSection.appendChild(expTitle);
    
    if (situation.experimentations.tested) {
        const testedP = document.createElement('p');
        testedP.innerHTML = `<strong>Ce que j'ai test√© :</strong><br>${situation.experimentations.tested}`;
        expSection.appendChild(testedP);
    }
    
    if (situation.experimentations.positive) {
        const positiveP = document.createElement('p');
        positiveP.innerHTML = `<strong>Ce qui s'est pass√© (positif) :</strong><br>${situation.experimentations.positive}`;
        expSection.appendChild(positiveP);
    }
    
    if (situation.experimentations.difficult) {
        const difficultP = document.createElement('p');
        difficultP.innerHTML = `<strong>Ce qui a √©t√© difficile :</strong><br>${situation.experimentations.difficult}`;
        expSection.appendChild(difficultP);
    }
    
    if (situation.experimentations.learning) {
        const learningP = document.createElement('p');
        learningP.innerHTML = `<strong>Ce que j'en apprends :</strong><br>${situation.experimentations.learning}`;
        expSection.appendChild(learningP);
    }
    
    if (situation.experimentations.next) {
        const nextP = document.createElement('p');
        nextP.innerHTML = `<strong>Prochaines √©tapes :</strong><br>${situation.experimentations.next}`;
        expSection.appendChild(nextP);
    }
    
    card.appendChild(expSection);
}         
 return card;
        }
        
        function editSituation(index) {
            const situation = portfolioData.situations[index];
            if (!situation) return;
            
            // Passer en mode √©dition
            editingSituationIndex = index;
            
            // Remplir le formulaire avec les donn√©es existantes
            document.getElementById('situation-title').value = situation.title || '';
            document.getElementById('situation-date').value = situation.date || '';
            document.getElementById('situation-context').value = situation.context || '';
            document.getElementById('situation-description').value = situation.description || '';
            document.getElementById('competence-relevance').value = situation.relevance || '';
            
            // Remplir les exp√©rimentations
            if (situation.experimentations) {
                document.getElementById('experimentation-tested').value = situation.experimentations.tested || '';
                document.getElementById('experimentation-positive').value = situation.experimentations.positive || '';
                document.getElementById('experimentation-difficult').value = situation.experimentations.difficult || '';
                document.getElementById('experimentation-learning').value = situation.experimentations.learning || '';
                document.getElementById('experimentation-next').value = situation.experimentations.next || '';
            }
            
            // S√©lectionner les comp√©tences
            const competenceIds = situation.competenceIds || [situation.competenceId];
            const compSelect = document.getElementById('competence-linked');
            Array.from(compSelect.options).forEach(opt => {
                opt.selected = competenceIds.includes(opt.value);
            });
            
            // Changer le bouton en mode "Mettre √† jour"
            const saveBtn = document.querySelector('#situations .btn-success');
            if (saveBtn) {
                saveBtn.textContent = 'üíæ Mettre √† jour la situation';
                saveBtn.style.backgroundColor = '#2563EB';
            }
            
            // Scroller vers le formulaire
            document.getElementById('situations').scrollIntoView({ behavior: 'smooth' });
            
            // Message √† l'utilisateur
            alert('üìù Mode modification activ√© !\n\nModifiez les champs ci-dessus puis cliquez sur "Mettre √† jour la situation".\n\nPour annuler, cliquez sur "Annuler modification".');
            
            // Ajouter un bouton Annuler s'il n'existe pas
            if (!document.getElementById('cancel-edit-btn')) {
                const cancelBtn = document.createElement('button');
                cancelBtn.id = 'cancel-edit-btn';
                cancelBtn.className = 'btn btn-outline';
                cancelBtn.textContent = 'Annuler modification';
                cancelBtn.style.marginLeft = '10px';
                cancelBtn.onclick = cancelEditSituation;
                saveBtn.parentNode.insertBefore(cancelBtn, saveBtn.nextSibling);
            }
        }
        
        function cancelEditSituation() {
            editingSituationIndex = null;
            
            // Vider le formulaire
            document.getElementById('situation-title').value = '';
            document.getElementById('situation-date').value = '';
            document.getElementById('situation-context').value = '';
            document.getElementById('situation-description').value = '';
            document.getElementById('competence-relevance').value = '';
            document.getElementById('experimentation-tested').value = '';
            document.getElementById('experimentation-positive').value = '';
            document.getElementById('experimentation-difficult').value = '';
            document.getElementById('experimentation-learning').value = '';
            document.getElementById('experimentation-next').value = '';
            
            // D√©selectionner les comp√©tences
            const compSelect = document.getElementById('competence-linked');
            Array.from(compSelect.options).forEach(opt => opt.selected = false);
            
            // Remettre le bouton normal
            const saveBtn = document.querySelector('#situations .btn-success');
            if (saveBtn) {
                saveBtn.textContent = 'Enregistrer la situation';
                saveBtn.style.backgroundColor = '';
            }
            
            // Supprimer le bouton Annuler
            const cancelBtn = document.getElementById('cancel-edit-btn');
            if (cancelBtn) cancelBtn.remove();
        }
        
        function deleteSituation(index) {
            if (confirm('√ätes-vous s√ªr de vouloir supprimer cette situation ? Cette action supprimera √©galement toutes les preuves associ√©es.')) {
                const situationToDelete = portfolioData.situations[index];
                
                // Supprimer la situation
                portfolioData.situations.splice(index, 1);
                
                // Supprimer les preuves associ√©es
                portfolioData.proofs = portfolioData.proofs.filter(p => p.situationId !== situationToDelete.id);
                
                if (saveData()) {
                    showSaveStatus('save-success', 'Situation supprim√©e avec succ√®s');
                    renderSituations();
                    updateSituationLinkedSelects();
                    renderCompetences();
                    updateDashboard();
                }
            }
        }
        
        function updateSituationLinkedSelects() {
            const proofSituation = document.getElementById('proof-situation');
            if (proofSituation) {
                proofSituation.innerHTML = '<option value="">S√©lectionner une situation</option>';
                
                portfolioData.situations.forEach(situation => {
                    const option = document.createElement('option');
                    option.value = situation.id;
                    option.textContent = situation.title;
                    proofSituation.appendChild(option);
                });
            }
        }
        
        // Fonctions pour les preuves
        let editingProofIndex = null;
        
        function saveProof() {
            const title = document.getElementById('proof-title').value;
            const type = document.getElementById('proof-type').value;
            const situationId = document.getElementById('proof-situation').value;
            const fileReference = document.getElementById('proof-file-reference').value;
            const description = document.getElementById('proof-description').value;
            const theory = document.getElementById('proof-theory').value;
            
            // Validation minimale
            if (!title) {
                alert('Veuillez donner un titre √† votre preuve.');
                return;
            }
            
            if (!situationId) {
                alert('Veuillez lier cette preuve √† une situation de travail.');
                return;
            }
            
            // Mode √©dition ou cr√©ation ?
            const isEditing = editingProofIndex !== null;
            const proofId = isEditing ? portfolioData.proofs[editingProofIndex].id : 'proof_' + Date.now();
            
            // Cr√©er l'objet preuve
            const proofToSave = {
                id: proofId,
                title: title,
                type: type,
                situationId: situationId,
                fileReference: fileReference,
                description: description,
                theory: theory,
                dateAdded: isEditing ? portfolioData.proofs[editingProofIndex].dateAdded : new Date().toISOString()
            };
            
            // Mettre √† jour ou ajouter
            if (isEditing) {
                portfolioData.proofs[editingProofIndex] = proofToSave;
            } else {
                portfolioData.proofs.push(proofToSave);
            }
            
            // Sauvegarder
            if (saveData()) {
                if (isEditing) {
                    alert('‚úÖ Preuve mise √† jour avec succ√®s !');
                    showSaveStatus('save-success', 'Preuve mise √† jour');
                    editingProofIndex = null;
                    const saveBtn = document.querySelector('#proofs .btn-success');
                    if (saveBtn) {
                        saveBtn.textContent = 'Enregistrer cette preuve';
                        saveBtn.style.backgroundColor = '';
                    }
                    const cancelBtn = document.getElementById('cancel-edit-proof-btn');
                    if (cancelBtn) cancelBtn.remove();
                } else {
                    alert('‚úÖ Preuve enregistr√©e avec succ√®s !');
                    showSaveStatus('save-success', 'Preuve enregistr√©e avec succ√®s');
                }
                
                // R√©initialiser le formulaire
                document.getElementById('proof-title').value = '';
                document.getElementById('proof-type').value = '';
                document.getElementById('proof-situation').value = '';
                document.getElementById('proof-file-reference').value = '';
                document.getElementById('proof-description').value = '';
                document.getElementById('proof-theory').value = '';
                
                // Rafra√Æchir l'affichage
                renderProofs();
                updateDashboard();
            }
        }
        
        function renderProofs() {
            const proofsList = document.getElementById('proofs-list');
            if (!proofsList) return;
            
            // Mettre √† jour le select des situations
            populateProofSituationSelect();
            
            if (portfolioData.proofs.length === 0) {
                proofsList.innerHTML = '<p class="empty-state">Aucune preuve enregistr√©e. Ajoutez votre premi√®re preuve ci-dessus.</p>';
                return;
            }
            
            // Grouper les preuves par situation
            const proofsBySituation = {};
            portfolioData.proofs.forEach(proof => {
                if (!proofsBySituation[proof.situationId]) {
                    proofsBySituation[proof.situationId] = [];
                }
                proofsBySituation[proof.situationId].push(proof);
            });
            
            let html = '';
            
            // Afficher par situation
            for (const situationId in proofsBySituation) {
                const situation = portfolioData.situations.find(s => s.id === situationId);
                const situationTitle = situation ? situation.title : 'Situation supprim√©e';
                
                html += `<div class="card" style="margin-bottom: 1rem;">
                    <div class="card-header">
                        <h4 style="margin: 0;">üìã ${situationTitle}</h4>
                    </div>
                    <div style="padding: 1rem;">`;
                
                proofsBySituation[situationId].forEach(proof => {
                    const typeLabels = {
                        'plan': 'üìù Plan/Conception',
                        'material': 'üìö Mat√©riel p√©dagogique',
                        'evaluation': 'üìä √âvaluation/Feedback',
                        'photo': 'üì∑ Photo',
                        'video': 'üé• Vid√©o',
                        'certificate': 'üéì Attestation',
                        'other': 'üìÑ Autre'
                    };
                    const typeLabel = typeLabels[proof.type] || 'üìÑ Document';
                    
                    html += `<div class="proof-item" style="border: 1px solid #ddd; border-radius: 8px; padding: 1rem; margin-bottom: 0.5rem; background: #fafafa;">
                        <div style="display: flex; justify-content: space-between; align-items: start;">
                            <div>
                                <strong>${proof.title}</strong>
                                <span style="color: #666; font-size: 0.9em; margin-left: 0.5rem;">${typeLabel}</span>
                                ${proof.fileReference ? `<div style="color: #888; font-size: 0.85em; margin-top: 0.25rem;">üìÅ ${proof.fileReference}</div>` : ''}
                                ${proof.description ? `<p style="margin: 0.5rem 0; font-size: 0.9em;">${proof.description}</p>` : ''}
                                ${proof.theory ? `<p style="margin: 0.5rem 0; font-size: 0.85em; color: #555; font-style: italic;">üí° ${proof.theory}</p>` : ''}
                            </div>
                            <div>
                                <button class="btn btn-outline btn-sm" onclick="editProof('${proof.id}')" style="margin-right: 0.25rem;">‚úèÔ∏è</button>
                                <button class="btn btn-outline btn-sm" onclick="deleteProof('${proof.id}')" style="color: #dc3545;">üóëÔ∏è</button>
                            </div>
                        </div>
                    </div>`;
                });
                
                html += `</div></div>`;
            }
            
            proofsList.innerHTML = html;
        }
        
        function populateProofSituationSelect() {
            const select = document.getElementById('proof-situation');
            if (!select) return;
            
            // Garder la premi√®re option
            select.innerHTML = '<option value="">S√©lectionner une situation</option>';
            
            if (portfolioData.situations.length === 0) {
                const option = document.createElement('option');
                option.value = "";
                option.textContent = "‚ö†Ô∏è Cr√©ez d'abord une situation de travail";
                option.disabled = true;
                select.appendChild(option);
                return;
            }
            
            // Ajouter les situations avec leurs comp√©tences li√©es
            portfolioData.situations.forEach(situation => {
                const option = document.createElement('option');
                option.value = situation.id;
                
                // Trouver les comp√©tences li√©es
                const compIds = situation.competenceIds || [situation.competenceId];
                const compCodes = compIds.filter(id => id).join(', ');
                
                option.textContent = situation.title + (compCodes ? ' [' + compCodes + ']' : '');
                select.appendChild(option);
            });
        }
        
        function editProof(proofId) {
            const proofIndex = portfolioData.proofs.findIndex(p => p.id === proofId);
            if (proofIndex === -1) return;
            
            const proof = portfolioData.proofs[proofIndex];
            editingProofIndex = proofIndex;
            
            // Remplir le formulaire
            document.getElementById('proof-title').value = proof.title || '';
            document.getElementById('proof-type').value = proof.type || '';
            document.getElementById('proof-situation').value = proof.situationId || '';
            document.getElementById('proof-file-reference').value = proof.fileReference || '';
            document.getElementById('proof-description').value = proof.description || '';
            document.getElementById('proof-theory').value = proof.theory || '';
            
            // Changer le bouton
            const saveBtn = document.querySelector('#proofs .btn-success');
            if (saveBtn) {
                saveBtn.textContent = 'üíæ Mettre √† jour la preuve';
                saveBtn.style.backgroundColor = '#2563EB';
                
                // Ajouter bouton Annuler si pas d√©j√† l√†
                if (!document.getElementById('cancel-edit-proof-btn')) {
                    const cancelBtn = document.createElement('button');
                    cancelBtn.id = 'cancel-edit-proof-btn';
                    cancelBtn.className = 'btn btn-outline';
                    cancelBtn.textContent = 'Annuler';
                    cancelBtn.style.marginLeft = '0.5rem';
                    cancelBtn.onclick = cancelEditProof;
                    saveBtn.parentNode.insertBefore(cancelBtn, saveBtn.nextSibling);
                }
            }
            
            // Scroller vers le formulaire
            document.getElementById('proof-title').scrollIntoView({ behavior: 'smooth' });
            document.getElementById('proof-title').focus();
        }
        
        function cancelEditProof() {
            editingProofIndex = null;
            
            // Vider le formulaire
            document.getElementById('proof-title').value = '';
            document.getElementById('proof-type').value = '';
            document.getElementById('proof-situation').value = '';
            document.getElementById('proof-file-reference').value = '';
            document.getElementById('proof-description').value = '';
            document.getElementById('proof-theory').value = '';
            
            // Remettre le bouton normal
            const saveBtn = document.querySelector('#proofs .btn-success');
            if (saveBtn) {
                saveBtn.textContent = 'Enregistrer cette preuve';
                saveBtn.style.backgroundColor = '';
            }
            
            // Supprimer le bouton Annuler
            const cancelBtn = document.getElementById('cancel-edit-proof-btn');
            if (cancelBtn) cancelBtn.remove();
        }
        
        function deleteProof(proofId) {
            if (confirm('√ätes-vous s√ªr de vouloir supprimer cette preuve ?')) {
                portfolioData.proofs = portfolioData.proofs.filter(p => p.id !== proofId);
                
                if (saveData()) {
                    showSaveStatus('save-success', 'Preuve supprim√©e');
                    renderProofs();
                    updateDashboard();
                }
            }
        }
        
        // Fonctions pour les r√©flexions
        let editingReflectionIndex = null;
        let currentReflectionRating = null;
        
        function saveReflection() {
            const competenceId = document.getElementById('reflection-competence').value;
            const evolution = document.getElementById('reflection-evolution').value;
            const situations = document.getElementById('reflection-situations').value;
            const articulation = document.getElementById('reflection-articulation').value;
            const theory = document.getElementById('reflection-theory').value;
            
            // R√©cup√©rer la note s√©lectionn√©e
            const selectedRating = document.querySelector('.rating-item.selected');
            const rating = selectedRating ? parseInt(selectedRating.querySelector('.rating-circle').textContent) : null;
            
            // Validation minimale
            if (!competenceId) {
                alert('Veuillez s√©lectionner une comp√©tence.');
                return;
            }
            
            if (!rating) {
                alert('Veuillez √©valuer votre niveau actuel.');
                return;
            }
            
            // Mode √©dition ou cr√©ation ?
            const isEditing = editingReflectionIndex !== null;
            const reflectionId = isEditing ? portfolioData.reflections[editingReflectionIndex].id : 'refl_' + Date.now();
            
            // Cr√©er l'objet r√©flexion
            const reflectionToSave = {
                id: reflectionId,
                competenceId: competenceId,
                rating: rating,
                evolution: evolution,
                situations: situations,
                articulation: articulation,
                theory: theory,
                dateAdded: isEditing ? portfolioData.reflections[editingReflectionIndex].dateAdded : new Date().toISOString()
            };
            
            // Mettre √† jour ou ajouter
            if (isEditing) {
                portfolioData.reflections[editingReflectionIndex] = reflectionToSave;
            } else {
                // V√©rifier si une r√©flexion existe d√©j√† pour cette comp√©tence
                const existingIndex = portfolioData.reflections.findIndex(r => r.competenceId === competenceId);
                if (existingIndex !== -1) {
                    if (confirm('Une r√©flexion existe d√©j√† pour cette comp√©tence. Voulez-vous la remplacer ?')) {
                        portfolioData.reflections[existingIndex] = reflectionToSave;
                    } else {
                        return;
                    }
                } else {
                    portfolioData.reflections.push(reflectionToSave);
                }
            }
            
            // Sauvegarder
            if (saveData()) {
                if (isEditing) {
                    alert('‚úÖ R√©flexion mise √† jour avec succ√®s !');
                    showSaveStatus('save-success', 'R√©flexion mise √† jour');
                    editingReflectionIndex = null;
                    const saveBtn = document.querySelector('#reflection .btn-success');
                    if (saveBtn) {
                        saveBtn.textContent = 'Enregistrer cette r√©flexion';
                        saveBtn.style.backgroundColor = '';
                    }
                    const cancelBtn = document.getElementById('cancel-edit-reflection-btn');
                    if (cancelBtn) cancelBtn.remove();
                } else {
                    alert('‚úÖ R√©flexion enregistr√©e avec succ√®s !');
                    showSaveStatus('save-success', 'R√©flexion enregistr√©e avec succ√®s');
                }
                
                // R√©initialiser le formulaire
                document.getElementById('reflection-competence').value = '';
                document.getElementById('reflection-evolution').value = '';
                document.getElementById('reflection-situations').value = '';
                document.getElementById('reflection-articulation').value = '';
                document.getElementById('reflection-theory').value = '';
                document.querySelectorAll('.rating-item').forEach(item => item.classList.remove('selected'));
                
                // Rafra√Æchir l'affichage
                renderReflections();
                updateDashboard();
            }
        }
        
        function renderReflections() {
            const reflectionsList = document.getElementById('reflections-list');
            if (!reflectionsList) return;
            
            // Mettre √† jour le select des comp√©tences
            populateReflectionCompetenceSelect();
            
            if (portfolioData.reflections.length === 0) {
                reflectionsList.innerHTML = '<p class="empty-state">Aucune r√©flexion enregistr√©e. Ajoutez votre premi√®re r√©flexion ci-dessus.</p>';
                return;
            }
            
            const ratingLabels = {
                1: 'Novice',
                2: 'D√©butant',
                3: 'Comp√©tent',
                4: 'Avanc√©',
                5: 'Expert'
            };
            
            let html = '';
            
            portfolioData.reflections.forEach(reflection => {
                // Trouver la comp√©tence - afficher CODE + titre
                let compDisplay = reflection.competenceId;
                for (const dom of qualificationProfile.domaines) {
                    const comp = dom.competences.find(c => c.id === reflection.competenceId);
                    if (comp) {
                        compDisplay = reflection.competenceId + ' - ' + comp.titre;
                        break;
                    }
                }
                
                const ratingLabel = ratingLabels[reflection.rating] || 'Non √©valu√©';
                const ratingStars = '‚≠ê'.repeat(reflection.rating);
                
                html += `<div class="card" style="margin-bottom: 1rem;">
                    <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <h4 style="margin: 0;">${compDisplay}</h4>
                            <span style="color: #666;">${ratingStars} ${ratingLabel}</span>
                        </div>
                        <div>
                            <button class="btn btn-outline btn-sm" onclick="editReflection('${reflection.id}')" style="margin-right: 0.25rem;">‚úèÔ∏è</button>
                            <button class="btn btn-outline btn-sm" onclick="deleteReflection('${reflection.id}')" style="color: #dc3545;">üóëÔ∏è</button>
                        </div>
                    </div>
                    <div style="padding: 1rem;">
                        ${reflection.evolution ? `<div style="margin-bottom: 0.5rem;"><strong>√âvolution :</strong><br>${reflection.evolution}</div>` : ''}
                        ${reflection.situations ? `<div style="margin-bottom: 0.5rem;"><strong>Situations formatrices :</strong><br>${reflection.situations}</div>` : ''}
                        ${reflection.articulation ? `<div style="margin-bottom: 0.5rem;"><strong>Articulation :</strong><br>${reflection.articulation}</div>` : ''}
                        ${reflection.theory ? `<div style="font-style: italic; color: #555;"><strong>üí° Mod√®le th√©orique :</strong><br>${reflection.theory}</div>` : ''}
                    </div>
                </div>`;
            });
            
            reflectionsList.innerHTML = html;
        }
        
        function populateReflectionCompetenceSelect() {
            const select = document.getElementById('reflection-competence');
            if (!select) return;
            
            select.innerHTML = '<option value="">S√©lectionner une comp√©tence document√©e</option>';
            
            if (portfolioData.competences.length === 0) {
                const option = document.createElement('option');
                option.value = "";
                option.textContent = "‚ö†Ô∏è Documentez d'abord une situation de travail";
                option.disabled = true;
                select.appendChild(option);
                return;
            }
            
            // Ajouter les comp√©tences document√©es avec leur code
            portfolioData.competences.forEach(comp => {
                const option = document.createElement('option');
                option.value = comp.id;
                // Afficher le code + titre (ex: "A1.1 - Animer des formations...")
                option.textContent = comp.id + ' - ' + (comp.title || 'Sans titre');
                select.appendChild(option);
            });
        }
        
        function editReflection(reflectionId) {
            const reflectionIndex = portfolioData.reflections.findIndex(r => r.id === reflectionId);
            if (reflectionIndex === -1) return;
            
            const reflection = portfolioData.reflections[reflectionIndex];
            editingReflectionIndex = reflectionIndex;
            
            // Remplir le formulaire
            document.getElementById('reflection-competence').value = reflection.competenceId || '';
            document.getElementById('reflection-evolution').value = reflection.evolution || '';
            document.getElementById('reflection-situations').value = reflection.situations || '';
            document.getElementById('reflection-articulation').value = reflection.articulation || '';
            document.getElementById('reflection-theory').value = reflection.theory || '';
            
            // S√©lectionner la note
            document.querySelectorAll('.rating-item').forEach((item, index) => {
                item.classList.remove('selected');
                if (index + 1 === reflection.rating) {
                    item.classList.add('selected');
                }
            });
            
            // Changer le bouton
            const saveBtn = document.querySelector('#reflection .btn-success');
            if (saveBtn) {
                saveBtn.textContent = 'üíæ Mettre √† jour la r√©flexion';
                saveBtn.style.backgroundColor = '#2563EB';
                
                if (!document.getElementById('cancel-edit-reflection-btn')) {
                    const cancelBtn = document.createElement('button');
                    cancelBtn.id = 'cancel-edit-reflection-btn';
                    cancelBtn.className = 'btn btn-outline';
                    cancelBtn.textContent = 'Annuler';
                    cancelBtn.style.marginLeft = '0.5rem';
                    cancelBtn.onclick = cancelEditReflection;
                    saveBtn.parentNode.insertBefore(cancelBtn, saveBtn.nextSibling);
                }
            }
            
            // Scroller vers le formulaire
            document.getElementById('reflection-competence').scrollIntoView({ behavior: 'smooth' });
        }
        
        function cancelEditReflection() {
            editingReflectionIndex = null;
            
            document.getElementById('reflection-competence').value = '';
            document.getElementById('reflection-evolution').value = '';
            document.getElementById('reflection-situations').value = '';
            document.getElementById('reflection-articulation').value = '';
            document.getElementById('reflection-theory').value = '';
            document.querySelectorAll('.rating-item').forEach(item => item.classList.remove('selected'));
            
            const saveBtn = document.querySelector('#reflection .btn-success');
            if (saveBtn) {
                saveBtn.textContent = 'Enregistrer cette r√©flexion';
                saveBtn.style.backgroundColor = '';
            }
            
            const cancelBtn = document.getElementById('cancel-edit-reflection-btn');
            if (cancelBtn) cancelBtn.remove();
        }
        
        function deleteReflection(reflectionId) {
            if (confirm('√ätes-vous s√ªr de vouloir supprimer cette r√©flexion ?')) {
                portfolioData.reflections = portfolioData.reflections.filter(r => r.id !== reflectionId);
                
                if (saveData()) {
                    showSaveStatus('save-success', 'R√©flexion supprim√©e');
                    renderReflections();
                    updateDashboard();
                }
            }
        }
        
        // Fonction pour s√©lectionner une note
        function selectRating(element, rating) {
            // Retirer la classe selected de tous les √©l√©ments de rating
            const siblings = element.parentElement.querySelectorAll('.rating-item');
            siblings.forEach(sibling => sibling.classList.remove('selected'));
            
            // Ajouter la classe selected √† l'√©l√©ment cliqu√©
            element.classList.add('selected');
        }
        
        // Fonctions pour les objectifs
        let editingGoalIndex = null;
        
        function saveGoal() {
            const title = document.getElementById('goal-title').value;
            const competenceId = document.getElementById('goal-competence').value;
            const description = document.getElementById('goal-description').value;
            const actions = document.getElementById('goal-actions').value;
            const deadline = document.getElementById('goal-deadline').value;
            
            // Validation minimale
            if (!title) {
                alert('Veuillez donner un titre √† votre objectif.');
                return;
            }
            
            // Mode √©dition ou cr√©ation ?
            const isEditing = editingGoalIndex !== null;
            const goalId = isEditing ? portfolioData.goals[editingGoalIndex].id : 'goal_' + Date.now();
            
            // Cr√©er l'objet objectif
            const goalToSave = {
                id: goalId,
                title: title,
                competenceId: competenceId,
                description: description,
                actions: actions,
                deadline: deadline,
                status: isEditing ? portfolioData.goals[editingGoalIndex].status : 'en_cours',
                dateAdded: isEditing ? portfolioData.goals[editingGoalIndex].dateAdded : new Date().toISOString()
            };
            
            // Mettre √† jour ou ajouter
            if (isEditing) {
                portfolioData.goals[editingGoalIndex] = goalToSave;
            } else {
                portfolioData.goals.push(goalToSave);
            }
            
            // Sauvegarder
            if (saveData()) {
                if (isEditing) {
                    alert('‚úÖ Objectif mis √† jour avec succ√®s !');
                    showSaveStatus('save-success', 'Objectif mis √† jour');
                    editingGoalIndex = null;
                    const saveBtn = document.querySelector('#progress .btn-success');
                    if (saveBtn) {
                        saveBtn.textContent = 'Enregistrer cet objectif';
                        saveBtn.style.backgroundColor = '';
                    }
                    const cancelBtn = document.getElementById('cancel-edit-goal-btn');
                    if (cancelBtn) cancelBtn.remove();
                } else {
                    alert('‚úÖ Objectif enregistr√© avec succ√®s !');
                    showSaveStatus('save-success', 'Objectif enregistr√© avec succ√®s');
                }
                
                // R√©initialiser le formulaire
                document.getElementById('goal-title').value = '';
                document.getElementById('goal-competence').value = '';
                document.getElementById('goal-description').value = '';
                document.getElementById('goal-actions').value = '';
                document.getElementById('goal-deadline').value = '';
                
                // Rafra√Æchir l'affichage
                renderGoals();
                updateDashboard();
            }
        }
        
        function renderGoals() {
            const goalsList = document.getElementById('goals-list');
            if (!goalsList) return;
            
            // Mettre √† jour le select des comp√©tences
            populateGoalCompetenceSelect();
            
            if (portfolioData.goals.length === 0) {
                goalsList.innerHTML = '<p class="empty-state">Aucun objectif enregistr√©. Ajoutez votre premier objectif ci-dessus.</p>';
                return;
            }
            
            const statusLabels = {
                'en_cours': 'üîÑ En cours',
                'atteint': '‚úÖ Atteint',
                'abandonne': '‚ùå Abandonn√©'
            };
            
            let html = '';
            
            portfolioData.goals.forEach(goal => {
                // Trouver la comp√©tence si elle existe
                let compTitle = '';
                if (goal.competenceId) {
                    for (const dom of qualificationProfile.domaines) {
                        const comp = dom.competences.find(c => c.id === goal.competenceId);
                        if (comp) {
                            compTitle = comp.titre;
                            break;
                        }
                    }
                }
                
                const statusLabel = statusLabels[goal.status] || 'üîÑ En cours';
                const deadlineDisplay = goal.deadline ? new Date(goal.deadline).toLocaleDateString('fr-CH') : 'Non d√©finie';
                const isOverdue = goal.deadline && new Date(goal.deadline) < new Date() && goal.status === 'en_cours';
                
                html += `<div class="card" style="margin-bottom: 1rem; ${isOverdue ? 'border-left: 4px solid #dc3545;' : ''}">
                    <div class="card-header" style="display: flex; justify-content: space-between; align-items: start;">
                        <div>
                            <h4 style="margin: 0;">${goal.title}</h4>
                            ${compTitle ? `<span style="color: #666; font-size: 0.9em;">üìã ${compTitle}</span>` : ''}
                        </div>
                        <div style="text-align: right;">
                            <span style="font-size: 0.85em;">${statusLabel}</span><br>
                            <span style="font-size: 0.8em; color: ${isOverdue ? '#dc3545' : '#666'};">üìÖ ${deadlineDisplay}</span>
                        </div>
                    </div>
                    <div style="padding: 1rem;">
                        ${goal.description ? `<div style="margin-bottom: 0.5rem;">${goal.description}</div>` : ''}
                        ${goal.actions ? `<div style="margin-bottom: 0.5rem;"><strong>Actions pr√©vues :</strong><br>${goal.actions}</div>` : ''}
                        <div style="margin-top: 1rem; display: flex; gap: 0.5rem; flex-wrap: wrap;">
                            <button class="btn btn-outline btn-sm" onclick="editGoal('${goal.id}')">‚úèÔ∏è Modifier</button>
                            <button class="btn btn-outline btn-sm" onclick="toggleGoalStatus('${goal.id}', 'atteint')" style="color: #28a745;">‚úÖ Atteint</button>
                            <button class="btn btn-outline btn-sm" onclick="toggleGoalStatus('${goal.id}', 'abandonne')" style="color: #6c757d;">‚ùå Abandonner</button>
                            <button class="btn btn-outline btn-sm" onclick="deleteGoal('${goal.id}')" style="color: #dc3545;">üóëÔ∏è Supprimer</button>
                        </div>
                    </div>
                </div>`;
            });
            
            goalsList.innerHTML = html;
        }
        
        function populateGoalCompetenceSelect() {
            const select = document.getElementById('goal-competence');
            if (!select) return;
            
            select.innerHTML = '<option value="">S√©lectionner une comp√©tence (optionnel)</option>';
            
            // Ajouter TOUTES les comp√©tences du r√©f√©rentiel
            for (const dom of qualificationProfile.domaines) {
                const optgroup = document.createElement('optgroup');
                optgroup.label = dom.titre;
                
                dom.competences.forEach(comp => {
                    const option = document.createElement('option');
                    option.value = comp.id;
                    option.textContent = comp.titre;
                    optgroup.appendChild(option);
                });
                
                select.appendChild(optgroup);
            }
        }
        
        function editGoal(goalId) {
            const goalIndex = portfolioData.goals.findIndex(g => g.id === goalId);
            if (goalIndex === -1) return;
            
            const goal = portfolioData.goals[goalIndex];
            editingGoalIndex = goalIndex;
            
            // Remplir le formulaire
            document.getElementById('goal-title').value = goal.title || '';
            document.getElementById('goal-competence').value = goal.competenceId || '';
            document.getElementById('goal-description').value = goal.description || '';
            document.getElementById('goal-actions').value = goal.actions || '';
            document.getElementById('goal-deadline').value = goal.deadline || '';
            
            // Changer le bouton
            const saveBtn = document.querySelector('#progress .btn-success');
            if (saveBtn) {
                saveBtn.textContent = 'üíæ Mettre √† jour l\'objectif';
                saveBtn.style.backgroundColor = '#2563EB';
                
                if (!document.getElementById('cancel-edit-goal-btn')) {
                    const cancelBtn = document.createElement('button');
                    cancelBtn.id = 'cancel-edit-goal-btn';
                    cancelBtn.className = 'btn btn-outline';
                    cancelBtn.textContent = 'Annuler';
                    cancelBtn.style.marginLeft = '0.5rem';
                    cancelBtn.onclick = cancelEditGoal;
                    saveBtn.parentNode.insertBefore(cancelBtn, saveBtn.nextSibling);
                }
            }
            
            // Scroller vers le formulaire
            document.getElementById('goal-title').scrollIntoView({ behavior: 'smooth' });
            document.getElementById('goal-title').focus();
        }
        
        function cancelEditGoal() {
            editingGoalIndex = null;
            
            document.getElementById('goal-title').value = '';
            document.getElementById('goal-competence').value = '';
            document.getElementById('goal-description').value = '';
            document.getElementById('goal-actions').value = '';
            document.getElementById('goal-deadline').value = '';
            
            const saveBtn = document.querySelector('#progress .btn-success');
            if (saveBtn) {
                saveBtn.textContent = 'Enregistrer cet objectif';
                saveBtn.style.backgroundColor = '';
            }
            
            const cancelBtn = document.getElementById('cancel-edit-goal-btn');
            if (cancelBtn) cancelBtn.remove();
        }
        
        function toggleGoalStatus(goalId, newStatus) {
            const goal = portfolioData.goals.find(g => g.id === goalId);
            if (!goal) return;
            
            goal.status = newStatus;
            
            if (saveData()) {
                showSaveStatus('save-success', 'Statut mis √† jour');
                renderGoals();
            }
        }
        
        function deleteGoal(goalId) {
            if (confirm('√ätes-vous s√ªr de vouloir supprimer cet objectif ?')) {
                portfolioData.goals = portfolioData.goals.filter(g => g.id !== goalId);
                
                if (saveData()) {
                    showSaveStatus('save-success', 'Objectif supprim√©');
                    renderGoals();
                    updateDashboard();
                }
            }
        }
        
        // Fonctions d'exportation et d'importation
        function exportJSON() {
            // Pr√©parer le fichier JSON √† t√©l√©charger
            const dataStr = JSON.stringify(portfolioData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            // Cr√©er un lien de t√©l√©chargement et cliquer dessus
            const link = document.createElement('a');
            link.href = url;
            const date = new Date().toISOString().slice(0, 10);
            const filename = `Portfolio_${portfolioData.profile.name || 'Formateur'}_${date}.json`;
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            // Lib√©rer l'URL
            setTimeout(() => {
                URL.revokeObjectURL(url);
                closeExportModal();
                showSaveStatus('save-success', 'Portfolio export√© avec succ√®s');
            }, 100);
        }
        
        function importData(file) {
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    // V√©rifier si le fichier est un JSON valide
                    const importedData = JSON.parse(e.target.result);
                    
                    // V√©rifier si le fichier contient les donn√©es attendues
                    if (!importedData.profile) {
                        throw new Error("Format de fichier non valide");
                    }
                    
                    // Confirmation avant d'√©craser les donn√©es actuelles
                    if (confirm("Cette action remplacera toutes vos donn√©es actuelles. Continuer?")) {
                        portfolioData = importedData;
                        saveData();
                        loadData(); // Recharger l'interface
                        showSaveStatus('save-success', 'Donn√©es import√©es avec succ√®s');
                        
                        // Recharger la page pour appliquer tous les changements
                        setTimeout(() => {
                            location.reload();
                        }, 1500);
                    }
                } catch (error) {
                    console.error("Erreur lors de l'importation:", error);
                    showSaveStatus('save-error', 'Erreur: fichier non valide');
                }
            };
            
            reader.readAsText(file);
        }
        
        function printPortfolio() {
            // Pr√©paration pour l'impression
            const originalTitle = document.title;
            const name = portfolioData.profile.name || 'Formateur';
            document.title = `Portfolio de ${name} - Brevet F√©d√©ral`;
            
            // Impression
            window.print();
            
            // Restaurer le titre original
            setTimeout(() => {
                document.title = originalTitle;
                if (document.getElementById('export-modal').style.display === 'block') {
                    closeExportModal();
                }
            }, 100);
        }
        
        // Fonctions de l'interface utilisateur
        function initializeUI() {
            // Initialiser les barres de progression avec animation
            const progressFills = document.querySelectorAll('.progress-fill');
            progressFills.forEach(fill => {
                const width = fill.style.width || '0%';
                fill.style.width = '0%';
                setTimeout(() => {
                    fill.style.width = width;
                }, 300);
            });
            
            // Ajouter les √©couteurs d'√©v√©nements pour les √©chelles de notation
            document.querySelectorAll('.rating-item').forEach(item => {
                item.addEventListener('click', function() {
                    // Supprimer la classe 'selected' des fr√®res
                    const siblings = this.parentElement.querySelectorAll('.rating-item');
                    siblings.forEach(sibling => sibling.classList.remove('selected'));
                    
                    // Ajouter la classe 'selected' √† l'√©l√©ment cliqu√©
                    this.classList.add('selected');
                });
            });
            
            // Ajouter les √©couteurs d'√©v√©nements pour les cartes de comp√©tence
            document.querySelectorAll('.competence-card').forEach(card => {
                card.addEventListener('click', function() {
                    this.classList.toggle('selected');
                });
            });
            
            // Initialiser les menus d√©roulants li√©s aux comp√©tences
            updateCompetenceLinkedSelects();
            updateSituationLinkedSelects();
        }
        
        function setupAccordions() {
            const acc = document.getElementsByClassName("accordion");
            for (let i = 0; i < acc.length; i++) {
                acc[i].addEventListener("click", function() {
                    this.classList.toggle("active");
                    const panel = this.nextElementSibling;
                    if (panel.style.maxHeight) {
                        panel.style.maxHeight = null;
                    } else {
                        panel.style.maxHeight = panel.scrollHeight + "px";
                    } 
                });
            }
            
            // Ouvrir le premier accord√©on par d√©faut
            if (acc.length > 0) {
                acc[0].click();
            }
        }
        
        function setupAutoSave() {
            // Ajouter la sauvegarde automatique sur les changements de formulaire
            const formInputs = document.querySelectorAll('input, textarea, select');
            formInputs.forEach(input => {
                input.addEventListener('change', function() {
                    // Sauvegarder seulement si l'√©l√©ment est dans un formulaire important
                    if (this.closest('.card')) {
                        saveData();
                    }
                });
            });
            
            // Ajouter la sauvegarde avant de quitter la page
            window.addEventListener('beforeunload', function() {
                saveData();
            });
        }
        
        function showWelcomeMessage() {
            alert("Bienvenue dans votre portfolio de d√©veloppement des comp√©tences!\n\nCet outil vous aidera √† documenter vos comp√©tences et √† pr√©parer votre dossier pour l'examen final du Brevet F√©d√©ral de Formateur/trice.\n\nLa nouvelle version int√®gre le profil de qualification officiel avec toutes les comp√©tences et crit√®res de performance.\n\nConsultez le Guide d'utilisation pour d√©couvrir toutes les fonctionnalit√©s disponibles.");
        }
        
        function showSaveStatus(type, message) {
            const statusElement = document.getElementById('save-status');
            statusElement.textContent = message;
            statusElement.className = 'save-status ' + type;
            statusElement.classList.remove('hidden');
            
            // Faire dispara√Ætre le message apr√®s quelques secondes
            setTimeout(() => {
                statusElement.classList.add('fade-out');
                setTimeout(() => {
                    statusElement.classList.add('hidden');
                    statusElement.classList.remove('fade-out');
                }, 500);
            }, 3000);
        }
        
        // Fonctions de navigation
        function openTab(evt, tabName) {
            const tabcontent = document.getElementsByClassName("tab-content");
            for (let i = 0; i < tabcontent.length; i++) {
                tabcontent[i].classList.remove("active");
            }
            
            const tablinks = document.getElementsByClassName("tab");
            for (let i = 0; i < tablinks.length; i++) {
                tablinks[i].classList.remove("active");
            }
            
            document.getElementById(tabName).classList.add("active");
            evt.currentTarget.classList.add("active");
        }
        
        // Fonctions pour les modales
        // === FIX 1 : Gestion multi-employeurs ===
        function renderInstitutions() {
            const list = document.getElementById('institutions-list');
            if (!list) return;
            if (!portfolioData.profile.institutions || portfolioData.profile.institutions.length === 0) {
                list.innerHTML = '<p style="color:#888;font-style:italic;font-size:0.9rem;margin-bottom:0.25rem;">Aucun employeur ajout√©.</p>';
                return;
            }
            list.innerHTML = portfolioData.profile.institutions.map((inst, i) =>
                `<div style="display:flex;align-items:center;gap:0.5rem;margin-bottom:0.3rem;">
                    <span style="flex:1;background:#f0f4ff;border:1px solid #c7d2fe;border-radius:6px;padding:0.35rem 0.6rem;font-size:0.95rem;">üè¢ ${inst}</span>
                    <button type="button" onclick="removeInstitution(${i})" style="background:#fee2e2;border:none;border-radius:6px;padding:0.35rem 0.6rem;cursor:pointer;color:#dc2626;font-weight:bold;" title="Supprimer">‚úï</button>
                </div>`
            ).join('');
        }

        function addInstitution() {
            const input = document.getElementById('institution-input');
            const val = input.value.trim();
            if (!val) return;
            if (!portfolioData.profile.institutions) portfolioData.profile.institutions = [];
            portfolioData.profile.institutions.push(val);
            input.value = '';
            renderInstitutions();
            saveProfile();
        }

        function removeInstitution(index) {
            portfolioData.profile.institutions.splice(index, 1);
            renderInstitutions();
            saveProfile();
        }

        // Permettre d'ajouter avec Entr√©e
        document.addEventListener('DOMContentLoaded', function() {
            const input = document.getElementById('institution-input');
            if (input) {
                input.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter') { e.preventDefault(); addInstitution(); }
                });
            }
        });

        // === FIX 3 : Aper√ßu r√©el du dossier final ===
        function generateDossierPreview() {
            const container = document.getElementById('exam-preparation');
            if (!container) return;

            const situations = portfolioData.situations || [];
            const competences = portfolioData.competences || [];
            const reflections = portfolioData.reflections || [];
            const proofs = portfolioData.proofs || [];
            const profile = portfolioData.profile || {};

            // Identifier les comp√©tences document√©es (via situations)
            const compIdsFromSituations = new Set();
            situations.forEach(s => {
                const ids = s.competenceIds || (s.competenceId ? [s.competenceId] : []);
                ids.forEach(id => compIdsFromSituations.add(id));
            });
            const nbComps = compIdsFromSituations.size;
            const nbSituations = situations.length;
            const nbReflections = reflections.length;
            const nbProofs = proofs.length;
            const hasProfile = !!(profile.name && (profile.institutions?.length || profile.institution));

            // Score de pr√©paration (indicatif)
            let score = 0;
            if (hasProfile) score += 10;
            if (nbSituations >= 3) score += 30; else score += nbSituations * 10;
            if (nbComps >= 3) score += 30; else score += nbComps * 10;
            if (nbReflections >= 3) score += 20; else score += nbReflections * 7;
            if (nbProofs >= 3) score += 10; else score += nbProofs * 3;
            score = Math.min(score, 100);

            const scoreColor = score < 40 ? '#ef4444' : score < 70 ? '#f59e0b' : '#22c55e';

            // D√©tail des comp√©tences document√©es
            const compDetails = [...compIdsFromSituations].map(id => {
                let label = id;
                for (const dom of qualificationProfile.domaines) {
                    const c = dom.competences.find(comp => comp.id === id);
                    if (c) { label = `${id} ‚Äî ${c.titre}`; break; }
                }
                const hasSit = situations.some(s => (s.competenceIds || [s.competenceId]).includes(id));
                const hasRefl = reflections.some(r => r.competenceId === id);
                const hasProof = proofs.some(p => {
                    const sit = situations.find(si => si.id === p.situationId);
                    return sit && (sit.competenceIds || [sit.competenceId]).includes(id);
                });
                const ready = hasSit && hasRefl && hasProof;
                return { label, hasSit, hasRefl, hasProof, ready };
            });

            const minRequired = 3;
            const compReadyCount = compDetails.filter(c => c.ready).length;

            container.innerHTML = `
                <div style="margin-bottom:1.5rem;">
                    <div style="display:flex;align-items:center;gap:1rem;margin-bottom:0.75rem;">
                        <div style="font-size:2rem;font-weight:bold;color:${scoreColor};">${score}%</div>
                        <div>
                            <strong>Score de pr√©paration</strong>
                            <div style="background:#e5e7eb;border-radius:999px;height:10px;width:200px;margin-top:4px;">
                                <div style="background:${scoreColor};height:10px;border-radius:999px;width:${score}%;transition:width 0.5s;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <table style="width:100%;border-collapse:collapse;margin-bottom:1.5rem;font-size:0.95rem;">
                    <thead>
                        <tr style="background:#f3f4f6;">
                            <th style="padding:0.5rem;text-align:left;border:1px solid #e5e7eb;">√âl√©ment</th>
                            <th style="padding:0.5rem;text-align:center;border:1px solid #e5e7eb;">√âtat</th>
                            <th style="padding:0.5rem;text-align:left;border:1px solid #e5e7eb;">D√©tail</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="padding:0.5rem;border:1px solid #e5e7eb;">Profil compl√©t√©</td>
                            <td style="padding:0.5rem;text-align:center;border:1px solid #e5e7eb;">${hasProfile ? '‚úÖ' : '‚ö†Ô∏è'}</td>
                            <td style="padding:0.5rem;border:1px solid #e5e7eb;">${hasProfile ? profile.name : 'Nom et institution manquants'}</td>
                        </tr>
                        <tr>
                            <td style="padding:0.5rem;border:1px solid #e5e7eb;">Situations document√©es</td>
                            <td style="padding:0.5rem;text-align:center;border:1px solid #e5e7eb;">${nbSituations >= minRequired ? '‚úÖ' : nbSituations > 0 ? 'üü°' : '‚ùå'}</td>
                            <td style="padding:0.5rem;border:1px solid #e5e7eb;">${nbSituations} situation${nbSituations > 1 ? 's' : ''} (minimum requis : ${minRequired})</td>
                        </tr>
                        <tr>
                            <td style="padding:0.5rem;border:1px solid #e5e7eb;">Comp√©tences couvertes</td>
                            <td style="padding:0.5rem;text-align:center;border:1px solid #e5e7eb;">${nbComps >= minRequired ? '‚úÖ' : nbComps > 0 ? 'üü°' : '‚ùå'}</td>
                            <td style="padding:0.5rem;border:1px solid #e5e7eb;">${nbComps} comp√©tence${nbComps > 1 ? 's' : ''} identifi√©e${nbComps > 1 ? 's' : ''} (minimum : ${minRequired})</td>
                        </tr>
                        <tr>
                            <td style="padding:0.5rem;border:1px solid #e5e7eb;">R√©flexions r√©dig√©es</td>
                            <td style="padding:0.5rem;text-align:center;border:1px solid #e5e7eb;">${nbReflections >= minRequired ? '‚úÖ' : nbReflections > 0 ? 'üü°' : '‚ùå'}</td>
                            <td style="padding:0.5rem;border:1px solid #e5e7eb;">${nbReflections} r√©flexion${nbReflections > 1 ? 's' : ''}</td>
                        </tr>
                        <tr>
                            <td style="padding:0.5rem;border:1px solid #e5e7eb;">Preuves/justificatifs</td>
                            <td style="padding:0.5rem;text-align:center;border:1px solid #e5e7eb;">${nbProofs >= minRequired ? '‚úÖ' : nbProofs > 0 ? 'üü°' : '‚ùå'}</td>
                            <td style="padding:0.5rem;border:1px solid #e5e7eb;">${nbProofs} preuve${nbProofs > 1 ? 's' : ''}</td>
                        </tr>
                        <tr>
                            <td style="padding:0.5rem;border:1px solid #e5e7eb;">Comp√©tences pr√™tes pour examen</td>
                            <td style="padding:0.5rem;text-align:center;border:1px solid #e5e7eb;">${compReadyCount >= minRequired ? '‚úÖ' : compReadyCount > 0 ? 'üü°' : '‚ùå'}</td>
                            <td style="padding:0.5rem;border:1px solid #e5e7eb;">${compReadyCount}/${minRequired} (situation + r√©flexion + preuve)</td>
                        </tr>
                    </tbody>
                </table>

                ${compDetails.length > 0 ? `
                <h5 style="margin-bottom:0.5rem;">D√©tail par comp√©tence document√©e :</h5>
                <ul style="list-style:none;padding:0;margin-bottom:1rem;">
                    ${compDetails.map(c => `
                        <li style="margin-bottom:0.4rem;padding:0.5rem;background:${c.ready ? '#f0fdf4' : '#fffbeb'};border-radius:6px;border-left:4px solid ${c.ready ? '#22c55e' : '#f59e0b'};">
                            <strong>${c.label}</strong><br>
                            <small>
                                ${c.hasSit ? '‚úÖ' : '‚ùå'} Situation&nbsp;&nbsp;
                                ${c.hasRefl ? '‚úÖ' : '‚ö†Ô∏è'} R√©flexion&nbsp;&nbsp;
                                ${c.hasProof ? '‚úÖ' : '‚ö†Ô∏è'} Preuve
                                ${c.ready ? '&nbsp;&nbsp;<strong style="color:#16a34a;">‚Üí Pr√™t pour l\'examen</strong>' : ''}
                            </small>
                        </li>`).join('')}
                </ul>` : '<p style="color:#888;font-style:italic;">Aucune comp√©tence document√©e pour l\'instant.</p>'}

                ${score < 100 ? `<div class="alert alert-warning" style="margin-top:0.5rem;">
                    <strong>Prochaines √©tapes :</strong>
                    ${!hasProfile ? '<br>‚Ä¢ Compl√©ter votre profil (nom + employeur)' : ''}
                    ${nbSituations < minRequired ? `<br>‚Ä¢ Ajouter ${minRequired - nbSituations} situation(s) suppl√©mentaire(s)` : ''}
                    ${nbComps < minRequired ? `<br>‚Ä¢ Documenter au moins ${minRequired - nbComps} comp√©tence(s) de plus` : ''}
                    ${nbReflections < minRequired ? `<br>‚Ä¢ R√©diger ${minRequired - nbReflections} r√©flexion(s) de plus` : ''}
                    ${nbProofs < minRequired ? `<br>‚Ä¢ Ajouter ${minRequired - nbProofs} preuve(s) de plus` : ''}
                </div>` : '<div class="alert alert-success"><strong>üéâ Votre dossier semble complet ! Vous pouvez proc√©der √† l\'export final.</strong></div>'}
            `;
        }

        function openExportModal() {
            document.getElementById('export-modal').style.display = 'block';
        }

        function closeExportModal() {
            document.getElementById('export-modal').style.display = 'none';
        }
        
        // Fermer la modale lorsqu'on clique en dehors
        window.onclick = function(event) {
            const modal = document.getElementById('export-modal');
            if (event.target === modal) {
                closeExportModal();
            }
        };
    </script>
</body>
</html>